1000 A=5000:GOTO 20:REM *BRIEFMARKENVERWALTUNG*
1010 GOSUB 100
1020 REM * CO. H+M FILLINGER *
1030 REM * 2.4.1984          *
1040 REM  VARIABLENLISTE
1050 REM A$(I).............BEZEICHNUNGEN
1060 REM AW,AW$............AUSWAHL
1070 REM B$(I).............BESONDERHEITEN
1080 REM D,D1..............DRUCKERAUSGABE
1090 REM DA,TS.............KONTROLLVARIABLE DATEILESEN
1100 REM DN$...............DATEINAME
1110 REM ET(I).............ANZAHL ETB-SAMMELBLAETTER
1120 REM FD(I).............ANZAHL ERSTTAGSBRIEFE
1130 REM GE(I).............ANZAHL MARKEN GESTEMPELT
1140 REM I,J...............LAUFVARIABLE
1150 REM L$................SAMMELGEBIET
1160 REM J$................JAHRGANG
1170 REM KB$(I)............KURZBEZEICHNUNG
1180 REM MH(I).............ANZAHL MARKENHEFTE
1190 REM MK(I).............ANZAHL MAXIMUMKARTEN
1200 REM MN$(I)............KATALOGNUMMER
1210 REM P$,P$(I)..........PREISNOTIERUNG AUS KATALOG
1220 REM S.................GESAMTWERT JAHRGANG
1230 REM S1,S2,S3,S4,S5,S6.GESAMTWERT ART
1240 REM S1(I).....S6(I)...EINZELPREISE
1250 REM 
1300 CT=7:CN=2:AW=0:DA=0:TS=0
1310 DIM A$(14),MN$(100),KB$(100),PF(100),GE(100)
1320 DIM ET(100),FD(100),MH(100),MK(100),B$(100)
1330 DIM P$(100),S1(100),S2(100),S3(100),S4(100)
1340 DIM S5(100),S6(100)
1350 REM        
1700 REM * DATA EINLESEN *
1710 FOR J=0 TO 14
1720 READ A$(J)
1730 IF J>11 THEN 1790
1740 L=LEN(A$(J))
1750 FOR JJ=L TO 15
1760 A$(J)=A$(J)+" "
1770 NEXT JJ
1780 A$(J)=A$(J)+":"
1790 NEXT J
1800 REM * TITEL *
1810 GOSUB 100:VE=5:HO=0:GOSUB 110
1820 PRINT 
1830 PRINT 
1840 PRINT "BRIEFMARKENVERWALTUNG"
1850 PRINT :PRINT 
1860 PRINT "CO. H+M FILLINGER"
1870 PRINT "  MCMLXXXIV"
1900 REM * PAUSE *
1910 FOR J=0 TO 2000:NEXT J
1920 I=-1:ID=0:GOSUB 100
1930 REM 
1940 REM 
2000 REM * MENUE *
2010 PRINT "-1- NEUEINGABEN/ERGAENZUNGEN"
2020 PRINT "-2- AENDERUNGEN"
2030 PRINT "-3- AUSGABE BESTANDSLISTE"
2040 PRINT "-4- KATALOGWERTERMITTLUNG"
2050 PRINT "-0- PROGRAMM BEENDEN"
2060 INPUT AW
2070 IF (AW=0) AND (TS=1) THEN GOSUB 6500
2080 IF AW=0 THEN GOTO 950
2090 IF (AW<1) OR (AW>4) THEN 2010
2100 IF ID=0 THEN GOSUB 7000
2110 IF DA=0 THEN GOSUB 6000
2120 ON AW GOSUB 2500,3000,4000,5000
2130 GOSUB 100
2140 AW=0
2150 GOTO 2010
2160 REM 
2170 REM 
2500 REM * NEUEINGABEN/ERGAENZUNGEN *
2510 GOSUB 100
2520 TS=1:IF P$="" THEN GOSUB 7060
2530 I=I+1
2540 PRINT "RUECKKEHR ZUM MENUE DURCH EINGABE"
2550 PRINT "VON 0 ALS MICHEL-NR."
2560 PRINT DN$
2570 PRINT A$(2);:INPUT MN$(I)
2580 IF MN$(I)="0" THEN I=I-1:RETURN
2590 PRINT A$(3);:INPUT KB$(I)
2600 PRINT A$(12)+" "+A$(4);:INPUT PF(I)
2610 PRINT A$(13)+" "+A$(4);:INPUT S1(I)
2620 PRINT A$(12)+" "+A$(5);:INPUT GE(I)
2630 PRINT A$(13)+" "+A$(5);:INPUT S2(I)
2640 PRINT A$(12)+" "+A$(6);:INPUT ET(I)
2650 PRINT A$(13)+" "+A$(6);:INPUT S3(I)
2660 PRINT A$(12)+" "+A$(7);:INPUT FD(I)
2670 PRINT A$(13)+" "+A$(7);:INPUT S4(I)
2680 PRINT A$(12)+" "+A$(8);:INPUT MH(I)
2690 PRINT A$(13)+" "+A$(8);:INPUT S5(I)
2700 PRINT A$(12)+" "+A$(9);:INPUT MK(I)
2710 PRINT A$(13)+" "+A$(9);:INPUT S6(I)
2720 PRINT A$(10);:INPUT B$(I)
2730 P$(I)=P$
2740 GOSUB 100
2750 GOTO 2530
2760 REM 
3000 REM * AENDERUNGEN *
3010 GOSUB 100
3020 TS=1
3030 PRINT "RUECKKEHR ZUM MENUE DURCH EINGABE"
3040 PRINT "VON 0 ALS MICHEL-NR."
3050 PRINT :PRINT DN$
3060 PRINT A$(2);:INPUT MN$
3070 IF MN$="0" THEN RETURN
3080 J=-1
3090 FOR L=0 TO I
3100 IF MN$=MN$(L) THEN J=L
3110 NEXT L
3120 IF J=-1 THEN GOSUB 3700
3130 PRINT "-0- WEITER"
3140 PRINT "-1- AENDERN"
3150 PRINT DN$
3160 PRINT A$(2);MN$(J)
3170 GOSUB 210:IF IN$="0" THEN 3190
3180 PRINT A$(2);:INPUT MN$(J)
3190 PRINT A$(3);KB$(J)
3200 GOSUB 210:IF IN$="0" THEN 3220
3210 PRINT A$(3);:INPUT KB$(J)
3220 PRINT A$(12)+" "+A$(4);PF(J)
3230 GOSUB 210:IF IN$="0" THEN 3250
3240 PRINT A$(12)+" "+A$(4);:INPUT PF(J)
3250 PRINT A$(13)+" "+A$(4);S1(J)
3260 GOSUB 210:IF IN$="0" THEN 3280
3270 PRINT A$(13)+" "+A$(4);:INPUT S1(J)
3280 PRINT A$(12)+" "+A$(5);GE(J)
3290 GOSUB 210:IF IN$="0" THEN 3310
3300 PRINT A$(12)+" "+A$(5);:INPUT GE(J)
3310 PRINT A$(13)+" "+A$(5);S2(J)
3320 GOSUB 210:IF IN$="0" THEN 3340
3330 PRINT A$(13)+" "+A$(5);:INPUT S2(J)
3340 PRINT A$(12)+" "+A$(6);ET(J)
3350 GOSUB 210:IF IN$="0" THEN 3370
3360 PRINT A$(12)+" "+A$(6);:INPUT ET(J)
3370 PRINT A$(13)+" "+A$(6);S3(J)
3380 GOSUB 210:IF IN$="0" THEN 3400
3390 PRINT A$(13)+" "+A$(6);:INPUT S3(J)
3400 PRINT A$(12)+" "+A$(7);FD(J)
3410 GOSUB 210:IF IN$="0" THEN 3430
3420 PRINT A$(12)+" "+A$(7);:INPUT FD(J)
3430 PRINT A$(13)+" "+A$(7);S4(J)
3440 GOSUB 210:IF IN$="0" THEN 3460
3450 PRINT A$(13)+" "+A$(7);:INPUT S4(J)
3460 PRINT A$(12)+" "+A$(8);MH(J)
3470 GOSUB 210:IF IN$="0" THEN 3490
3480 PRINT A$(12)+" "+A$(8);:INPUT MH(J)
3490 PRINT A$(13)+" "+A$(8);S5(J)
3500 GOSUB 210:IF IN$="0" THEN 3520
3510 PRINT A$(13)+" "+A$(8);:INPUT S5(J)
3520 PRINT A$(12)+" "+A$(9);MK(J)
3530 GOSUB 210:IF IN$="0" THEN 3550
3540 PRINT A$(12)+" "+A$(9);:INPUT MK(J)
3550 PRINT A$(13)+" "+A$(9);S6(J)
3560 GOSUB 210:IF IN$="0" THEN 3580
3570 PRINT A$(13)+" "+A$(9);:INPUT S6(J)
3580 PRINT A$(10);B$(J)
3590 GOSUB 210:IF IN$="0" THEN 3610
3600 PRINT A$(10);:INPUT B$(J)
3610 PRINT A$(11);P$(J)
3620 GOSUB 210:IF IN$="0" THEN 3640
3630 PRINT A$(11);:INPUT P$(J)
3640 GOSUB 100
3650 GOTO 3030
3660 REM 
3670 REM 
3700 REM * HILFE *
3710 GOSUB 100
3720 PRINT "LEIDER NICHT GEFUNDEN "
3730 PRINT "HIER EINE AUFLISTUNG DER"
3740 PRINT "GESPEICHERTEN MICHEL-NR."
3750 PRINT :PRINT "-0- WEITER "
3760 PRINT "-1- AENDERN"
3770 PRINT 
3780 J=0
3790 PRINT MN$(J)
3800 GOSUB 210
3810 IF IN$="1" THEN RETURN
3820 J=J+1
3830 IF J>I THEN PRINT "AUSGABE ENDE":MN$="0":GOTO 3070
3840 GOTO 3790
3850 REM 
4000 REM * BESTANDSLISTE *
4010 GOSUB 100
4020 GOSUB 8000
4030 GOSUB 100
4040 J=0
4050 ZE=0
4060 SR$=A$(0):GOSUB 8500
4070 ZE=1
4080 SR$=L$:GOSUB 8500
4090 ZE=0:SR$=A$(1):GOSUB 8500
4100 ZE=1:SR$=J$:GOSUB 8500
4110 ZE=0:SR$=A$(2):GOSUB 8500
4120 ZE=1:SR$=MN$(J):GOSUB 8500
4130 ZE=0:SR$=A$(3):GOSUB 8500
4140 ZE=1:SR$=KB$(J):GOSUB 8500
4150 ZE=0:SR$="                   ":GOSUB 8500
4160 SR$=A$(12)+" ":GOSUB 8500
4170 SR$=A$(13)+"  ":GOSUB 8500
4180 ZE=1:SR$=A$(14):GOSUB 8500
4190 ZE=0:SR$=A$(4):GOSUB 8500
4200 SR=PF(J):CN=0:GOSUB 310:GOSUB 8500
4210 SR=S1(J):CN=2:GOSUB 310:GOSUB 8500
4220 SR=PF(J)*S1(J):GOSUB 310:ZE=1:GOSUB 8500
4230 ZE=0:SR$=A$(5):GOSUB 8500
4240 SR=GE(J):CN=0:GOSUB 310:GOSUB 8500
4250 SR=S2(J):CN=2:GOSUB 310:GOSUB 8500
4260 SR=GE(J)*S2(J):GOSUB 310:ZE=1:GOSUB 8500
4270 ZE=0:SR$=A$(6):GOSUB 8500
4280 SR=ET(J):CN=0:GOSUB 310:GOSUB 8500
4290 SR=S3(J):CN=2:GOSUB 310:GOSUB 8500
4300 SR=ET(J)*S3(J):GOSUB 310:ZE=1:GOSUB 8500
4310 ZE=0:SR$=A$(7):GOSUB 8500
4320 SR=FD(J):CN=0:GOSUB 310:GOSUB 8500
4330 SR=S4(J):CN=2:GOSUB 310:GOSUB 8500
4340 SR=FD(J)*S4(J):GOSUB 310:ZE=1:GOSUB 8500
4350 ZE=0:SR$=A$(8):GOSUB 8500
4360 SR=MH(J):CN=0:GOSUB 310:GOSUB 8500
4370 SR=S5(J):CN=2:GOSUB 310:GOSUB 8500
4380 SR=MH(J)*S5(J):GOSUB 310:ZE=1:GOSUB 8500
4390 ZE=0:SR$=A$(9):GOSUB 8500
4400 SR=MK(J):CN=0:GOSUB 310:GOSUB 8500
4410 SR=S6(J):CN=2:GOSUB 310:GOSUB 8500
4420 SR=MK(J)*S6(J):GOSUB 310:ZE=1:GOSUB 8500
4430 ZE=0:SR$=A$(10):GOSUB 8500
4440 ZE=1:SR$=B$(J):GOSUB 8500
4450 ZE=0:SR$=A$(11):GOSUB 8500
4460 ZE=1:SR$=P$(J):GOSUB 8500
4470 IF D=1 THEN SR$="":GOSUB 8500:GOSUB 8500:GOTO 4500
4480 PRINT :PRINT "WENN WEITER, BITTE TASTE DRUECKEN"
4490 GOSUB 210:GOSUB 100
4500 J=J+1
4510 IF J>I THEN RETURN
4520 GOTO 4050
4530 REM 
5000 REM * KATALOGWERT *
5010 GOSUB 100
5020 GOSUB 8000
5030 GOSUB 100
5040 S1=0:S2=0:S3=0:S4=0:S5=0:S6=0:S=0
5050 ZE=1:SR$=DN$:GOSUB 8500
5060 SR$="":GOSUB 8500
5070 FOR J=0 TO I
5080 S1=S1+(S1(J)*PF(J))
5090 S2=S2+(S2(J)*GE(J))
5100 S3=S3+(S3(J)*ET(J))
5110 S4=S4+(S4(J)*FD(J))
5120 S5=S5+(S5(J)*MH(J))
5130 S6=S6+(S6(J)*MK(J))
5140 NEXT J
5150 S=S1+S2+S3+S4+S5+S6
5160 SR$="ZUSAMMENSTELLUNG":GOSUB 8500
5170 SR$="":GOSUB 8500
5180 CN=2
5190 ZE=0:SR$=A$(4):GOSUB 8500
5200 SR=S1:GOSUB 310:SR$=SR$+" DM":ZE=1:GOSUB 8500
5210 ZE=0:SR$=A$(5):GOSUB 8500
5220 SR=S2:GOSUB 310:SR$=SR$+" DM":ZE1:GOSUB 8500
5230 ZE=0:SR$=A$(6):GOSUB 8500
5240 SR=S3:GOSUB 310:SR$=SR$+" DM":ZE=1:GOSUB 8500
5250 ZE=0:SR$=A$(7):GOSUB 8500
5260 SR=S4:GOSUB 310:SR$=SR$+" DM":ZE=1:GOSUB 8500
5270 ZE=0:SR$=A$(8):GOSUB 8500
5280 SR=S5:GOSUB 310:SR$=SR$+" DM":ZE=1:GOSUB 8500
5290 ZE=0:SR$=A$(9):GOSUB 8500
5300 SR=S6:GOSUB 310:SR$=SR$+" DM":ZE=1:GOSUB 8500
5310 SR$="":GOSUB 8500
5320 ZE=0:SR$="SUMME           :":GOSUB 8500
5330 SR=S:GOSUB 310:SR$=SR$+" DM":ZE=1:GOSUB 8500
5340 IF D=1 THEN RETURN
5350 PRINT "WENN WEITER, BITTE TASTE DRUECKEN"
5360 GOSUB 210
5370 RETURN
5380 REM 
6000 REM * DATEI EINLESEN *
6010 DA=1:IF AW>1 THEN 6070
6020 PRINT "WURDEN BEREITS DATEN ZU"
6030 PRINT DN$+" GESPEICHERT";
6040 INPUT AW$
6050 IF LEFT$(AW$,1)="N" THEN RETURN
6060 IF LEFT$(AW$,1)<>"J" THEN 6020
6070 GOSUB 21200
6080 GOSUB 21500
6090 IF DN$=S1$ THEN 6110
6100 PRINT "FALSCHE DATENKASSETTE !!":GOTO 6070
6110 I=VAL(S2$)
6120 FOR J=0 TO I
6130 GOSUB 21500:MN$(J)=S1$:KB$(J)=S2$
6140 GOSUB 21500:PF(J)=VAL(S1$):S1(J)=VAL(S2$)
6150 GOSUB 21500:GE(J)=VAL(S1$):S2(J)=VAL(S2$)
6160 GOSUB 21500:ET(J)=VAL(S1$):S3(J)=VAL(S2$)
6170 GOSUB 21500:FD(J)=VAL(S1$):S4(J)=VAL(S2$)
6180 GOSUB 21500:MH(J)=VAL(S1$):S5(J)=VAL(S2$)
6190 GOSUB 21500:MK(J)=VAL(S1$):S6(J)=VAL(S2$)
6200 GOSUB 21500:B$(J)=S1$:P$(J)=S2$
6210 NEXT J
6220 GOSUB 21700
6230 RETURN
6240 REM 
6500 REM * DATEN SPEICHERN *
6510 TS=0
6520 IF LEFT$(AW$,1)="N" THEN 6570
6530 GOSUB 21200
6540 GOSUB 21500:GOSUB 21700
6550 IF DN$=S1$ THEN GOTO 6570
6560 PRINT "FALSCHE DATENKASSETTE !!!":GOTO 6530
6570 PRINT "BITTE ZURUECKSPULEN"
6580 PRINT "WENN FERTIG, BITTE TASTE DRUECKEN"
6590 GOSUB 210
6600 GOSUB 21100
6610 S1$=DN$:SR=I:GOSUB 300:S2$=SR$
6620 GOSUB 21300
6630 FOR J=0 TO I
6640 S1$=MN$(J):S2$=KB$(J):GOSUB 21300
6650 SR=PF(J):GOSUB 300:S1$=SR$
6660 SR=S1(J):GOSUB 300:S2$=SR$:GOSUB 21300
6670 SR=GE(J):GOSUB 300:S1$=SR$
6680 SR=S2(J):GOSUB 300:S2$=SR$:GOSUB 21300
6690 SR=ET(J):GOSUB 300:S1$=SR$
6700 SR=S3(J):GOSUB 300:S2$=SR$:GOSUB 21300
6710 SR=FD(J):GOSUB 300:S1$=SR$
6720 SR=S4(J):GOSUB 300:S2$=SR$:GOSUB 21300
6730 SR=MH(J):GOSUB 300:S1$=SR$
6740 SR=S5(J):GOSUB 300:S2$=SR$:GOSUB 21300
6750 SR=MK(J):GOSUB 300:S1$=SR$
6760 SR=S6(J):GOSUB 300:S2$=SR$:GOSUB 21300
6770 S1$=B$(J):S2$=P$(J):GOSUB 21300
6780 NEXT J
6790 GOSUB 21700
6800 RETURN
6810 REM 
7000 REM * IDENTIFIKATION *
7010 GOSUB 100:ID=1
7020 PRINT A$(0);:INPUT L$
7030 PRINT A$(1);:INPUT J$
7040 DN$=L$+" "+J$
7050 IF AW>2 THEN RETURN
7060 PRINT A$(11)+" GEMAESS ";:INPUT P$
7070 RETURN
7080 REM 
8000 REM * AUSGABEAUSWAHL *
8010 PRINT "-1- AUSGABE DRUCKER"
8020 PRINT "-2- AUSGABE MONITOR"
8030 INPUT D
8040 IF (D<1) OR (D>2) THEN 8010
8050 RETURN
8060 REM 
8500 REM * AUSGABE *
8510 PRINT SR$;
8520 IF D=1 THEN GOSUB 350
8530 IF ZE=0 THEN RETURN
8540 IF D=1 THEN GOSUB 360
8550 PRINT 
8560 RETURN
8570 REM 
21000 REM DATEIVERWALTUNG
21010 REM  GILT FUER C64
21100 REM  DATEI OEFFNEN ZUM SCHREIBEN
21110 REM OPEN 1,1,1,DN$:RETURN
21200 REM  DATEI OEFFNEN ZUM LESEN
21210 REM OPEN 1,1,0,DN$:RETURN
21300 QP$=S1$:GOSUB 21400:S1$=QZ$:QP$=S2$:GOSUB 21400
21310 S2$=QZ$
21320 REM DATEN (S1$,S2$) AUF KASSETTE SCHREIBEN
21330 REM PRINT#1,S1$:REM PRINT#1,S2$:RETURN
21400 REM UMWANDELN VON DOPPELPUNKT,KOMMA
21410 REM ANFUEHRUNGSZEICHEN USW.
21420 QZ$="":IF QP$="" THEN QP$=" "
21430 FOR QP=1 TO LEN(QP$)
21440 QQ$=MID$(QP$,QP,1):IF QQ$=" " THEN QQ$=CHR$(252)
21450 IF QQ$="," THEN QQ$=CHR$(250)
21460 IF QQ$=CHR$(34) THEN QQ$=CHR$(253)
21470 IF QQ$=":" THEN QQ$=CHR$(251)
21480 QZ$=QZ$+QQ$:NEXT QP:RETURN
21500 REM  DATEN (S1$,S2$) VON KASSETTE LESEN
21510 REM INPUT#1,S1$:REM INPUT#1,S2$
21520 QP$=S1$:GOSUB 21600:S1$=QZ$:QP$=S2$
21530 GOSUB 21600:S2$=QZ$:RETURN
21600 REM UMWANDELN VON DOPPELPUNKT,KOMMA
21610 REM ANFUEHRUNGSZEICHEN USW.
21620 QZ$="":IF OP$="" THEN OP$=" "
21630 FOR QP=1 TO LEN(QP$)
21640 QQ$=MID$(QP$,QP,1):IF QQ$=CHR$(252) THEN QQ$=" "
21650 IF QQ$=CHR$(250) THEN QQ$=","
21660 IF QQ$=CHR$(251) THEN QQ$=":"
21670 IF QQ$=CHR$(253) THEN QQ$=CHR$(34)
21680 QZ$=QZ$+QQ$
21690 NEXT QP:RETURN
21700 REM  DATEI SCHLIESSEN
21710 REM CLOSE 1:RETURN
25000 DATA "LAND","JAHRGANG","MICHEL-NR."
25010 DATA "KURZBEZEICHNUNG","POSTFRISCH"
25020 DATA "GESTEMPELT","ETB/SAMMELBLATT"
25030 DATA "ERSTTAGSBRIEF","MARKENHEFT"
25040 DATA "MAXIMUMKARTE","BESONDERHEITEN"
25050 DATA "PREISNOTIERUNG","ANZAHL"
25060 DATA "PREIS","SUMME"
