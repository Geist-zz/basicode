1000 A=100:GOTO 20:REM  ** OTHELLO **
1010 DIM F(10,10),I4(8),J4(8),C$(8),D$(3)
1020 HT=HO:VT=VE
1030 GOSUB 100:PRINT:SR$="OTHELLO":GOSUB 150
1040 PRINT" wird auf einem quadrat."
1050 PRINT" Brett gespielt, dessen Zeilen von 1-8"
1060 PRINT" und dessen Reihen von A-H bezeichnet"
1070 PRINT" sind. Die Ausgangsstellung ist alle"
1080 PRINT" Felder leer, ausser den mittleren"
1090 PRINT" die eine feste Form haben."
1100 PRINT" Versuche deine Steine so zu plazieren"
1110 PRINT" dass sie meine einschliessen indem sie"
1120 PRINT" eine horizontale,vertikale oder eine"
1130 PRINT" diagonale Linie bilden. Dann werden"
1140 PRINT" alle neu eingeschlossenen Steine in"
1150 PRINT" deine umgewandelt - und umgekehrt"
1160 PRINT" geht es natuerlich auch !"
1170 HO=0:VE=VT:GOSUB 110:PRINT"(Taste druecken)";
1180 GOSUB 210:GOSUB 100:PRINT
1190 SR$="Beachte":GOSUB 150
1200 PRINT" Du musst mindestens einen"
1210 PRINT" von meinen Steinen schlagen wenn es"
1220 PRINT" moeglich ist; ansonsten gib fuer"
1230 PRINT" Deinen Zug   0,0   ein."
1240 PRINT"****************************************"
1500 REM *** INITIALISIERUNG ***
1510 D$(1)="X":D$(2)=".":D$(3)="O":SD=40
1520 SR$="Falsche Eingabe"
1530 RESTORE:FOR I=1 TO 8:READ I4(I),J4(I),C$(I):NEXT I
1540 PRINT"  Welche Spielfeldgroesse (3...8) ?":GOSUB 210
1550 IF (IN<51) OR (IN>56) THEN GOSUB 150:PRINT:GOTO 1540
1560 M=IN-48:G=INT(M/2)+1:V=INT(M/2)+2
1570 FOR I=1 TO 8:FOR J=1 TO 8:F(I,J)=0:NEXT J:NEXT I
1580 F(G,G)=1:F(V,V)=1:F(V,G)=-1:F(G,V)=-1
1590 C1=2:H1=2:N1=4:Z=0:XX=0:YY=0
1600 PRINT:PRINT"  Welche Betriebsart :"
1610 PRINT"    1 = gegen den Computer"
1620 PRINT"    2 = Computer gegen sich selbst"
1630 PRINT"    3 = zwei Spieler gegeneinander"
1640 GOSUB 210:IF (IN<49) OR (IN>51) THEN GOSUB 150:GOTO 1600
1650 IF IN=50 THEN XX=1:S2=2:C=1:H=-1:GOSUB 3510:GOTO 2010
1660 IF IN=51 THEN YY=1:C=1:H=-1:GOSUB 3510:GOTO 2510
1670 PRINT:PRINT"Soll ich meine grosse Staerke spielen"
1680 PRINT"   oder nicht (Y/N) ?":GOSUB 210
1690 IF IN=89 THEN S2=2:GOTO 1720
1700 IF IN=78 THEN S2=0:GOTO 1720
1710 GOSUB 150:PRINT:GOTO 1670
1720 PRINT:PRINT"  Willst Du  X oder O  ?":GOSUB 210
1730 IF IN=88 THEN C=1:H=-1:GOTO 1760
1740 IF IN=79 THEN C=-1:H=1:GOTO 1760
1750 GOSUB 150:PRINT:GOTO 1720
1760 PRINT:PRINT"  Willst Du anfangen ? Y/N":GOSUB 210
1770 IF IN=89 THEN GOSUB 3510:GOTO 2510
1780 IF IN=78 THEN GOSUB 3510:GOTO 2010
1790 GOSUB 150:PRINT:GOTO 1760
1800 VE=VT-3:HO=0:GOSUB 110::SD=20:GOSUB 450
1810 PRINT"                                    "
1820 PRINT"                                    "
1830 PRINT"                                    "
1840 VE=VT-3:GOSUB 110:RETURN
2000 REM *** COMPUTERZUG ***
2010 T1=C:T2=H
2020 B1=-1:I3=0:J3=0:IF (H1=0) OR (N1=INT(M^2)) THEN 2760
2030 GOSUB 1800
2040 PRINT" Bitte warten  '";D$(T1+2);"'  ist dran"
2050 FOR I=2 TO M+1
2060 FOR J=2 TO M+1
2070 IF F(I,J)<>0 THEN 2170
2080 GOSUB 2910:IF F1=0 THEN 2170
2090 U=-1:GOSUB 3000
2100 IF S1=0 THEN 2170
2110 IF (I-2)*(I-M+1)=0 THEN S1=S1+S2
2120 IF (J-2)*(J-M+1)=0 THEN S1=S1+S2
2130 IF S1<B1 THEN 2170
2140 IF S1>B1 THEN 2160
2150 GOSUB 260:IF RV<.5 THEN 2170
2160 B1=S1:I3=I:J3=J
2170 NEXT J
2180 NEXT I
2190 IF B1>0 THEN 2230
2200 PRINT"  Ich setze aus !"
2210 IF Z=1 THEN 2860
2220 Z=1:GOSUB 450:GOTO 2290
2230 Z=0:PRINT" Ich ziehe nach   ";I3-1;", ";C$(J3-1)
2240 I=I3:J=J3:U=1:GOSUB 3000
2250 IF T1=C THEN C1=C1+S1+1:H1=H1-S1
2260 IF T1=H THEN H1=H1+S1+1:C1=C1-S1
2270 N1=N1+1
2280 PRINT" Ich bekomme ";S1+1;" Steine dazu":GOSUB 3520
2290 IF (XX=1) AND (T1=C) THEN T1=H:T2=C:GOTO 2020
2300 IF XX=1 THEN 2010
2500 REM *** SPIELERZUG ***
2510 T1=H:T2=C
2520 IF (C1=0) OR (N1=INT(M^2)) THEN 2760
2530 GOSUB 1800
2540 PRINT" Dein Zug (Zeile,Spalte),  ";D$(T1+2);"  ";
2550 GOSUB 210:IF (IN<48) OR (IN>56) THEN 2740
2560 I=IN-48:PRINT I;", ";:GOSUB 210:PRINT IN$
2570 IF I=0 THEN Z=1:GOTO 2710
2580 Q=1
2590 IF C$(Q)=IN$ THEN 2620
2600 IF Q<M THEN Q=Q+1:GOTO 2590
2610 GOTO 2750
2620 J=Q:I=I+1:J=J+1
2630 IF F(I,J)<>0 THEN 2750
2640 GOSUB 2910:IF F1<>1 THEN 2740
2650 U=-1:GOSUB 3000:IF S1=0 THEN 2740
2660 Z=0:U=1:GOSUB 3000
2670 PRINT" Du bekommst ";S1+1;" Steine dazu"
2680 IF T1=H THEN H1=H1+S1+1:C1=C1-S1
2690 IF T1=C THEN C1=C1+S1+1:H1=H1-S1
2700 N1=N1+1:GOSUB 3520
2710 IF (YY=1) AND (T1=H) THEN T1=C:T2=H:GOTO 2520
2720 IF YY=1 THEN 2510
2730 GOTO 2010
2740 PRINT:REM fehlerhafte Eingabe
2750 GOSUB 150:GOSUB 450:GOTO 2510
2760 IF (XX=1) OR (YY=1) THEN 2860
2770 GOSUB 1800:IF H1=C1 THEN PRINT" Unentschieden !"
2780 IF H1<C1 THEN PRINT" Diesmal habe ich gewonnen"
2790 IF H1>C1 THEN PRINT" Du hast gewonnen"
2800 PRINT" Das war ein   ";
2810 IF H1>INT(M*M*.9) THEN PRINT"  Super-Spiel":GOTO 2860
2820 IF H1>INT(M*M*.8) THEN PRINT"  perfektes Spiel ":GOTO 2860
2830 IF H1>INT(M*M*.7) THEN PRINT"  grosser Kampf":GOTO 2860
2840 IF H1>INT(M*M*.6) THEN PRINT"  heisses Spiel":GOTO 2860
2850 PRINT"  Mist - Spiel"
2860 SR$=" Ein neues  Spiel ?   Y/N   "
2870 GOSUB 1800:GOSUB 150:GOSUB 210
2880 IF IN=89 THEN GOSUB 100:GOTO 1510
2890 IF IN=78 THEN 950
2900 PRINT:GOTO 2870
2910 F1=0:FOR I1=-1 TO 1:FOR J1=-1 TO 1
2920 IF F(I+I1,J+J1)=T2 THEN F1=1
2930 NEXT J1:NEXT I1
2940 RETURN
3000 S1=0:FOR K=1 TO 8
3010 I5=I4(K):J5=J4(K):I6=I+I5:J6=J+J5:S3=0
3020 IF F(I6,J6)<>T2 THEN 3120
3030 S3=S3+1:I6=I6+I5:J6=J6+J5
3040 IF F(I6,J6)=T1 THEN 3070
3050 IF F(I6,J6)=0 THEN 3120
3060 GOTO 3030
3070 S1=S1+S3:IF U<>1 THEN 3120
3080 I6=I:J6=J
3090 FOR K1=0 TO S3
3100 F(I6,J6)=T1:I6=I6+I5:J6=J6+J5
3110 NEXT K1
3120 NEXT K
3130 RETURN
3500 REM *** SPIELFELD ***
3510 GOSUB 100
3520 VE=9-M:HO=9-M:GOSUB 110
3530 IF (XX=1) OR (YY=1) THEN PRINT"   ";:GOTO 3560
3540 IF S2=0 THEN PRINT"k) ";
3550 IF S2=2 THEN PRINT"g) ";
3560 FOR Q=1 TO M:PRINT C$(Q);" ";:NEXT Q
3570 FOR I=2 TO M+1:VE=VE+2:HO=9-M:GOSUB 110
3580 SR=I-1:GOSUB 300:PRINT" ";SR$;" ";
3590 FOR J=2 TO M+1:PRINT D$(F(I,J)+2);" ";:NEXT J
3600 PRINT:PRINT:NEXT I
3610 IF (XX=1) OR (YY=1) THEN 3630
3620 VE=5:HO=26:GOSUB 110:PRINT"DU   ICH"
3630 VE=7:HO=26:GOSUB 110
3640 IF H=1 THEN PRINT"O     X"
3650 IF H=-1 THEN PRINT"X     O"
3660 VE=13:HO=25:GOSUB 110:SR=H1:CT=2:CN=0:GOSUB 310:PRINT SR$
3670 HO=31:GOSUB 110:SR=C1:GOSUB 310:PRINT SR$
3680 RETURN
25000 DATA 0,1,"A",-1,1,"B",-1,0,"C",-1,-1,"D"
25010 DATA 0,-1,"E",1,-1,"F",1,0,"G",1,1,"H"
32000 REM ****************************
32010 REM *                          *
32020 REM *  STRATEGIESPIEL OTHELLO  *
32030 REM * geschrieben auf  KC 85/4 *
32040 REM *                          *
32050 REM *      Wolfgang Pohle      *
32060 REM *     Waldpromenade  3     *
32070 REM *       Erkner  1250       *
32080 REM *                          *
32090 REM *     Stand 02.02.1990     *
32100 REM *                          *
32110 REM ****************************
32120 REM
32130 REM Erstausstrahlung: DS-Kultur
32140 REM -spezial 900725
