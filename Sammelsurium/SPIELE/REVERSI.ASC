1000 A=200:GOTO 20:REM * REVERSI *
1010 N1$="* R E V E R S I *"
1020 N2$="================="
1030 AK$="abcdefgh":AL$="ABCDEFGH"
1040 S$="":P1=0:P2=0:V1$="":V2$=""
1050 DIM B$(8,8),RX(8),RY(8)
1060 B=4:P=0:S1$="o":S2$="x":H=.47:V=.35
1070 RX(1)=1:RX(2)=0:RX(3)=-1:RX(4)=-1
1080 RY(1)=1:RY(2)=1:RY(3)=1:RY(4)=0
1090 RX(5)=-1:RX(6)=0:RX(7)=1:RX(8)=1
1100 RY(5)=-1:RY(6)=-1:RY(7)=-1:RY(8)=0
1110 FOR I=1 TO 8:FOR J=1 TO 8
1120 B$(I,J)="":NEXT J:NEXT I
1130 B$(4,4)=S1$:B$(4,5)=S2$
1140 B$(5,5)=S1$:B$(5,4)=S2$
1150 REM * HOOFD-MENU *
1160 VE=0:HO=11:GOSUB 100:GOSUB 110:PRINT N1$:VE=1:GOSUB 110
1170 PRINT N2$:VE=6:HO=14:GOSUB 110
1180 PRINT"Hoofd-menu":VE=7:GOSUB 110
1190 PRINT"==========":VE=10:GOSUB 110
1200 PRINT"1 = Uitleg":VE=12:GOSUB 110
1210 PRINT"2 = Het spel":VE=14:GOSUB 110
1220 PRINT"3 = Stoppen":VE=23:HO=28:GOSUB 110
1230 PRINT"Uw keuze";
1240 GOSUB 210:W=VAL(IN$):IF (W<1) OR (W>3) THEN 1240
1250 ON W GOTO 9010,1510,1260
1260 GOSUB 100:GOTO 950
1500 REM * HET SPEL *
1510 GOSUB 100:HO=2:VE=8:GOSUB 110:PRINT"Naam van speler 1";
1520 INPUT P1$
1530 VE=10:GOSUB 110:PRINT"Naam van speler 2";:INPUT P2$
1540 VE=12:GOSUB 110:PRINT P1$;" moet de kruisjes insluiten"
1550 VE=14:GOSUB 110:PRINT P2$;" moet de nulletjes insluiten"
1560 VE=22:HO=30:GOSUB 110:PRINT"<Toets>"
1570 GOSUB 210:IF IN$="" THEN 1570
1580 GOSUB 3010:REM * TEKEN BORD *
1590 GOSUB 7510:REM * PRINT DE STAND *
1600 S$=S1$:GOSUB 3510
1610 IF F<>3 THEN P=0:GOSUB 7510:B=B+1
1620 IF F=3 THEN P=P+1
1630 IF (B=64) OR (P=2) OR (S1=0) OR (S2=0) THEN 2010
1640 S$=S2$:GOSUB 3510
1650 IF F<>3 THEN P=0:GOSUB 7510:B=B+1
1660 IF F=3 THEN P=P+1
1670 IF (B=64) OR (P=2) OR (S1=0) OR (S2=0) THEN 2010
1680 GOTO 1600
2000 REM * EINDE SPEL *
2010 HO=H:VE=V:IF S2=S1 THEN 2060
2020 IF S1>S2 THEN SR$=LEFT$(P1$,10)
2030 IF S2>S1 THEN SR$=LEFT$(P2$,10)
2040 GOSUB 650:HO=.47+(LEN(SR$)+1)*.025
2050 SR$=" wint!!":GOSUB 650:GOTO 2070
2060 SR$="Gelijk spel, allebei":GOSUB 650
2070 HO=H:VE=.45:SR$="   GEFELICITEERD !":GOSUB 650
2080 HO=H:VE=.55:SR$="Nog een spel  <j/n>":GOSUB 650
2090 GOSUB 250:GOSUB 210
2100 IF IN$="j" THEN 1000
2110 GOSUB 100:HO=13:VE=10:GOSUB 110:PRINT"TOT ZIENS!!!"
2120 GOTO 950
2500 HO=H:VE=.45
2510 SR$="Druk een toets in...":GOSUB 650
2520 IF CN=1 THEN CN=0:RETURN
2530 GOSUB 250:GOSUB 210:IN$="":RETURN
2540 HO=0:VE=23:GOSUB 110
2550 PRINT"Druk een <toets> in...";
2560 REM GOSUB250
2570 GOSUB 210:PRINT:RETURN
3000 REM * TEKEN SPEELVELD *
3010 GOSUB 100:GOSUB 600:CN=0:C=.045
3020 FOR HO=.05 TO (8*C+.051) STEP C
3030 VE=.2:GOSUB 620:VE=.68:GOSUB 630
3040 NEXT HO:C=.06
3050 FOR VE=.2 TO (8*C+.201) STEP C
3060 HO=.05:GOSUB 620:HO=.41:GOSUB 630
3070 NEXT VE
3080 SR$=N1$:HO=.25:VE=.04:GOSUB 650
3090 SR$=N2$:VE=.08:GOSUB 650
3100 A$="87654321":A=1:C=.06
3110 HO=0:FOR VE=.22 TO (8*C+.22) STEP C
3120 SR$=MID$(A$,A,1):GOSUB 650:A=A+1:NEXT VE
3130 A=1:C=.045
3140 VE=.7:FOR HO=.06 TO (9*C+.7) STEP C
3150 SR$=MID$(AK$,A,1):GOSUB 650:A=A+1:NEXT HO
3160 SR$="Uw zet   Stand":HO=.63:VE=.75:GOSUB 650
3170 VE=VE+.07:HO=.35
3180 SR$=LEFT$(P1$,10):GOSUB 650:VE=VE+.07
3190 SR$=LEFT$(P2$,10):GOSUB 650:RETURN
3500 REM * VRAAG ZET *
3510 F=1:CN=0:Q=0
3520 GOSUB 3720:GOSUB 6300
3530 GOSUB 4500:CN=1:GOSUB 3720:CN=0:GOSUB 4960
3540 IF (IN$="P") OR (IN$="p") THEN F=3:GOTO 5010
3550 GOSUB 4110:REM * IF <A OR >H *
3560 IF F=2 THEN CN=1:GOSUB 4960:GOSUB 4800:GOTO 3510
3570 REM 
3580 F=1:Q=0:CN=0
3590 CN=1:GOSUB 4960:CN=0:GOSUB 3720:GOSUB 6400
3600 GOSUB 4560:CN=1:GOSUB 3720:CN=0:GOSUB 4960
3610 GOSUB 4210:REM * IF <1 OR >8 *
3620 IF F=2 THEN CN=1:GOSUB 4960:GOSUB 4900:GOTO 3580
3630 B2=VAL(IN$)
3640 IF B$(B1,B2)<>"" THEN CN=1:GOSUB 4960:GOSUB 4010
3650 IF B$(B1,B2)<>"" THEN GOSUB 3720:GOTO 3510
3660 GOSUB 6010:REM * IS ZET LEGAAL *
3670 IF ZZ=0 THEN CN=1:GOSUB 4960:GOSUB 7000:GOSUB 7110
3680 IF ZZ=0 THEN GOSUB 4310:GOTO 3510
3690 IF F<>3 THEN B$(B1,B2)=S$
3700 CN=1:GOSUB 4960:CN=0:RETURN
3710 REM * MEDEDELING SPELER *
3720 Q1$=" (o)":Q2$=" (x)"
3730 HO=.47:VE=.35:SR$=LEFT$(P1$,10)+Q1$
3740 IF S$=S2$ THEN SR$=LEFT$(P2$,10)+Q2$
3750 GOSUB 650
3760 HO=.47+(LEN(SR$)+1)*.025
3770 SR$=" zet!":GOSUB 650
3780 RETURN
4000 REM * VAK BEZET *
4010 GOSUB 6500
4020 SR$="Dit vak is al bezet!":GOSUB 650
4030 IF Q=2 THEN 4050
4040 SD=8:GOSUB 450:IF Q=1 THEN 4010
4050 GOSUB 7000:GOSUB 7110:Q=0:CN=0:RETURN
4100 REM * TUSSEN A EN H *
4110 B1=0
4120 FOR I=1 TO 8
4130 IF (MID$(AK$,I,1)=IN$) OR (MID$(AL$,I,1)=IN$) THEN B1=I
4140 NEXT I
4150 IF B1=0 THEN F=2:RETURN
4160 F=1:RETURN
4200 REM * TUSSEN 1 EN 8 *
4210 IF (VAL(IN$)<1) OR (VAL(IN$)>8) THEN F=2:RETURN
4220 F=1:RETURN
4300 REM * ONJUISTE ZET *
4310 GOSUB 6500
4320 SR$="Onjuiste zet!!":GOSUB 650
4330 IF Q=2 THEN 4350
4340 SD=8:GOSUB 450:IF Q=1 THEN 4310
4350 IF S$=S1$ THEN SR$=W3$:VE=.82
4360 IF S$=S2$ THEN SR$=V3$:VE=.89
4370 GOSUB 7230:CN=0:Q=0:RETURN
4500 HO=.7:VE=.82:IF S$=S2$ THEN VE=.89
4510 GOSUB 210:CN=1:GOSUB 6300
4520 SR$=IN$:CN=0:GOSUB 650
4530 IF S$=S1$ THEN W1$=IN$
4540 IF S$=S2$ THEN V1$=IN$
4550 RETURN
4560 HO=.727:VE=.82:IF S$=S2$ THEN VE=.89
4570 GOSUB 210:CN=1:GOSUB 6400:HO=.727
4580 SR$=IN$:CN=0:GOSUB 650
4590 IF S$=S1$ THEN W2$=IN$
4600 IF S$=S2$ THEN V2$=IN$
4610 W3$=W1$+W2$:V3$=V1$+V2$
4620 RETURN
4800 GOSUB 6500
4810 SR$="Kolom van a tot h !!":GOSUB 650
4820 IF Q=2 THEN 4840
4830 SD=8:GOSUB 450:IF Q=1 THEN 4800
4840 GOSUB 7000:Q=0:CN=0:RETURN
4900 GOSUB 6500
4910 SR$="Rij van 1 tot 8 !!":GOSUB 650
4920 IF Q=2 THEN 4940
4930 SD=8:GOSUB 450:IF Q=1 THEN 4900
4940 GOSUB 7110:Q=0:CN=0:RETURN
4950 REM 
4960 HO=H:VE=V
4970 SR$="Ogenblikje a.u.b. ...":GOSUB 650:RETURN
5000 REM * PASCONTROLE *
5010 Z=0
5020 FOR K=1 TO 8
5030 FOR L=1 TO 8
5040 IF Z=1 THEN 5080
5050 B1=K:B2=L
5060 IF B$(B1,B2)="" THEN GOSUB 6010
5070 IF Z=1 THEN BX=B1:BY=B2
5080 NEXT L
5090 NEXT K
5100 IF Z=1 THEN 5200
5110 IF Z=0 THEN 5300
5120 GOTO 3690
5200 F=1:CN=1:GOSUB 4960
5210 GOSUB 6500
5220 SR$="Onterecht gepast!!":GOSUB 650:GOSUB 5510
5230 GOSUB 2500:IF Q=1 THEN 5210
5240 GOSUB 7000:GOTO 3510
5300 F=3:CN=1:GOSUB 4960
5310 GOSUB 6500
5320 SR$="Terecht gepast!!":GOSUB 650
5330 GOSUB 2500:IF Q=1 THEN 5310
5340 GOSUB 7000:CN=0:Q=0:GOTO 5120
5500 REM * MOGELIJKE ZET *
5510 HO=H:VE=.25:SR$="Goede zet b.v.:":GOSUB 650
5520 HO=.9:SR$=MID$(AK$,BX,1):GOSUB 650
5530 SR=BY:GOSUB 300:HO=.925:GOSUB 650
5540 RETURN
6000 REM * ZETCONTROLE *
6010 Z=0:ZZ=0:FOR I=1 TO 8
6020 T=0:IF (F=3) AND (Z=1) THEN 6190
6030 X=B1+RX(I):Y=B2+RY(I)
6040 T=T+1
6050 IF (X<1) OR (X>8) OR (Y<1) OR (Y>8) THEN 6180
6060 IF (B$(X,Y)="") OR (B$(X,Y)=S$) THEN 6180
6070 X=X+RX(I):Y=Y+RY(I)
6080 T=T+1
6090 IF (X<1) OR (X>8) OR (Y<1) OR (Y>8) THEN 6180
6100 IF (B$(X,Y)<>"") AND (B$(X,Y)<>S$) THEN 6070
6110 IF B$(X,Y)="" THEN 6180
6120 Z=1
6130 IF F=3 THEN 6190
6140 FOR J=1 TO (T-1)
6150 X=X-RX(I):Y=Y-RY(I)
6160 B$(X,Y)=S$
6170 NEXT J:ZZ=1:GOTO 6190
6180 Z=0
6190 NEXT I
6200 RETURN
6300 HO=.7:VE=.82:IF S$=S2$ THEN VE=.89
6310 SR$="?":GOTO 6420
6400 HO=.7:VE=.82:IF S$=S2$ THEN VE=.89
6410 SR$=" ":GOTO 6420
6420 GOSUB 650:SR$="?":HO=.727:GOSUB 650:HO=.7:CN=0:RETURN
6500 HO=H:VE=V:CN=0:Q=Q+1
6510 IF Q=2 THEN CN=1:RETURN
6520 RETURN
7000 CN=1:HO=.7:VE=.82:SR$=W1$
7010 IF S$=S2$ THEN VE=.89:SR$=V1$
7020 GOSUB 650:CN=0:RETURN
7100 REM 
7110 CN=1:HO=.727:VE=.82:SR$=W2$
7120 IF S$=S2$ THEN VE=.89:SR$=V2$
7130 GOSUB 650:CN=0:RETURN
7140 REM 
7150 CN=1:HO=.925:VE=.82:SR=P1:GOSUB 300:GOSUB 650
7160 VE=.89:SR=P2:GOSUB 300:GOSUB 650:CN=0:RETURN
7170 REM 
7200 REM * WISSEN STAND *
7210 IF S$=S1$ THEN VE=.89:SR$=V3$
7220 IF S$=S2$ THEN VE=.82:SR$=W3$
7230 SK$=SR$:SR$=LEFT$(SK$,1):HO=.7:CN=1:GOSUB 650
7240 HO=.727:SR$=RIGHT$(SK$,1):GOSUB 650:CN=0:RETURN
7500 REM * ZETTEN+STAND *
7510 S1=0:S2=0
7520 FOR I=1 TO 8:FOR J=1 TO 8:C=.045:C1=.06
7530 HO=.061+((I-1)*C):VE=.63-((J-1)*C1)
7540 IF B$(I,J)="" THEN 7620
7550 IF (S$="o") AND (B$(I,J)="o") THEN SR$="x":CN=1:GOSUB 650
7560 IF (S$="o") AND (B$(I,J)="o") THEN CN=0:GOTO 7590
7570 IF (S$="x") AND (B$(I,J)="x") THEN SR$="o":CN=1:GOSUB 650
7580 IF (S$="x") AND (B$(I,J)="x") THEN CN=0:GOTO 7590
7590 SR$=B$(I,J):GOSUB 650
7600 IF SR$=S1$ THEN S1=S1+1
7610 IF SR$=S2$ THEN S2=S2+1
7620 NEXT J:NEXT I:GOSUB 7150
7630 HO=.925:VE=.82:SR=S1:GOSUB 300:GOSUB 650
7640 VE=.89:SR=S2:GOSUB 300:GOSUB 650
7650 P1=S1:P2=S2:P3=P3+1
7660 IF P3>=3 THEN GOSUB 7210
7670 RETURN
9000 REM * UITLEG *
9010 GOSUB 100:VE=0:HO=14:GOSUB 110
9020 PRINT"* REVERSI *":VE=VE+1:GOSUB 110
9030 PRINT"===========":HO=0:VE=2:GOSUB 110
9040 PRINT"Uitleg.":VE=VE+1:GOSUB 110
9050 PRINT"=======":HO=0:VE=6:GOSUB 110
9060 PRINT"Dit is de computer-versie van het"
9070 PRINT"beroemde spel Reversi."
9080 PRINT
9090 PRINT"Er wordt gespeeld op een veld met 64"
9100 PRINT"vakjes. Bij het begin van het spel"
9110 PRINT"bezitten beide spelers twee vakjes."
9120 PRINT
9130 PRINT"Het gaat erom zoveel mogelijk vakjes"
9140 PRINT"te 'veroveren'."
9150 GOSUB 2540:GOSUB 100:VE=2:GOSUB 110
9160 PRINT"Insluiten / Veroveren.":VE=3:GOSUB 110
9170 PRINT"======================":VE=6:GOSUB 110
9180 PRINT"Om beurten bezetten de spelers een leeg"
9190 PRINT"vakje en wel zo dat hierdoor een of"
9200 PRINT"meer, in een rechte lijn, aansluitende"
9210 PRINT"vakjes van de ander worden ingesloten."
9220 PRINT
9230 PRINT"De ingesloten vakjes verwisselen nu van"
9240 PRINT"eigenaar.(N.B.:Een vakje kan dus meer-"
9250 PRINT"dere keren van eigenaar wisselen!)."
9260 PRINT
9270 PRINT"Insluiten kan in alle richtingen,"
9280 PRINT"ook tegelijkertijd, gebeuren :"
9290 PRINT"vertikaal, horizontaal en diagonaal."
9300 PRINT"Een vakje bezetten wordt gedaan door"
9310 PRINT"een coordinaat in te typen bv.:'a1'."
9320 GOSUB 2540:GOSUB 100:VE=2:HO=0:GOSUB 110
9330 PRINT"Passen.":VE=VE+1:GOSUB 110
9340 PRINT"=======":VE=6:GOSUB 110
9350 PRINT"Als een speler geen vakje kan bezetten"
9360 PRINT"waarbij een of meer vakjes van de"
9370 PRINT"tegenspeler worden ingesloten dan moet"
9380 PRINT"worden gepast. Dit kan door 'p' in te"
9390 PRINT"typen. De computer controleert dan of"
9400 PRINT"dit terecht wordt gedaan of niet."
9410 PRINT"Als terecht wordt gepast dan komt de"
9420 PRINT"andere speler aan de beurt."
9430 PRINT"Als onterecht wordt gepast dan wordt"
9440 PRINT"aangegeven welke zet toch mogelijk is,"
9450 PRINT"wat echter niet de meest profijtelijke"
9460 PRINT"hoeft te zijn. Het zal duidelijk zijn"
9470 PRINT"dat deze mogelijkheid kan helpen op een"
9480 PRINT"moment dat de speler niet direkt ziet"
9490 PRINT"wat een goede zet is."
9500 GOSUB 2540:GOSUB 100:VE=2:HO=0:GOSUB 110
9510 PRINT"Einde spel.":VE=VE+1:GOSUB 110
9520 PRINT"===========":VE=6:GOSUB 110
9530 PRINT"Het spel is uit als alle vakjes bezet"
9540 PRINT"zijn of wanneer bij gebrek aan"
9550 PRINT"mogelijkheden tot insluiten geen vakje"
9560 PRINT"meer bezet kan worden en beide spelers"
9570 PRINT"dus moeten passen."
9580 PRINT
9590 PRINT"Wie de meeste vakjes bezet is winnaar !"
9600 PRINT
9610 PRINT"Succes !"
9620 PRINT
9630 GOSUB 2540:GOTO 1160
32000 REM 
32010 REM 
32020 REM ************************
32030 REM *                      *
32040 REM *     * REVERSI *      *
32050 REM *                      *
32060 REM * Een programma van:   *
32070 REM *                      *
32080 REM * J.S. ROSMAN          *
32090 REM * Ch.Th.STORKSTRAAT 88 *
32100 REM * 3119 VE  SCHIEDAM    *
32110 REM *                      *
32120 REM * Versie 2 : Feb 1987  *
32130 REM *                      *
32140 REM * Aangepast aan        *
32150 REM * B A S I C O D E - 3  *
32160 REM * door:                *
32170 REM *                      *
32180 REM *   P.A.KESTELOO       *
32190 REM *   REEDE 34           *
32200 REM *   3232 CV  BRIELLE   *
32210 REM *   Tel. 01810-15569   *
32220 REM *                      *
32230 REM *     14 Nov 1987      *
32240 REM *     COMMODORE 64     *
32250 REM *                      *
32260 REM ************************
32270 REM 
32280 REM TROS-RADIO dd 880518
32290 REM incl.corr. dd 880922
