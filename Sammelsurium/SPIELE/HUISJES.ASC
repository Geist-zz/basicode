1000 A=500:GOTO 20:REM ZET DE HUISJES OP EEN RIJ
1010 DIM C(11,5),C1(11,5),FL(10),A(9),S$(10),RI(4)
1020 SO$="9161542132334253636293847421626141443112"
1040 HT=HO:VT=VE:VD=0:HU=0
1050 A(0)=-4:A(1)=-2:A(2)=-1:A(3)=1:A(4)=2:A(5)=4
1060 A(6)=-2:A(7)=-1:A(8)=1:A(9)=2
1070 REM STUKJES INLEZEN
1080 FOR I=1 TO 9:READ S$(I):NEXT I
1090 REM SPEELVELD VOORBEREIDEN
1100 FOR VP=0 TO 4:FOR HP=0 TO 11
1110 C(HP,VP)=-1:NEXT HP:NEXT VP
1120 REM STUKJES IN BEGINSTAND PLAATSEN
1130 SR$="002255777711335588881144669900"
1140 FOR VP=1 TO 3:FOR HP=1 TO 10
1150 C(HP,VP)=ASC(MID$(SR$,HP+10*VP-10,1))-48
1160 NEXT HP:NEXT VP
1170 REM EENHEIDSSTAPPEN H/V BEPALEN
1180 AH=INT((HG*.9375*.958-2)/10):AV=INT((VG*.958-2)/8)
1190 IF VD=0 THEN GOSUB 6010:REM UITLEG
1200 GOSUB 600:CN=0
1210 REM TEKEN BUITENKADER
1220 HO=0:VE=0:GOSUB 620
1230 HO=(2.1+10*AH)/HG:GOSUB 630
1240 VE=(2.1+6*AV)/VG:GOSUB 630
1250 HO=0:GOSUB 630:VE=0:GOSUB 630
1260 REM TEKEN BLOKKEN
1270 FOR I=0 TO 10:FL(I)=0:NEXT I:REM 0=NOG NIET GETEKEND
1280 FOR HP=1 TO 10
1290 FOR VP=1 TO 3
1300 IF FL(C(HP,VP))=1 THEN 1340:REM REEDS GETEKEND
1310 FL(C(HP,VP))=1
1320 IF C(HP,VP)=0 THEN 1340
1330 TB=0:GOSUB 4020:REM TEKEN BLOK
1340 NEXT VP
1350 NEXT HP
1360 ZT=0
1370 VE=.7584:HO=0
1380 CN=1:GOSUB 620:CN=0
1390 IF VD=0 THEN 1500:REM NIET VOORDOEN
1400 SR=ZT:GOSUB 300:SR$="Voordoen; Zet "+SR$
1410 CN=1:GOSUB 650
1420 IF 2*ZT<LEN(SO$) THEN 1450
1430 CN=0:HO=.5:SR$="Klaar, druk toets"
1440 GOSUB 650:GOSUB 210:GOSUB 100:GOTO 950
1450 ZT=ZT+1:ZZ$=MID$(SO$,2*ZT-1,2)
1460 SR=ZT:GOSUB 300:SR$="Voordoen; Zet "+SR$
1470 CN=0:GOSUB 650
1480 IN$="":BL=VAL(LEFT$(ZZ$,1)):IF BL=0 THEN BL=9
1490 GOTO 1560
1500 SR$="Welk blok ? ":GOSUB 650
1510 GOSUB 210:BL=IN-64
1520 IF IN=83 THEN GOSUB 100:GOTO 950:REM STOPPEN
1530 IF IN=86 THEN VD=1:ZT=0:GOTO 1100:REM VOORDOEN
1540 IF (BL<1) OR (BL>9) THEN GOSUB 250:GOTO 1510
1550 CN=1:GOSUB 650
1560 FOR I=0 TO 3:RI(I)=0:NEXT I:BH=0
1570 FOR HP=1 TO 10:FOR VP=1 TO 4
1580 IF C(HP,VP)<>BL THEN 1650:REM ANDER STUKJE
1590 IF BH=0 THEN BH=HP:BV=VP
1600 REM KIJK WELKE RICHTINGEN KUNNEN
1610 IF (C(HP+1,VP)<>BL) AND (C(HP+1,VP)<>0) THEN RI(0)=1
1620 IF (C(HP,VP-1)<>BL) AND (C(HP,VP-1)<>0) THEN RI(1)=1
1630 IF (C(HP-1,VP)<>BL) AND (C(HP-1,VP)<>0) THEN RI(2)=1
1640 IF (C(HP,VP+1)<>BL) AND (C(HP,VP+1)<>0) THEN RI(3)=1
1650 NEXT VP:NEXT HP
1660 CN=1:GOSUB 620:CN=0
1670 SR$="Blok "+IN$+", Welke richting ":S1$="("
1680 RI(4)=0
1690 FOR I=0 TO 3
1700 IF RI(I)=1 THEN 1750
1710 IF RI(4)>0 THEN RI(4)=-1:GOTO 1740
1720 REM MOGELIJKE RICHTING MELDEN
1730 IF RI(4)=0 THEN RI(4)=I+1
1740 SR$=SR$+S1$+MID$("ONWZ",I+1,1):S1$=","
1750 NEXT I
1760 IF VD=1 THEN RI(4)=VAL(RIGHT$(ZZ$,1)):REM VOORDOEN
1770 IF RI(4)=0 THEN GOSUB 250:GOTO 1370:REM KAN NIET
1780 IF RI(4)>0 THEN 1880
1790 SR$=SR$+")":GOSUB 650
1800 GOSUB 210:REM VRAAG RICHTING
1810 IF (IN=79) AND (RI(0))=0 THEN RI(4)=1:GOTO 1860:REM O
1820 IF (IN=78) AND (RI(1))=0 THEN RI(4)=2:GOTO 1860:REM N
1830 IF (IN=87) AND (RI(2))=0 THEN RI(4)=3:GOTO 1860:REM W
1840 IF (IN=90) AND (RI(3))=0 THEN RI(4)=4:GOTO 1860:REM Z
1850 GOSUB 250:GOTO 1800
1860 CN=1:GOSUB 650:REM WIS REGEL
1870 REM WIS OUD BLOK
1880 HP=BH:VP=BV:TB=1:GOSUB 4020
1890 REM GA BEWEGEN
1900 FOR HP=1 TO 10:FOR VP=1 TO 3
1910 C1(HP,VP)=C(HP,VP):NEXT VP:NEXT HP:KN=0
1920 FOR HP=1 TO 10:FOR VP=1 TO 3
1930 C(HP,VP)=C1(HP,VP):NEXT VP:NEXT HP
1940 IF RI(4)<>1 THEN 2020:REM NIET OOST
1950 REM BEWEEG IN OOSTELIJKE RICHTING
1960 FOR HP=11 TO 2 STEP -1:FOR VP=1 TO 3
1970 IF C(HP-1,VP)<>BL THEN 2010:REM DEZE NIET
1980 IF C(HP,VP)=BL THEN 2000:REM KAN
1990 IF C(HP,VP)<>0 THEN KN=1:GOTO 2010:REM KAN NIET
2000 C1(HP,VP)=BL:C1(HP-1,VP)=0
2010 NEXT VP:NEXT HP:IF KN=0 THEN BH=BH+1:GOTO 1920
2020 IF RI(4)<>2 THEN 2090:REM NIET NOORD
2030 FOR HP=1 TO 10:FOR VP=0 TO 3
2040 IF C(HP,VP+1)<>BL THEN 2080:REM DEZE NIET
2050 IF C(HP,VP)=BL THEN 2070
2060 IF C(HP,VP)<>0 THEN KN=1:GOTO 2080:REM KAN NIET
2070 C1(HP,VP)=BL:C1(HP,VP+1)=0
2080 NEXT VP:NEXT HP:IF KN=0 THEN BV=BV-1:GOTO 1920
2090 IF RI(4)<>3 THEN 2160:REM NIET WEST
2100 FOR HP=0 TO 9:FOR VP=1 TO 4
2110 IF C(HP+1,VP)<>BL THEN 2150:REM DEZE NIET
2120 IF C(HP,VP)=BL THEN 2140
2130 IF C(HP,VP)<>0 THEN KN=1:GOTO 2150:REM KAN NIET
2140 C1(HP,VP)=BL:C1(HP+1,VP)=0
2150 NEXT VP:NEXT HP:IF KN=0 THEN BH=BH-1:GOTO 1920
2160 IF RI(4)<>4 THEN 2240:REM NIET ZUID
2170 FOR HP=1 TO 10:FORVP=5 TO2 STEP -1
2180 IF C(HP,VP-1)<>BL THEN 2220:REM DEZE NIET
2190 IF C(HP,VP)=BL THEN 2210
2200 IF C(HP,VP)<>0 THEN KN=1:GOTO 2220:REM KAN NIET
2210 C1(HP,VP)=BL:C1(HP,VP-1)=0
2220 NEXT VP:NEXT HP:IF KN=0 THEN BV=BV+1:GOTO 1920
2230 REM BEWOGEN
2240 HP=BH:VP=BV:TB=0:GOSUB 4020:REM TEKEN NIEUW
2250 GOTO 1370
4000 REM SR TEKEN OF WIS BLOK
4010 REM DRAW BLOCK C(HP,VP) FROM POSITION HP,VP
4020 PH=2.1+(HP-1)*AH:PV=2.1+(VP-1)*2*AV
4030 HO=(PH+AH/2-6)/HG:VE=(PV+AV/2-6)/VG
4040 CN=1:GOSUB 620:CN=TB:SR$=CHR$(64+C(HP,VP)):GOSUB 650
4050 HO=PH/HG:VE=PV/VG:GOSUB 620
4060 FOR I=1 TO LEN(S$(C(HP,VP)))
4070 SR=VAL(MID$(S$(C(HP,VP)),I,1))
4080 IF I=2*INT(I/2) THEN 4120:REM I=EVEN=HP
4090 REM I=ONEVEN=VP
4100 IF SR<6 THEN PV=PV-2*SGN(A(SR))
4110 PV=PV+A(SR)*AV:GOTO 4140
4120 IF SR<6 THEN PH=PH-2*SGN(A(SR))
4130 PH=PH+A(SR)*AH
4140 HO=PH/HG:VE=PV/VG:GOSUB 630
4150 NEXT I
4160 GOSUB 330
4170 IF (SR$="A") OR (SR$="D") THEN GOSUB 5010
4180 IF (SR$="E") OR (SR$="G") THEN GOSUB 5010
4190 RETURN
5000 REM * HUISJES *
5010 HO=(PH+AH/2-4)/HG:VE=(PV+AV/2-4)/VG
5020 HO=HO+.03:IF (SR$="G") AND (HU=1) THEN HO=HO+.17
5030 VE=VE+.075:IF SR$="A" THEN VE=VE+.23
5040 GOSUB 620:HO=HO+.05:GOSUB 630
5050 VE=VE+.06:GOSUB 630:HO=HO-.05:GOSUB 630:VE=VE-.06
5060 GOSUB 630:HO=HO+.025:VE=VE-.06:GOSUB 630:HO=HO+.025
5070 VE=VE+.06:GOSUB 630:VE=VE+.02
5080 GOSUB 620:HO=HO-.02:GOSUB 630:VE=VE+.04:GOSUB 630
5090 HO=HO-.01:VE=VE-.02:GOSUB 620:HO=HO-.01:GOSUB 630
5100 VE=VE-.015
5110 GOSUB 630:HO=HO+.01:GOSUB 630:VE=VE+.015:GOSUB 630
5120 HO=HO-.015
5130 VE=VE-.065:GOSUB 620:VE=VE-.03:GOSUB 630:HO=HO+.01
5140 GOSUB 630:VE=VE+.015:GOSUB 630
5150 HO=PH/HG:VE=PV/VG
5160 IF SR$="G" THEN HU=HU+1
5170 IF HU=1 THEN 5010
5180 HU=0
5190 RETURN
6000 REM UITLEG
6010 SR$="Zet de HUISJES op een rij":GOSUB 150
6020 PRINT :PRINT 
6030 PRINT "Deze puzzel bestaat  uit een"
6040 PRINT "speelbord met daarop een aantal"
6050 PRINT "stukjes,die met de letters A tot"
6060 PRINT "en met I zijn aangeduid.":PRINT 
6070 PRINT "Er zijn vijf vierkante stukjes"
6080 PRINT "en vier rechthoek-vormige.":PRINT 
6090 PRINT "Begin met de opstelling na te tekenen."
6100 GOSUB 6350
6110 PRINT "Het is dan de bedoeling dat u met"
6120 PRINT "deze stukjes gaat schuiven."
6130 PRINT "Daartoe geeft u mij telkens eerst"
6140 PRINT "de letter op van het te verschuiven"
6150 PRINT "stuk. Indien nodig moet u mij"
6160 PRINT "tevens opgeven in welke richting"
6170 PRINT "(N)oord, (O)ost, (Z)uid of (W)est"
6180 PRINT "het stukje moet worden verschoven.":PRINT 
6190 PRINT "Het doel van het spel is, om te"
6200 PRINT "zorgen dat de  HUISJES  op de"
6210 PRINT "MIDDELSTE rij naast elkaar komen"
6220 PRINT "te staan.":PRINT 
6230 PRINT "Waar dan andere blokjes terecht"
6240 PRINT "komen doet er niet toe."
6250 GOSUB 6350
6260 PRINT "Het kan in 20 verplaatsingen en"
6270 PRINT "het is knap moeilijk om er uit"
6280 PRINT "te komen.":PRINT 
6290 PRINT "Als u het opgeeft, druk dan op"
6300 PRINT "de S en als u vindt  dat ik het"
6310 PRINT "maar voor moet doen, druk dan op"
6320 PRINT "de V.":PRINT 
6330 PRINT "Veel plezier!"
6340 REM SPATIE VOOR VERDER
6350 HO=0:VE=VT:GOSUB 110
6360 SR$="<spatie> voor verder":GOSUB 150
6370 GOSUB 210:IF IN<>32 THEN 6370
6380 GOSUB 100:RETURN
25000 REM VORMEN EN MATEN VAN DE STUKJES
25010 DATA "5401","4411","4411","4411","5401"
25020 DATA "4411","4510","4510","4411"
25030 REM 
30000 REM DEZE PUZZEL WERD IN 1934 GEMAAKT
30010 REM DOOR RICHARD W. FATIGUANT OM DE
30020 REM GEBOORTE TE VIEREN VAN DE EERSTE
30030 REM VIJFLING TER WERELD DIE IN LEVEN
30040 REM BLEEF, DE DIONNE-VIJFLING.
30050 REM 
32000 REM #########################
32010 REM #                       #
32020 REM #  DIT PROGRAMMA IS OP  #
32030 REM #  09-05-1988 GEMAAKT   #
32040 REM #        DOOR:          #
32050 REM #                       #
32060 REM #    P.A. KESTELOO      #
32070 REM #    REEDE 34           #
32080 REM #    3232 CV BRIELLE    #
32090 REM #                       #
32100 REM #  NAAR AANLEIDING VAN  #
32110 REM #    ESCOT'S PUZZEL     #
32120 REM #         VAN           #
32130 REM #      J.HAUBRICH       #
32140 REM #                       #
32150 REM #########################
32160 REM 
32170 REM TROS-RADIO dd 880810
32180 REM incl corr. dd 880821
