1000 A=200:GOTO 20:REM CALCULATION PANEL
1010 DIM GE(9,4),FO$(18),U$(18)
1020 N=0:R=0:K=0:U=0
1030 GOSUB 11000:REM EXPLANATION
1040 FOR X=1 TO 18:FO$(X)="0":U$(X)="0":NEXT X
1050 FOR C=0 TO 9:FOR D=1 TO 4:GE(C,D)=0:NEXT D:NEXT C
1060 GOSUB 9000
1070 N=1:GOSUB 8030
1080 IF R=1 THEN N=5:GOSUB 8030:N=1:GOSUB 8030:R=0
1090 PRINT"(S=stop) R,G or F";:INPUT SR$
1100 GOSUB 330:IN$=SR$
1110 IF IN$="G" THEN 2030
1120 IF IN$="R" THEN 10030
1130 IF IN$="F" THEN 3030
1140 IF IN$="K" THEN 2120
1150 IF IN$="S" THEN 950
1160 GOTO 1070
2000 REM 
2010 REM NUMBER
2020 REM 
2030 N=1:GOSUB 8030
2040 N=2:GOSUB 8030
2050 FOR X=1 TO LEN(A$)
2060 T$=MID$(A$,X,1)
2070 IF T$>"J" THEN R=1
2080 NEXT X:IF R=1 THEN 1070
2090 GOSUB 6030:REM CALCULATE
2100 GOSUB 7030:REM PRINT
2110 GOTO 3060
2120 N=1:GOSUB 8030:N=4:GOSUB 8030:GOTO 1070
3000 REM 
3010 REM FORMULA
3020 REM 
3030 N=1:GOSUB 8030
3040 N=3:GOSUB 8030
3050 GOSUB 7530:REM PRINT FORMULA
3060 FOR S=1 TO 18
3070 GOSUB 5030:REM CALCULATURE
3080 REM COMPLETE U$
3090 CT=7:CN=K:SR=U:GOSUB 310:U$(S)=SR$
3100 GOSUB 4030:REM PRINT U$
3110 NEXT S
3120 HO=0:VE=9:GOSUB 110:GOTO 1070
4000 REM 
4010 REM PRINT U$
4020 REM 
4030 IF S>9 THEN 4070
4040 HO=11:VE=14+S:GOSUB 110
4050 PRINT"       ";:GOSUB 110
4060 PRINT U$(S);:RETURN
4070 HO=31:VE=5+S:GOSUB 110
4080 PRINT"       ";:GOSUB 110
4090 PRINT U$(S);:RETURN
5000 REM 
5010 REM CALCULATE U$
5020 REM 
5030 L=LEN(FO$(S)):IF L<3 THEN U=0:RETURN
5040 GOSUB 5160:REM 
5050 IF L<=5 THEN RETURN
5060 GOSUB 5250:REM 
5070 IF L<=8 THEN RETURN
5080 GOSUB 5310:REM 
5090 RETURN
5100 REM 
5110 IF T$="+" THEN T=1:RETURN
5120 IF T$="-" THEN T=2:RETURN
5130 IF T$="/" THEN T=3:RETURN
5140 IF T$="*" THEN T=4:RETURN
5150 REM 
5160 A$=LEFT$(FO$(S),1)
5170 A=ASC(A$)-ASC("A")
5180 B=VAL(MID$(FO$(S),2,1))
5190 C$=MID$(FO$(S),4,1)
5200 C=ASC(C$)-ASC("A")
5210 D=VAL(MID$(FO$(S),5,1))
5220 T$=MID$(FO$(S),3,1):GOSUB 5110
5230 ON T GOSUB 5370,5380,5390,5400
5240 RETURN
5250 A$=MID$(FO$(S),7,1)
5260 A=ASC(A$)-ASC("A")
5270 B=VAL(MID$(FO$(S),8,1))
5280 T$=MID$(FO$(S),6,1):GOSUB 5110
5290 ON T GOSUB 5410,5420,5430,5440
5300 RETURN
5310 A$=MID$(FO$(S),10,1)
5320 A=ASC(A$)-ASC("A")
5330 B=VAL(MID$(FO$(S),11,1))
5340 T$=MID$(FO$(S),9,1):GOSUB 5110
5350 ON T GOSUB 5410,5420,5430,5440
5360 RETURN
5370 U=GE(A,B)+GE(C,D):RETURN
5380 U=GE(A,B)-GE(C,D):RETURN
5390 U=GE(A,B)/GE(C,D):RETURN
5400 U=GE(A,B)*GE(C,D):RETURN
5410 U=U+GE(A,B):RETURN
5420 U=U-GE(A,B):RETURN
5430 U=U/GE(A,B):RETURN
5440 U=U*GE(A,B):RETURN
6000 REM 
6010 REM CALCULATE GE
6020 REM 
6030 E$=LEFT$(A$,1)
6040 C=ASC(E$)-ASC("A")
6050 D=VAL(RIGHT$(A$,1))
6060 GE(C,D)=B
6070 RETURN
7000 REM 
7010 REM PRINT NUMBER
7020 REM 
7030 G$="        "
7040 VE=2:GOSUB 110
7050 FOR C=0 TO 9
7060 HO=2:GOSUB 110
7070 FOR D=1 TO 4
7080 PRINT G$
7090 HO=HO+8:GOSUB 110
7100 IF GE(C,D)=0 THEN 7140
7110 SR=GE(C,D):GOSUB 300:HO=HO-1-LEN(SR$):GOSUB 110
7120 PRINT GE(C,D)
7130 HO=HO+1+LEN(SR$):GOSUB 110
7140 NEXT D
7150 VE=VE+1:GOSUB 110
7160 NEXT C:RETURN
7500 REM 
7510 REM PRINT FORMULA
7520 REM 
7530 IF F>9 THEN 7570
7540 HO=0:VE=14+F:GOSUB 110
7550 PRINT"           ":HO=0:GOSUB 110
7560 PRINT FO$(F):RETURN
7570 HO=19:VE=5+F:GOSUB 110
7580 PRINT"           ":HO=20:GOSUB 110
7590 PRINT FO$(F):RETURN
8000 REM 
8010 REM INPUT
8020 REM 
8030 HO=0:VE=13:GOSUB 110
8040 PRINT"                 "
8050 GOSUB 110
8060 ON N GOSUB 8080,8100,8130,8190,8200
8070 HO=0:GOSUB 110:RETURN
8080 PRINT"                                      "
8090 RETURN
8100 PRINT"Which Box";:INPUT SR$:GOSUB 330:A$=SR$
8110 HO=19:GOSUB 110
8120 PRINT"What Number";:INPUT B:RETURN
8130 PRINT"Formula no";:INPUT F
8140 IF (F<1) OR (F>18) THEN GOSUB 250:GOTO 8030
8150 HO=0:GOSUB 110:PRINT"                 "
8160 HO=0:GOSUB 110
8170 PRINT"Formula ";:INPUT SR$:GOSUB 330
8180 FO$(F)=SR$:RETURN
8190 PRINT"How many decimal places";:INPUT K:RETURN
8200 PRINT"       WRONG INPUT"
8210 SD=50:GOSUB 450:RETURN
9000 GOSUB 120:GOSUB 110
9010 PRINT"      1       2       3       4"
9020 HO=0:VE=VE+1:GOSUB 110:GOSUB 9280
9030 HO=0:VE=1:GOSUB 110
9040 FOR X=1 TO 10
9050 VE=VE+1:GOSUB 110
9060 PRINT MID$("ABCDEFGHIJ",X,1)
9070 NEXT X
9080 HO=0:VE=12:GOSUB 110:GOSUB 9280
9090 VE=14:GOSUB 110:GOSUB 9280
9100 GOSUB 110
9110 FOR X=1 TO 2
9120 FOR Y=1 TO 9
9130 VE=Y+14:GOSUB 110
9140 PRINT"Formula";Y+N;
9150 NEXT Y
9160 HO=20
9170 N=9
9180 NEXT X
9190 HO=9
9200 FOR X=1 TO 2
9210 FOR Y=1 TO 9
9220 VE=Y+14:GOSUB 110
9230 PRINT"=";
9240 NEXT Y
9250 HO=29
9260 NEXT X:HO=0:VE=13:GOSUB 110
9270 RETURN
9280 PRINT"---------------------------------------"
9290 RETURN
10000 REM 
10010 REM CALCULATE
10020 REM 
10030 N=1:GOSUB 8030
10040 S=0:R=0
10050 INPUT SR$:GOSUB 330:FO$(S)=SR$
10060 REM CONTROL ENTRY
10070 L=LEN(FO$(S)):T=0:P=0:G=0
10080 FOR X=1 TO L
10090 T$=MID$(FO$(S),X,1)
10100 IF (T$<CHR$(42)) OR (T$>CHR$(57)) THEN R=1
10110 IF (T$>="A") AND (T$<="J") THEN G=1
10120 IF T$="," THEN R=1
10130 IF T$="+" THEN V=1:P=X
10140 IF T$="-" THEN V=2:P=X
10150 IF T$="/" THEN V=3:P=X
10160 IF T$="*" THEN V=4:P=X
10170 NEXT X
10180 IF G=1 THEN GOSUB 5030:GOTO 10230
10190 IF R=1 THEN 10300
10200 A=VAL(MID$(FO$(S),1,P-1))
10210 B=VAL(MID$(FO$(S),P+1,L-P+1))
10220 ON V GOSUB 10260,10270,10280,10290
10230 N=1:GOSUB 8030:HO=0:GOSUB 110
10240 PRINT"(T,R)"
10250 HO=7:GOSUB 110:PRINT FO$(S);" =";U:GOTO 10330
10260 U=B+A:RETURN
10270 U=A-(B):RETURN
10280 U=A/B:RETURN
10290 U=A*B:RETURN
10300 N=1:GOSUB 8030:N=5:GOSUB 8030:R=0
10310 N=1:GOSUB 8030
10320 HO=0:GOSUB 110:PRINT"(T or R)"
10330 GOSUB 200
10340 IF IN=82 THEN 10030:REM R
10350 IF IN=84 THEN 1070:REM T
10360 GOTO 10330
11000 HO=10:VE=0:GOSUB 110
11010 SR$="CALCULATION PANEL":GOSUB 150
11020 HO=0:VE=2:GOSUB 110
11030 READ A$
11040 IF A$="*" THEN VE=VE+1:GOSUB 110:GOTO 11030
11050 IF A$="***" THEN 12000
11060 PRINT A$:VE=VE+1:GOSUB 110:GOTO 11030
12000 GOSUB 210:GOSUB 100:RETURN
25000 DATA "G=enter number (max.7 characters) ex."
25010 DATA " Input box: A1 or J3 or B4"
25020 DATA " Enter number: 123 or -234 or 23.4"
25030 DATA "*"
25040 DATA "F=enter formula (max.4 characters) ex."
25050 DATA " Input formula no.:number from 1 to 18"
25060 DATA " Input formula:A1+B2-C4/D1;0=empty"
25070 DATA "*"
25075 DATA "K=enter comma in the results"
25078 DATA "*"
25080 DATA "If the result of the formula is negative"
25090 DATA ", or is too big you will get '*******'"
25100 DATA "You can then always use"
25110 DATA "the calculation rule"
25115 DATA "Calculations are performed from"
25116 DATA "left to right"
25120 DATA "*"
25130 DATA "R=count on the entry line ex."
25140 DATA " Enter numbers(max.2): 123*345"
25150 DATA " Input boxes(max.4) :  A3*I1/C2+A3"
25160 DATA "T=back to calculator"
25170 DATA "*"
25300 DATA "***"
32000 REM  CALCULATION PANEL
32010 REM 
32020 REM  is made by:
32030 REM 
32040 REM  J. Florijn
32050 REM  AMERSFOORT
32060 REM 
32070 REM  January 1988
32080 REM 
32090 REM TROS RADIO dd 880302
