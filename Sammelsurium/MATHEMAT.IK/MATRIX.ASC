1000 A=700:GOTO 20:REM MATRIX MANIPULATIE
1010 REM 
1020 REM HANDLEIDING / MENU
1030 REM 
1040 SB=HO:SH=VE:GOSUB 100
1050 HO=SB/2-14.5:VE=SH/2-3:GOSUB 110
1060 PRINT"*** **  ***  **** ****  ** ** *":VE=VE+1:GOSUB 110
1070 PRINT"** * * **  *  **  **  * ** ** *":VE=VE+1:GOSUB 110
1080 PRINT"**   * *****  **  ****  **  **":VE=VE+1:GOSUB 110
1090 PRINT"**   * **  *  **  ** *  ** * **":VE=VE+1:GOSUB 110
1100 PRINT"**   * **  *  **  **  * ** * **":VE=VE+2:GOSUB 110
1110 PRINT"M  A  N  I  P  U  L  A  T  I  E":GOSUB 2120
1120 GOSUB 100:PRINT"-Met dit programma is het mogelijk de"
1130 PRINT"volgende matrix-operaties uit te voeren:"
1140 VE=3:HO=0:GOSUB 110
1150 PRINT"    [+] optellen van twee matrices.":PRINT
1160 PRINT"    [=] aftrekken van twee matrices.":PRINT
1170 PRINT"    [*] vermenigvuldigen van twee ma-"
1180 PRINT"        trices.":PRINT
1190 PRINT"    [^] machtsverheffen van een matrix.":PRINT
1200 PRINT"    [S] berekenen van een oplossingsma-"
1210 PRINT"        trix met bijbehorende diameter.":PRINT
1220 PRINT"    [I] inverteren van een matrix.":PRINT
1230 PRINT"    [W] wissen van een matrix.":PRINT
1240 PRINT"    [T] transponeren van een matrix.":PRINT
1250 PRINT"    [O] overzetten van het resultaat."
1260 GOSUB 2120:GOSUB 100
1270 PRINT"-Het invoeren van de elementen gaat met"
1280 PRINT"behulp van de cursor-besturingstoetsen."
1290 PRINT"-Buiten de reeds genoemde toetsen, kun-"
1300 PRINT"nen de volgende toetsen gebruikt worden:"
1310 PRINT"    [0] [1] [2] [3] [4]":PRINT
1320 PRINT"    [5] [6] [7] [8] [9]":PRINT
1330 PRINT"    [-] voor negatieve elementen.":PRINT
1340 PRINT"    [.] voor decimalen.":PRINT
1350 PRINT"    [DEL/SPC] om fouten te herstellen.":PRINT
1360 PRINT"    [RETURN] volgende regel.":PRINT
1370 PRINT"    [/] volgende matrix.":PRINT
1380 PRINT"    [P] schermafdruk op de printer.":PRINT
1390 PRINT"    [E] programma beeindigen.":PRINT
1400 GOSUB 2120:GOSUB 100
1500 REM 
1510 REM ELEMENT-GROOTTE VASTSTELLEN
1520 REM 
1530 HO=SB/2-19.5:VE=1:GOSUB 110
1540 SR$="Maximale grootte van de elementen ?"
1550 GOSUB 150:HO=SB/2-7.5:VE=3:GOSUB 110
1560 PRINT"(aantal tekens)":HO=HO+6:VE=5
1570 GOSUB 110:PRINT">.<"
1580 GOSUB 200:IF (IN$<"1") OR (IN$>"9") THEN 1580
1590 EL=VAL(IN$):HO=HO+1:GOSUB 110:PRINT IN$
1600 REM 
1610 REM STARTGROOTTE MATRICES
1620 REM 
1630 HO=SB/2-9:VE=10:GOSUB 110:PRINT"Grootte matrices ?";
1640 VE=12:GOSUB 110:PRINT"aantal rijen    >.<";
1650 VE=14:GOSUB 110:PRINT"aantal kolommen >.<";:HO=HO+1
1660 VE=16:GOSUB 110:PRINT"[return] na keuze":VE=12
1670 HO=HO+16:GOSUB 110
1680 GOSUB 200:IF IN=13 THEN 1710
1690 IF ((IN$<"1") OR (IN$>"9")) THEN 1680
1700 GOSUB 110:PRINT IN$;:VE=26-VE:GOTO 1680
1710 VE=16:HO=HO-16:GOSUB 110:PRINT"                 "
1720 VE=12:HO=HO+16:GOSUB 220:VK=VAL(CHR$(IN))
1730 VE=14:GOSUB 220:HK=VAL(CHR$(IN))
1800 REM 
1810 REM INITIALISATIE
1820 REM 
1830 MR=INT(SH/2):MK=INT((SB-1)/(EL+1))
1840 IF HK>MK THEN EL=EL-1:GOTO 1830
1850 SR=EL:GOSUB 300:HO=SB/2-.5:VE=5:GOSUB 110:PRINT SR$;
1860 DIM MA(MR-1,MK*5-1),R(4),K(4):D=10
1870 DIM TE$(9),EM$(8):X=3:Y=1:MA=0:TE=0
1880 FOR I=0 TO 9:READ TE$(I):NEXT I:N=0
1890 FOR I=0 TO 8:READ EM$(I):NEXT I
1900 FOR I=0 TO 75:B$=B$+" ":NEXT I
1910 HO=SB/2-19.5:VE=SH-1
1920 SR$="   [_] om de matrix op te slaan   "
1930 GOSUB 110:GOSUB 150:GOSUB 110:SD=D:GOSUB 450
1940 SD=D:PRINT"   ";SR$;"   ";:IF IN<>0 THEN 2000
1950 GOSUB 450:IF IN<>0 THEN 2000
1960 D=D-1:IF (IN=0) AND (D>0) THEN 1920
2000 REM 
2010 REM SCHERMOPBOUW
2020 REM 
2030 GOSUB 100:VE=0:HO=2:GOSUB 110
2040 FOR SR=1 TO MK:GOSUB 300:GOSUB 120:HO=HO+EL:GOSUB 110
2050 PRINT SR$;:GOSUB 120:IF SR>=9 THEN HO=HO-1:GOSUB 110
2060 NEXT SR:VE=-1
2070 FOR SR=1 TO MR:HO=1:VE=VE+2:GOSUB 110:GOSUB 300
2080 IF SR>9 THEN HO=0:GOSUB 110
2090 PRINT SR$;:HO=2:GOSUB 110:IF ((SR>VK) OR (HK<2)) THEN 2110
2100 FOR I=1 TO HK-1:HO=HO+EL+1:GOSUB 110:PRINT",";:NEXT I
2110 HO=1:NEXT SR:TE=0:GOSUB 9000:GOTO 2500
2120 HO=INT(SB/2-11):VE=SH:SR$="toets voor vervolg"
2130 GOSUB 110:GOSUB 150:D=0
2140 GOSUB 200:IF IN=0 THEN 2140
2150 RETURN
2200 REM 
2210 REM KOMMA'S TOEVOEGEN
2220 REM 
2230 H=2+HK*(EL+1):HK=INT((X-2)/(EL+1))+1
2240 FOR VE=1 TO VK*2 STEP 2
2250 FOR HO=H TO 2+(HK-1)*(EL+1) STEP EL+1
2260 GOSUB 110:PRINT",";:NEXT HO:NEXT VE:RETURN
2300 REM 
2310 REM VERTIKAAL KOMMA'S TOEVOEGEN
2320 REM 
2330 FOR VE=1+VK*2 TO Y STEP 2
2340 FOR HO=3+EL TO 2+(HK-1)*(EL+1) STEP EL+1
2350 GOSUB 110:PRINT",";:NEXT HO:NEXT VE:VK=(Y+1)/2:RETURN
2500 REM 
2510 REM INVOER VIA TOETSENBORD
2520 REM 
2530 GOSUB 200
2540 IF IN=13 THEN X=3:IN=30
2550 IF IN=127 THEN GOSUB 110:PRINT" ";:IN=28
2560 IF IN$="/" THEN GOSUB 3600
2570 IF IN$="+" THEN GOSUB 4000
2580 IF IN$="=" THEN GOSUB 4200
2590 IF IN$="*" THEN GOSUB 4400
2600 IF IN$="^" THEN GOSUB 4600
2610 IF IN=83 THEN GOSUB 5000:REM S
2620 IF IN=73 THEN GOSUB 5500:REM I
2630 IF IN=87 THEN GOSUB 6000:REM W
2640 IF IN=84 THEN GOSUB 6200:REM T
2650 IF IN=79 THEN GOSUB 6400:REM O
2660 IF IN=80 THEN GOSUB 6500:REM P
2670 IF IN=69 THEN GOSUB 7500:IF KO=1 THEN 1000:REM E
2680 IF (IN$="_") AND (TE<2) THEN GOSUB 8000:GOSUB 9000
2690 IF IN=28 THEN X=X-1
2700 IF INT((X-2)/(EL+1))=(X-2)/(EL+1) THEN X=X-1
2710 IF X<3 THEN X=3
2720 IF IN=29 THEN X=X+1
2730 IF X>MK*(EL+1)+1 THEN X=X-1
2740 IF INT((X-2)/(EL+1))<>(X-2)/(EL+1) THEN 2760
2750 X=X+1
2760 IF IN=31 THEN Y=Y-2
2770 IF IN<>30 THEN 2790
2780 Y=Y+2
2790 IF Y>MR*2-1 THEN Y=Y-2:GOTO 2810
2800 IF Y<1 THEN Y=Y+2
2810 IF (IN>44) AND (IN<>47) AND (IN<58) THEN 2890
2820 IF IN=32 THEN 2890
2830 HO=X:VE=Y:GOSUB 220:GOSUB 110:H9=IN
2840 IF IN=32 THEN PRINT"?";:GOTO 2860
2850 PRINT" ";
2860 GOSUB 110:SD=3:GOSUB 450:PRINT CHR$(H9);
2870 IF IN=0 THEN 2500
2880 GOTO 2540
2890 HO=X:VE=Y:GOSUB 110
2900 IF (IN=45) OR (IN=46) THEN GOSUB 2980:GOTO 2920
2910 IF ((IN$<"0") OR (IN$>"9")) AND (IN$<>" ") THEN 2500
2920 PRINT IN$;:IF X>=MK*(EL+1)+1 THEN 2950
2930 X=X+1:IF INT((X-2)/(EL+1))<>(X-2)/(EL+1) THEN 2950
2940 X=X+1
2950 IF ((X-3)/(EL+1))>HK THEN GOSUB 2200
2960 IF (Y+1)/2>VK THEN GOSUB 2300
2970 GOTO 2500
2980 KO=1:H=3+INT((X-3)/(EL+1))*(EL+1)
2990 IF IN=45 THEN 3060
3000 FOR HO=H TO H+EL:VE=Y:GOSUB 220:IF IN=46 THEN KO=0
3010 NEXT HO:IF KO=1 THEN 3050
3020 IN$="":X=X-1
3030 IF INT((X-2)/(EL+1))=(X-2)/(EL+1) THEN X=X-1
3040 IF X<3 THEN X=3
3050 HO=X:VE=Y:GOSUB 110:RETURN
3060 IF H=X THEN 3050
3070 FOR HO=H TO X-1:VE=Y:GOSUB 220:IF IN<>32 THEN KO=0
3080 GOTO 3010
3500 REM 
3510 REM ELEMENT-GROOTTE CONTROLE
3520 REM 
3530 KO=1:ME$=SR$:SR=INT(SR):GOSUB 300
3540 IF LEN(SR$)>EL THEN EM=1:GOSUB 9500:KO=0:GOTO 3560
3550 SR$=LEFT$(ME$,EL):SR=VAL(SR$)
3560 RETURN
3600 REM 
3610 REM VOLGENDE MATRIX
3620 REM 
3630 GOSUB 3800:MA=1-MA
3640 GOSUB 3700:TE=MA:RE=MA:GOSUB 9000:X=3:Y=1:RETURN
3700 REM 
3710 REM PRINT MATRIX
3720 REM 
3730 IF R(MA)*K(MA)=0 THEN RETURN
3740 FOR R=1 TO R(MA):VE=R*2-1
3750 FOR K=1 TO K(MA):HO=K*(EL+1)+2-EL
3760 SR=MA(R-1,MK*MA+K-1):GOSUB 300:IF LEN(SR$)=EL THEN 3790
3770 GOSUB 3500:IF KO=0 THEN RETURN
3780 SR$=LEFT$(B$,EL-LEN(SR$))+SR$
3790 GOSUB 110:PRINT SR$;:NEXT K:NEXT R:RETURN
3800 REM 
3810 REM SCHERM LEGEN
3820 REM 
3830 FOR R=1 TO MR:VE=R*2-1
3840 FOR K=1 TO MK:HO=K*(EL+1)+2-EL
3850 GOSUB 110:PRINT LEFT$(B$,EL);:NEXT K:NEXT R:RETURN
3900 REM 
3910 REM EENHEIDSMATRIX
3920 REM 
3930 FOR R=1 TO R(MA)
3940 FOR K=1 TO K(MA)
3950 IF R=K THEN MA(R-1,MK*2+K-1)=1:GOTO 3970
3960 MA(R-1,MK*2+K-1)=0
3970 NEXT K:NEXT R:R(2)=R(MA):K(2)=R(MA):RETURN
4000 REM 
4010 REM MAT 1 + MAT 2 = MAT 3
4020 REM 
4030 IF (R(0)=0) OR (R(1)=0) THEN EM=8:GOSUB 9500:RETURN
4040 IF (R(0)=R(1)) AND (K(0)=K(1)) THEN 4060
4050 EM=2:GOSUB 9500:RETURN
4060 FOR R=1 TO R(0):FOR K=1 TO K(0)
4070 SR=MA(R-1,K-1)+MA(R-1,MK+K-1):GOSUB 300
4080 GOSUB 3500:IF KO=0 THEN K=K(0):R=R(0)
4090 MA(R-1,MK*2+K-1)=SR:NEXT K:NEXT R:IF KO=0 THEN RETURN
4100 GOSUB 3800:R(2)=R(0):K(2)=K(0):TE=2:GOSUB 9000
4110 Q=MA:MA=2:GOSUB 3700:RE=2:MA=Q:RETURN
4200 REM 
4210 REM MAT 1 - MAT 2 = MAT 3
4220 REM 
4230 IF (R(0)=0) OR (R(1)=0) THEN EM=8:GOSUB 9500:RETURN
4240 IF (R(0)=R(1)) AND (K(0)=K(1)) THEN 4260
4250 EM=2:GOSUB 9500:RETURN
4260 FOR R=1 TO R(0):FOR K=1 TO K(0)
4270 SR=MA(R-1,K-1)-MA(R-1,MK+K-1):GOSUB 300
4280 GOSUB 3500:IF KO=0 THEN K=K(0):R=R(0)
4290 MA(R-1,MK*2+K-1)=SR:NEXT K:NEXT R:IF KO=0 THEN RETURN
4300 GOSUB 3800:R(2)=R(0):K(2)=K(0):TE=3:GOSUB 9000
4310 Q=MA:MA=2:GOSUB 3700:RE=2:MA=Q:RETURN
4400 REM 
4410 REM MAT 1 * MAT 2 = MAT 3
4420 REM 
4430 IF (R(0)=0) OR (R(1)=0) THEN EM=8:GOSUB 9500:RETURN
4440 IF R(1)<>K(0) THEN EM=3:GOSUB 9500:RETURN
4450 FOR R=1 TO R(0):FOR K=1 TO K(1)
4460 SR=0:FOR S=1 TO K(0)
4470 SR=SR+MA(R-1,S-1)*MA(S-1,MK+K-1):GOSUB 300
4480 GOSUB 3500:IF KO=0 THEN S=K(0):K=K(1):R=R(0):GOTO 4500
4490 MA(R-1,MK*2+K-1)=SR
4500 NEXT S:NEXT K:NEXT R:IF KO=0 THEN RETURN
4510 R(2)=R(0):K(2)=K(1)
4520 GOSUB 3800:TE=4:GOSUB 9000:Q=MA:MA=2:GOSUB 3700:RE=2
4530 MA=Q:RETURN
4600 REM 
4610 REM MATRIX 1,2 TOT DE N-DE MACHT
4620 REM 
4630 SO=0:IF R(MA)=0 THEN EM=8:GOSUB 9500:RETURN
4640 IF R(MA)<>K(MA) THEN EM=4:GOSUB 9500:RETURN
4650 HO=0:VE=SH:GOSUB 110
4660 PRINT"welke macht ? >  < (+[return])         ";
4670 HO=15:GOSUB 110:PRINT"..";
4680 GOSUB 200:IF IN=13 THEN 4710
4690 IF ((IN$<"0") OR (IN$>"9")) THEN 4680
4700 GOSUB 110:PRINT IN$;:HO=31-HO:GOTO 4680
4710 HO=15:GOSUB 220:GE$=CHR$(IN):HO=16:GOSUB 220
4720 GE$=GE$+CHR$(IN):N=VAL(GE$):IF N>19 THEN 4670
4730 Q=MA:GOSUB 3900:IF N=0 THEN MA=2
4740 FOR R=1 TO R(MA):FOR K=1 TO K(MA)
4750 MA(R-1,MK*3+K-1)=MA(R-1,MK*MA+K-1):IF SO=0 THEN 4780
4760 MA(R-1,MK*4+K-1)=MA(R-1,MK*3+K-1):IF N=0 THEN 4780
4770 MA(R-1,MK*4+K-1)=MA(R-1,MK*4+K-1)+MA(R-1,MK*2+K-1)
4780 NEXT K:NEXT R:MA=Q:IF (N=0) OR (N=1) THEN 4840
4790 FOR M=2 TO N
4800 FOR R=1 TO R(MA):FOR K=1 TO K(MA)
4810 MA(R-1,MK*2+K-1)=MA(R-1,MK*3+K-1)
4820 NEXT K:NEXT R:GOSUB 8500:IF KO=0 THEN M=N
4830 NEXT M:IF KO=0 THEN RETURN
4840 GOSUB 3800:R(3)=R(MA):K(3)=K(MA):TE=5:IF SO=1 THEN TE=6
4850 GOSUB 9000:IF SO=0 THEN MA=3:GOTO 4870
4860 R(4)=R(MA):K(4)=K(MA):MA=4
4870 GOSUB 3700:MA=Q:RE=3:IF SO=1 THEN RE=4
4880 RETURN
5000 REM 
5010 REM OPLOSSING MATRIX 1,2 = MAT 4
5020 REM 
5030 SO=1:IF R(MA)=0 THEN EM=8:GOSUB 9500:RETURN
5040 HO=0:VE=SH:IF R(MA)<>K(MA) THEN EM=4:GOSUB 9500:RETURN
5050 GOSUB 110:PRINT"[O] oplossing of [S] stappen ? >.<";
5060 GOSUB 200:IF (IN<>79) AND (IN<>83) THEN 5060
5070 HO=32:GOSUB 110:PRINT IN$;:IF IN=83 THEN 4650
5080 R(3)=R(MA):K(3)=K(MA):R(4)=R(MA):K(4)=K(MA)
5090 N=1:GOSUB 3900:FOR R=1 TO R(MA):FOR K=1 TO K(MA)
5100 MA(R-1,MK*3+K-1)=MA(R-1,MK*MA+K-1)
5110 MA(R-1,MK*4+K-1)=MA(R-1,MK*2+K-1)+MA(R-1,MK*3+K-1)
5120 MA(R-1,MK*2+K-1)=MA(R-1,MK*3+K-1):NEXT K:NEXT R
5130 FOR R=1 TO R(4):FOR K=1 TO K(4)
5140 IF MA(R-1,MK*4+K-1)=0 THEN KO=0:R=R(4):K=K(4)
5150 NEXT K:NEXT R:IF KO=1 THEN 5220
5160 NT=0:FOR R=1 TO R(3):FOR K=1 TO R(3):IF R=K THEN 5180
5170 IF MA(R-1,MK*3+K-1)=0 THEN NT=NT+1
5180 NEXT K:NEXT R
5190 IF NT=R(3)*(K(3)-1) THEN EM=5:GOSUB 9500:RETURN
5200 N=N+1:GOSUB 8500:IF KO=0 THEN RETURN
5210 FOR R=1 TO R(MA):FOR K=1 TO K(MA):GOTO 5120
5220 Q=MA:TE=7:GOSUB 9000:GOSUB 3800
5230 MA=4:GOSUB 3700:RE=4:MA=Q:RETURN
5500 REM 
5510 REM INVERSE MATRIX 1,2 = MAT 4
5520 REM 
5530 IF R(MA)=0 THEN EM=8:GOSUB 9500:RETURN
5540 IF (R(MA)<>K(MA)) THEN EM=4:GOSUB 9500:RETURN
5550 GOSUB 3900:K0=K(MA)
5560 FOR R=1 TO K0:FOR K=1 TO K0
5570 MA(R-1,MK*3+K-1)=MA(R-1,MK*MA+K-1)
5580 NEXT K:NEXT R:R(3)=K0:K(3)=K0:Q=MA
5590 FOR K=1 TO K0:M1=K:M=ABS(MA(K-1,MK*3+K-1))
5600 IF K=K0 THEN 5640
5610 FOR I=K+1 TO K0:IF ABS(MA(I-1,MK*3+K-1))<=M THEN 5630
5620 M=ABS(MA(I-1,MK*3+K-1)):M1=I
5630 NEXT I
5640 IF M=0 THEN EM=6:MA=Q:GOSUB 9500:RETURN
5650 IF M1=K THEN 5700
5660 MA=3:FOR J0=K TO K0*2:J=J0:IF J>K0 THEN J=J-K0:MA=2
5670 W=MA(K-1,MK*MA+J-1)
5680 MA(K-1,MK*MA+J-1)=MA(M1-1,MK*MA+J-1)
5690 MA(M1-1,MK*MA+J-1)=W:NEXT J0
5700 D1=MA(K-1,MK*3+K-1)
5710 MA=3:FOR J0=K+1 TO K0*2:J=J0:IF J>K0 THEN J=J-K0:MA=2
5720 MA(K-1,MK*MA+J-1)=MA(K-1,MK*MA+J-1)/D1:NEXT J0
5730 FOR I=1 TO K0:IF I=K THEN 5780
5740 D2=MA(I-1,MK*3+K-1)
5750 MA=3:FOR J0=K+1 TO K0*2:J=J0:IF J>K0 THEN J=J-K0:MA=2
5760 W=MA(I-1,MK*MA+J-1):W=W-D2*MA(K-1,MK*MA+J-1)
5770 MA(I-1,MK*MA+J-1)=W:NEXT J0
5780 NEXT I:NEXT K:GOSUB 3800:GOSUB 3700:MA=Q:TE=8:GOSUB 9000
5790 RE=2:RETURN
6000 REM 
6010 REM MATRIX WISSEN
6020 REM 
6030 IF R(MA)=0 THEN EM=8:GOSUB 9500:RETURN
6040 FOR R=1 TO R(MA):FOR K=1 TO K(MA)
6050 MA(R-1,MA*MK+K-1)=0:NEXT K:NEXT R
6060 GOSUB 3800:GOSUB 3700:RETURN
6200 REM 
6210 REM TRANSPONEREN MAT 1,2 = MAT 3
6220 REM 
6230 IF R(MA)=0 THEN EM=8:GOSUB 9500:RETURN
6240 IF (R(MA)>MK) OR (K(MA)>MR) THEN EM=7:GOSUB 9500:RETURN
6250 FOR R=1 TO R(MA):FOR K=1 TO K(MA)
6260 MA(K-1,MK*2+R-1)=MA(R-1,MK*MA+K-1)
6270 NEXT K:NEXT R:R(2)=K(MA):K(2)=R(MA):RE=2
6280 Q=MA:MA=2:GOSUB 3800:GOSUB 3700:MA=Q:TE=9:GOSUB 9000
6290 IF ((HK-1=VK) OR ((VK=MR) AND (HK=MK))) THEN RETURN
6300 REM 
6310 REM KOMMA CORRECTIE
6320 REM 
6330 MX=VK:IF (HK-1)>MX THEN MX=HK-1
6340 FOR VE=1 TO MX*2 STEP 2:FOR HO=3+EL TO 2+MX*(EL+1) STEP EL+1
6350 GOSUB 110:PRINT",";:NEXT HO:NEXT VE:HK=MX+1:VK=MX:RETURN
6400 REM 
6410 REM RESULTAAT OVERZETTEN
6420 REM 
6430 HO=0:VE=SH:GOSUB 110:PRINT"naar matrix [1] of [2] >.<";
6440 PRINT LEFT$(B$,11);:HO=24:VE=SH:GOSUB 110
6450 GOSUB 200:IF (IN$<"1") OR (IN$>"2") THEN 6450
6460 PRINT IN$;:MA=VAL(IN$)-1:FOR R=1 TO R(RE):FOR K=1 TO K(RE)
6470 MA(R-1,MK*MA+K-1)=MA(R-1,MK*RE+K-1):NEXT K:NEXT R
6480 R(MA)=R(RE):K(MA)=K(RE):TE=MA
6490 GOSUB 9000:RETURN
6500 REM 
6510 REM SCHERMAFDRUK OP DE PRINTER
6520 REM 
6530 HO=0:VE=SH:GOSUB 110
6540 PRINT"[h] hele scherm. [m] alleen matrix.    ";
6550 GOSUB 200:IF IN=77 THEN 6630
6560 IF IN<>72 THEN 6550
6570 GOSUB 7000:GOSUB 9000
6580 FOR H=0 TO SH
6590 VE=H:SR$=TA$
6600 FOR B=0 TO SB:HO=B:GOSUB 220:SR$=SR$+CHR$(IN):NEXT B
6610 GOSUB 350:GOSUB 360:NEXT H
6620 RETURN
6630 GOSUB 7000:GOSUB 9000:FOR H=0 TO 2*R(MA)-1
6640 VE=H:SR$=TA$:FOR B=0 TO 2+(EL+1)*K(MA):HO=B:GOSUB 220
6650 SR$=SR$+CHR$(IN):NEXT B:GOSUB 350:GOSUB 360:NEXT H
6660 RETURN
7000 REM 
7010 REM TABULATOR
7020 REM 
7030 HO=0:VE=SH:GOSUB 110
7040 PRINT"tabulator (0...75) ? >  <          ";
7050 HO=22:GOSUB 110:PRINT"..";
7060 GOSUB 200:IF IN=13 THEN 7090
7070 IF (IN$<"0") OR (IN$>"9") THEN 7060
7080 GOSUB 110:PRINT IN$;:HO=45-HO:GOTO 7060
7090 HO=22:GOSUB 220:GE$=CHR$(IN):HO=23:GOSUB 220
7100 GE$=GE$+CHR$(IN):TA=VAL(GE$):IF TA>75 THEN 7050
7110 TA$=LEFT$(B$,TA):RETURN
7500 REM 
7510 REM EINDE
7520 REM 
7530 HO=0:VE=SH:GOSUB 110:PRINT LEFT$(B$,SB);
7540 HO=SB/2-8:VE=SH:GOSUB 110
7550 PRINT"stoppen [j]/[n]";
7560 GOSUB 200:IF IN=74 THEN 950
7570 IF IN<>78 THEN 7560
7580 HO=SB/2-12:GOSUB 110:PRINT"opnieuw beginnen [j]/[n]";
7590 GOSUB 200:IF IN=74 THEN KO=1:RETURN
7600 IF IN<>78 THEN 7590
7610 KO=0:GOSUB 9000:RETURN
8000 REM 
8010 REM INVOERCONTROLE + OMZETTING
8020 REM 
8030 HO=5:VE=SH:GOSUB 110:PRINT" de matrix wordt opgeslagen";
8040 R=0:VE=-1
8050 HO=2:VE=VE+2:R=R+1:K=0:IF R>MR THEN IN=32:K=1:GOTO 8120
8060 HO=HO+EL:K=K+1:GE$=""
8070 IF K>MK THEN K=MK+1:GOTO 8110
8080 GOSUB 220
8090 H=HO:FOR HO=H+1-EL TO H:GOSUB 220:GE$=GE$+CHR$(IN)
8100 NEXT HO:IF GE$<>LEFT$(B$,LEN(GE$)) THEN 8150
8110 IF R=1 THEN K(MA)=K-1:GOTO 8050
8120 IF K=1 THEN 8160
8130 IF K-1=K(MA) THEN 8050
8140 EM=0:GOSUB 9500:KO=0:RETURN
8150 MA(R-1,MK*MA+K-1)=VAL(GE$):GOTO 8060
8160 R(MA)=R-1:KO=1:RE=MA:GOSUB 3800:GOSUB 3700:RETURN
8500 REM 
8510 REM MAT 1,2 * MAT 3 = MAT 4
8520 REM 
8530 FOR R=1 TO R(MA):FOR K=1 TO K(MA)
8540 SR=0:FOR S=1 TO K(MA)
8550 SR=SR+MA(R-1,MK*MA+S-1)*MA(S-1,MK*2+K-1):GOSUB 300
8560 GOSUB 3500:IF KO=0 THEN S=K(MA):K=K(MA):R=R(MA):GOTO 8590
8570 NEXT S:MA(R-1,MK*3+K-1)=SR
8580 IF SO=1 THEN MA(R-1,MK*4+K-1)=MA(R-1,MK*4+K-1)+SR
8590 NEXT K:NEXT R
8600 RETURN
9000 REM 
9010 REM PRINT SCHERMTEKST
9020 REM 
9030 HO=0:VE=SH:GOSUB 110:FOR I=1 TO SB:PRINT" ";:NEXT I
9040 IF TE<5 THEN 9140
9050 SR=MA+1:GOSUB 300
9060 L$=LEFT$(TE$(5),7)+SR$+MID$(TE$(5),9,8)
9070 SR=N:GOSUB 300:R$=SR$+RIGHT$(TE$(5),9)
9080 TE$(5)=L$+R$:SR=MA+1:GOSUB 300
9090 TE$(7)=LEFT$(TE$(7),17)+SR$+MID$(TE$(7),19,12):SR=N
9100 GOSUB 300:TE$(7)=TE$(7)+SR$
9110 TE$(6)=SR$+LEFT$(RIGHT$(TE$(6),26),25):SR=MA+1:GOSUB 300
9120 TE$(6)=TE$(6)+SR$:TE$(8)=LEFT$(TE$(8),19)+SR$
9130 TE$(9)=LEFT$(TE$(9),7)+SR$+RIGHT$(TE$(9),15)
9140 HO=((SB+1)-LEN(TE$(TE)))/2:VE=SH
9150 GOSUB 110:PRINT TE$(TE);:IN$="":IN=0:RETURN
9500 REM 
9510 REM PRINT FOUTMELDING
9520 REM 
9530 HO=0:VE=SH:GOSUB 110:FOR I=1 TO SB:PRINT" ";:NEXT I
9540 HO=((SB+1)-LEN(EM$(EM)))/2:VE=SH
9550 GOSUB 110:PRINT EM$(EM);:GOSUB 250
9560 SD=15:GOSUB 450
9570 GOSUB 9000:RETURN
25000 DATA "M  A  T  R  I  X  1"
25010 DATA "M  A  T  R  I  X  2"
25020 DATA "MATRIX 1 + MATRIX 2"
25030 DATA "MATRIX 1 - MATRIX 2"
25040 DATA "MATRIX 1 * MATRIX 2"
25050 DATA "MATRIX   tot de -de macht"
25060 DATA "-staps matrix van MATRIX  "
25070 DATA "oplossing MATRIX  , diameter= "
25080 DATA "inverse van MATRIX "
25090 DATA "MATRIX  getransponeerd"
25100 DATA "**  matrix niet compleet  **"
25110 DATA "**  element te groot  **"
25120 DATA "**  ongelijke matrix-grootte  **"
25130 DATA "**  vermenigvuldiging onmogelijk  **"
25140 DATA "**  ongelijk aantal rijen, kolommen  **"
25150 DATA "**  onoplosbare matrix  **"
25160 DATA "**  geen inverse mogelijk  **"
25170 DATA "**  matrix te groot  **"
25180 DATA "**  matrix nog niet opgeslagen  **"
30000 REM """"""""""""""""""""""
30010 REM "                    "
30020 REM " MATRIX MANIPULATIE "
30030 REM "                    "
30040 REM "   geprogrammeerd   "
30050 REM "                    "
30060 REM " op de Commodore 64 "
30070 REM "                    "
32000 REM """"""""""""""""""""""
32010 REM "                    "
32020 REM " door:    Jan Stout "
32030 REM "                    "
32040 REM "     Pomperschans 9 "
32050 REM "                    "
32060 REM " 5595 AS  LEENDE NB "
32070 REM "                    "
32080 REM """"""""""""""""""""""
32100 REM TROS-RADIO dd 870225
