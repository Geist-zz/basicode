1000 A=1000:GOTO 20:REM ENTFERNUNG - TROS/DS-KULTUR
1010 DIM T$(1)
1020 BF=52.3833:LF=-5.4166:REM SUEDL. FLEVOLAND
1030 BO=52.8:LO=-13.4:REM ORANIENBURG
1040 R=6378:REM AEQU. ERDRADIUS
1050 PJ=3.14159:RA=180/PJ:E=2*R*PJ/360
1060 U1$="E r l a e u t e r u n g:"
1070 U2$="B e r e c h n u n g:"
1080 F$="F a l s c h e  E i n g a b e !"
1090 L$="                                  "
1100 REM
1110 REM --- SCHIRMGROESSE
1120 REM
1130 HO=5:VE=5:GOSUB 110
1140 PRINT"B i t t e   w a r t e n !"
1150 HO=0:VE=0:GOSUB 110
1160 SP=0
1170 SP=SP+1:PRINT" ";:GOSUB 120:IF HO<>0 THEN 1170
1180 ZE=0
1190 ZE=ZE+1:PRINT" ":GOSUB 120:IF VE<>ZE THEN 1190
1200 H=SP-1:V=ZE-1
1210 REM
1220 REM --- TITEL
1230 REM
1240 T$(0)="  E m p f a n g s -  "
1250 T$(1)=" e n t f e r n u n g "
1260 GOSUB 100
1270 FOR VE=0 TO 1
1280 L=LEN(T$(VE)):HO=INT((H-L)/2):GOSUB 110
1290 SR$=T$(VE):GOSUB 150
1300 NEXT VE
1310 REM
1320 REM --- MENU
1330 REM
1340 HO=2:VE=5:GOSUB 110
1350 SR$="E":GOSUB 150:PRINT"- Erlaeuterung"
1360 HO=2:VE=7:GOSUB 110
1370 SR$="B":GOSUB 150:PRINT"- Berechnung"
1380 HO=2:VE=9:GOSUB 110
1390 SR$="X":GOSUB 150:PRINT"- Ende"
1400 HO=24:VE=9:GOSUB 110
1410 GOSUB 210
1420 IF (IN<>69) AND (IN<>66) AND (IN<>88) THEN 1410
1430 IF IN=69 THEN M=1
1440 IF IN=66 THEN M=2
1450 IF IN=88 THEN 950
1460 ON M GOSUB 1500,1730:GOTO 1240
1470 REM
1480 REM --- ERLAEUTERUNG
1490 REM
1500 GOSUB 100:RESTORE
1510 L=LEN(U1$):HO=INT((H-L)/2):VE=0:GOSUB 110
1520 SR$=U1$:GOSUB 150
1530 HO=0:VE=1:GOSUB 110
1540 READ R$:IF R$<>"*" THEN 1530
1550 PR$=""
1560 READ R$:IF R$="*" THEN GOSUB 1600:GOTO 1550
1570 IF R$="xxx" THEN GOSUB 1600:GOSUB 2490:RETURN
1580 PR$=PR$+R$:GOTO 1560
1590 REM
1600 H0=0:H1=1:PRINT
1610 FOR I=1 TO LEN(PR$):H0=H0+1
1620 IF MID$(PR$,I,1)<>" " THEN 1640
1630 GOSUB 1650
1640 NEXT I:GOSUB 1650:PRINT:RETURN
1650 IF H0>SP-1 THEN PRINT:H0=I-H1
1660 GOSUB 120:IF VE<ZE-3 THEN 1690
1670 HO=0:VE=ZE-1:GOSUB 110
1680 GOSUB 2490
1690 PRINT MID$(PR$,H1,I-H1);" ";:H1=I+1:RETURN
1700 REM
1710 REM --- BERECHNUNG
1720 REM
1730 GOSUB 100
1740 REM
1750 BG=0:BM=0:B0=0:LG=0:LM=0:L0=0
1760 BX=0:LX=0:LZ=0:E1=0:E2=0:EX=0
1770 REM
1780 L=LEN(U2$):HO=INT((H-L)/2):VE=0:GOSUB 110
1790 SR$=U2$:GOSUB 150
1800 REM
1810 HO=0:VE=2:GOSUB 110
1820 PRINT"Koordinaten des Empfangsortes:"
1830 HO=0:VE=4:GOSUB 110
1840 SR$="    Negatives Vorzeichen bei     ":GOSUB 150
1850 HO=0:VE=5:GOSUB 110
1860 SR$="suedl. Breite und oestl. Laenge !":GOSUB 150
1870 HO=0:VE=7:GOSUB 110
1880 INPUT"Ort :";N$
1890 HO=0:VE=9:GOSUB 110:FL=0
1900 INPUT"Geogr. Breite - Grad ";BG
1910 INPUT"              - Min. ";BM:PRINT
1920 INPUT"Geogr. Laenge - Grad ";LG
1930 INPUT"              - Min. ";LM:PRINT
1940 IF (ABS(BG)>89) OR (BG<>INT(BG)) THEN FL=1:BG=0
1950 IF (ABS(BM)>59) OR (BM<>INT(BM)) THEN FL=1:BM=0
1960 IF (ABS(LG)>179) OR (LG<>INT(LG)) THEN FL=1:LG=0
1970 IF (ABS(LM)>59) OR (LM<>INT(LM)) THEN FL=1:LM=0
1980 IF FL=1 THEN GOSUB 2520:GOSUB 2560:GOTO 1890
1990 HO=4:VE=16:GOSUB 110:PRINT"O.K. ?    -> J/N ? ";
2000 GOSUB 210:IF IN<>74 THEN GOSUB 2560:GOTO 1890
2010 REM
2020 REM --- BOGENMASS
2030 B0=(BG+BM/60)/RA:L0=(LG+LM/60)/RA
2040 B1=BF/RA:L1=LF/RA
2050 B2=BO/RA:L2=LO/RA
2060 REM
2070 REM --- BERECHNUNG
2080 BX=B1:LX=L1:EX=0:GOSUB 2240:E1=EX
2090 REM
2100 BX=B2:LX=L2:EX=0:GOSUB 2240:E2=EX
2110 REM
2120 HO=0:VE=15:GOSUB 110:CT=5:CN=0
2130 SR=E1:GOSUB 310
2140 PRINT"Entfernung - TROS/N.O.S"
2150 PRINT"(1008 kHz, 52:23 NB 5:25 OL): ";SR$;" km"
2160 PRINT
2170 SR=E2:GOSUB 310
2180 PRINT"Entfernung - DS/Kultur"
2190 PRINT"(177 kHz, 52:48 NB 13:24 OL): ";SR$;" km"
2200 REM
2210 PRINT:GOSUB 2490:RETURN
2220 REM
2230 REM --- UNTERPROGRAMM
2240 LZ=L0-LX:IF LZ=0 THEN 2430
2250 IF LZ>PJ THEN LZ=LZ-2*PJ
2260 IF LZ<-PJ THEN LZ=LZ+2*PJ
2270 BB=COS(LZ)*(COS(BX)/SIN(BX))
2280 BB=ATN(BB)
2290 BZ=((COS(LZ)/SIN(LZ))*COS(B0+BB))/SIN(BB)
2300 BZ=ATN(1/BZ)
2310 BZ=BZ*RA:LZ=LZ*RA
2320 IF (LZ>0) AND (BZ<0) THEN BZ=BZ+180
2330 IF (LZ<0) AND (BZ>0) THEN BZ=BZ+180
2340 IF (LZ<0) AND (BZ<0) THEN BZ=BZ+360
2350 BZ=INT(BZ+.5)
2360 EX=(SIN(B0)*SIN(BX))+(COS(B0)*COS(BX)*COS(LZ/RA))
2370 EX=SQR(1-(EX*EX))/EX
2380 IF L0=LX THEN 2450
2390 EX=ATN(EX)
2400 EX=EX*RA:IF (EX<0) AND (EX>-90) THEN EX=EX+180
2410 EX=EX*E:EX=INT(EX+.5)
2420 RETURN
2430 IF B0>BX THEN BZ=180:GOTO 2350
2440 IF B0<BX THEN BZ=0:GOTO 2350
2450 IF B0>BX THEN EX=B0-BX:GOTO 2400
2460 IF B0<BX THEN EX=BX-B0:GOTO 2400
2470 RETURN
2480 REM -----------------------------
2490 SR$="Taste =>"
2500 PRINT:GOSUB 150:GOSUB 210:GOSUB 100:RETURN
2510 REM
2520 HO=0:VE=16:GOSUB 110
2530 SR$="F e h l e i n g a b e !":GOSUB 150
2540 GOSUB 210:RETURN
2550 REM
2560 FOR VE=9 TO 13
2570 HO=22:GOSUB 110
2580 PRINT"             "
2590 NEXT VE
2600 HO=0:VE=16:GOSUB 110:PRINTL$
2610 RETURN
2620 REM
25000 DATA "*","BASICODE-Programme werden z.Zt. in "
25010 DATA "Rundfunkprogrammen folgender Anstalten "
25020 DATA "ausgestrahlt:","*"
25030 DATA "N.O.S.    (NL) - 1008 kHz (MW),","*"
25040 DATA "TROS      (NL) - 1008 kHz (MW),","*"
25050 DATA "DS/Kultur (D)  -  177 kHz (LW),","*"
25060 DATA "daneben natuerlich auch ueber die Sender des "
25070 DATA "UKW/FM - Netzes.","*"
25080 DATA "Mit diesem Programm kann die Entfernung des "
25090 DATA "Empfangsortes von den Standorten der LW- bzw. "
25100 DATA "MW-Sender festgestellt werden.","*"
25110 DATA "Einzugeben sind die geographischen Koordinaten "
25120 DATA "des Empfangsortes, die einer Karte oder einem "
25130 DATA "Tafelwerk (Logarithmentafel, astronom. Tafeln "
25140 DATA "oder dergl.) entnommen werden koennen.","*"
25150 DATA "Ein Hobby-Astronom ist vielleicht sogar in der "
25160 DATA "Lage, die Koordinaten seines Wohnortes zu "
25170 DATA "berechnen !!","*"
25180 DATA "Die Koordinaten sind in der Form","*"
25190 DATA "  Grad : Minuten","*"
25200 DATA "einzugeben; fuer eine suedliche Breite bzw. "
25210 DATA "oestliche Laenge sind negative Werte"
25220 DATA " (fuer Grad u. Minuten) "
25230 DATA "einzugeben. Die Zahlenwerte sind auf 89 bzw. "
25240 DATA "179 fuer Grad und auf 59 fuer Minuten begrenzt; "
25250 DATA "es sind nur ganzzahlige Werte zugelassen. ","*"
25260 DATA "Das Ergebnis ist nur eine Naeherung !"
25270 DATA "xxx"
25280 REM
32000 REM ---------------------
32010 REM FRIEDRICH DORMEIER
32020 REM BISMARCKSTR. 11A
32030 REM D-1000 BERLIN 39
32040 REM (030) 803 31 11
32050 REM
32060 REM C-128 - 2/1991
32070 REM ---------------------
32080 REM Erstausstrahlung: Deutschlandsender Kultur
32090 REM -spezial 910320
