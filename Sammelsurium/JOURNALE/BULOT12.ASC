1000 A=3000:GOTO 20:REM BASICODE-3 COMPUTER BULLETIN/B2
1010 HM=HO:HT=HO:VT=VE:RV$="":DIM RE$(VT)
1020 GOSUB 1520:REM initialisatie
1030 GOSUB 500
1040 GOSUB 540:IF LEFT$(IN$,1)<>"." THEN GOSUB 1340:GOTO 1040
1050 IF IN$<>".'" THEN 1070
1060 GOSUB 540:IN$=CHR$(34)+IN$:GOSUB 1350:GOTO 1040
1070 IF IN$<>".''" THEN 1090
1080 GOSUB 540:IN$=CHR$(34)+CHR$(34)+IN$:GOSUB 1350:GOTO 1040
1090 IF IN$<>".C" THEN 1130
1100 IF RV$<>LM$ THEN SR$=RV$:GOSUB 1370
1110 GOSUB 540:SR$=LEFT$(SP$,(HT-LEN(IN$))/2)+IN$
1120 GOSUB 1370:RV$=LM$:GOTO 1040
1130 IF IN$<>".P" THEN 1180
1140 IF RV$<>LM$ THEN SR$=RV$:GOSUB 1370:RV$=LM$
1150 SR$="":GOSUB 1370:IF SC=2 THEN GOSUB 1370:GOTO 1170
1160 IF AL<>2 THEN 1140
1170 GOTO 1040
1180 IF IN$=".E" THEN GOSUB 580:GOTO 950
1190 IF IN$=".T" THEN GOSUB 540:TT$=IN$:GOTO 1040
1200 IF (IN$<>".R") OR (SC=2) THEN 1250
1210 GOSUB 540:RP$=IN$
1220 IF LEN(RV$)+8+LEN(RP$)>HT THEN SR$=RV$:GOSUB 1370:RV$=LM$
1230 PRINT RV$;:RE$(AL)=RV$+" "+RP$+" ":SR$=RP$
1240 GOSUB 150:HT=HT-LEN(RV$)-LEN(RP$)-7:RV$="":GOTO 1040
1250 CO=VAL(MID$(IN$,3,LEN(IN$)-2)):IN$=LEFT$(IN$,2)
1260 IF IN$<>".F" THEN 1300
1270 IF RV$<>"" THEN SR$=RV$:GOSUB 1370:RV$=LM$:CO=CO-1
1280 CO=CO-1:IF CO>-1 THEN SR$="":GOSUB 1370:GOTO 1280
1290 GOTO 1040
1300 IF IN$<>".M" THEN 1040
1310 LM$="":IF CO+PS>0 THEN LM$=LEFT$(SP$,CO+PS)
1320 GOTO 1040
1330 REM subroutine verwerk IN$
1340 IF RV$<>LM$ THEN RV$=RV$+" "
1350 IF LEN(RV$)+LEN(IN$)<HT THEN RV$=RV$+IN$:RETURN
1360 SR$=RV$:GOSUB 1370:RV$=LM$+IN$:RETURN
1370 HT=HM:IF SC=2 THEN GOSUB 350:GOSUB 360:GOTO 1390
1380 RE$(AL)=RE$(AL)+SR$:PRINT SR$:RE$(AL+1)=""
1390 AL=AL+1:IF AL>VT-SL THEN GOSUB 1420:REM paper to new page
1400 RETURN
1410 REM melding onder,wacht, ev screendump
1420 IF SC=2 THEN FOR I=1 TO SL:GOSUB 360:NEXT I:AL=1:RETURN
1430 HO=3:VE=VT:GOSUB 110
1440 SR$="VERVOLG: druk op <return>":GOSUB 150
1450 H$=IN$:GOSUB 210:IN$=H$:IF IN=13 THEN 1480
1460 IF IN<>80 THEN 1450
1470 FOR AL=1 TO VT:SR$=RE$(AL):GOSUB 350:GOSUB 360:NEXT AL
1480 GOSUB 100:AL=2:RE$(2)="":SR$=TT$
1490 PRINT LEFT$(SP$,(HT-LEN(SR$))/2-3);:GOSUB 150
1500 PRINT :PRINT :RETURN
1510 REM *** INITIALISATIE ***
1520 AL=1:PS=0:LM$="":TT$="BASICODE-3 COMPUTERBULLETIN"
1530 DIM T$(100)
1540 SP$="             ":SP$=SP$+SP$+SP$
1550 SL=2:GOSUB 1480:PRINT :PRINT :PRINT 
1560 PRINT "Het bulletin wordt gelezen vanaf"
1570 PRINT "een BASICODE-3 bestand op"
1580 PRINT "ofwel cassette, ofwel diskette."
1590 PRINT :PRINT "Wilt u het bulletin":PRINT 
1600 PRINT "   1  Van cassette naar diskette,"
1610 PRINT "   2  Van diskette naar cassette,"
1620 PRINT "   3  Van diskette naar scherm,"
1630 PRINT "   4  Van diskette naar printer,"
1640 PRINT "   5  Van cassette naar scherm,"
1650 PRINT "   6  Van cassette naar printer."
1660 PRINT :PRINT "Welk nummer kiest u ";:GOSUB 210
1670 SC=IN-48:PRINT SC
1680 IF (SC<1) OR (SC>6) THEN GOSUB 250:GOTO 1000
1690 ON SC GOTO 1700,1710,1720,1730,1740,1750
1700 NL=0:NS=5:GOTO 1860
1710 NL=4:NS=1:GOTO 1860
1720 NF=4:SC=1:GOTO 1850
1730 NF=4:SC=2:GOTO 1760
1740 NF=0:SC=1:GOTO 1850
1750 NF=0:SC=2
1760 PRINT :PRINT "Hoeveel spaties wilt u aan het"
1770 PRINT "begin van elke regel ";:INPUT PS:LM$=LEFT$(SP$,PS)
1780 PRINT :PRINT "Hoeveel tekens echte tekst wilt"
1790 PRINT "u op elke regel ";:INPUT HT:HT=HT+PS:HM=HT
1800 PRINT :PRINT "Hoeveel regels wilt u bij de scheurlijn"
1810 PRINT "laten overslaan ";:INPUT SL:RV$=LM$
1820 PRINT :PRINT "Hoeveel echte tekstregels wilt u op"
1830 PRINT "elk blad ";:INPUT VT:VT=VT+SL:GOSUB 360
1840 NF$="B12TXT":RETURN
1850 GOSUB 1480:GOTO 1840
1860 GOSUB 100
1870 PRINT "Ik lees nu het bestand van ";:NF=NL:GOSUB 2030
1880 PRINT "en schrijf het naar ";:NF=NS:GOSUB 2030
1890 HO=0:VE=7:GOSUB 110:PRINT "woord nummer ";:GOSUB 120
1900 NR=1
1910 I=0
1920 GOSUB 110:PRINT NR;
1930 NF=NL:GOSUB 540:IF IN=-1 THEN GOSUB 2060
1940 T$(I)=IN$:I=I+1:NR=NR+1:IF (I<101) AND (IN<>1) THEN 1920
1950 EO=IN
1960 NF=NS:FOR J=0 TO I-1:SR$=T$(J):GOSUB 560
1970 IF IN=-1 THEN GOSUB 2060
1980 NEXT J:IF EO<>1 THEN 1910
1990 NF=NL:GOSUB 580:NF=NS:GOSUB 580
2000 PRINT :PRINT "Dat is gebeurd, druk op RETURN";
2010 GOSUB 210:IF IN<>13 THEN 2010
2020 GOTO 950
2030 IF NF<2 THEN PRINT "cassette"
2040 IF NF>3 THEN PRINT "diskette"
2050 NF$="B12TXT":GOSUB 500:IF IN=0 THEN RETURN
2060 PRINT "Leesfout opgetreden"
2070 PRINT "Ik probeer door te gaan!"
2080 RETURN
30000 REM "****************************"
30010 REM "*                          *"
30020 REM "* BASISPROGRAMMA voor een  *"
30030 REM "*  BASICODE - 3 BULLETIN   *"
30040 REM "*   vanaf bestandstape     *"
30050 REM "*                          *"
30060 REM "*   TROS-Radio  1-7-1987   *"
30070 REM "*                          *"
30080 REM "*   Copyright (c) 1987:    *"
30090 REM "*   Stichting BASICODE     *"
30100 REM "*   EINDHOVEN              *"
30110 REM "*                          *"
30120 REM "****************************"
