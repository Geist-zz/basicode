1000 A=1000:GOTO 20:REM Keynesiaanse model
1010 DIM IN$(30,1),FO$(14),AF(1),Y(1),RM$(1),MR$(1)
1020 DIM XC(10,1),YC(10,1),VA$(10),PR$(1)
1030 HB=HO+1:VH=VE-2:AF(0)=13:AF(1)=4:PR$="off":PR=0
1040 RM$(0)="reele":RM$(1)="monetaire":Y1=0:R1=0:RM=2
1050 Y=0:R=0:W1=1:YE=0:YM=0:UW=.999
1060 MR$(0)="REELE SECTOR":MR$(1)="MONETAIRE SECTOR"
1070 FOR I=0 TO 1:FOR J=1 TO AF(I):READ IN$(J,I)
1080 NEXT J:NEXT I:PR$(1)="aanwezig":PR$(0)="afwezig"
1090 S$="":FOR I=1 TO HB/2:S$=S$+" ":NEXT I
1100 FOR I=1 TO 14:READ FO$(I):NEXT I
1110 GOSUB 100:FO=0:SR$="KEYNESIAANSE MODEL"
1120 GOSUB 8490:PRINT:PRINT
1130 PRINT:PRINT"Geef uw keuze,":PRINT
1140 PRINT:PRINT" 1. invoer":PRINT" 2. uitvoer"
1150 PRINT" 3. wijzigen":PRINT" 4. wissen"
1160 PRINT" 5. printer on/off"
1170 PRINT" 6. grafische voorstelling":PRINT" 7. stoppen"
1180 PRINT:PRINT"Uw keuze: ";:GOSUB 120:PRINT:PRINT
1190 PRINT"reele sector:........";PR$(SGN(AF(0)))
1200 PRINT"monetaire sector:....";PR$(SGN(AF(1)))
1210 PRINT"printer:.............";PR$
1220 PRINT"vrij geheugen in Kb: ";:GOSUB 270:SR=FR/1024
1230 CN=1:CT=4:GOSUB 310:PRINT SR$:GOSUB 110
1240 GOSUB 210:IN=IN-48:IF (IN<1) OR (IN>7) THEN 1240
1250 GOSUB 100:IF IN=7 THEN 950
1260 ON IN GOSUB 1510,3510,4800,5130,5200,6010
1270 GOTO 1110
1500 REM *** invoer ***
1510 PRINT:PRINT"In welke sector wilt u invoeren:"
1520 GOSUB 8340:IF IN=3 THEN RETURN
1530 GOSUB 100:RM=IN-1:GOSUB 5170:SR$="INVOER "+MR$(RM)
1540 GOSUB 8490:W1=1:AF(RM)=1:PRINT:PRINT:SP$=" "
1550 PRINT"verg.";SP$;AF(RM);": ";:INPUT IN$(AF(RM),RM)
1560 IF IN$(AF(RM),RM)="" THEN AF(RM)=AF(RM)-1:RETURN
1570 AF(RM)=AF(RM)+1:IF AF(RM)>9 THEN SP$=""
1580 GOTO 1550
1600 REM *** vergelijking verwerken ***
1610 K=1:SA=0:LG=LEN(IN$):F1=0:F2=0:FO=0:H6=0:H5=0
1620 H$=MID$(IN$,K,1):H1$=H$
1630 GOSUB 8220:IF (F3=0) OR (F3=2) THEN 1660
1640 K=K+1:IF K>LG THEN 1820
1650 GOTO 1620
1660 SA=K-1:K=K+1:F1=1:Z=0
1670 IF K>LG THEN 1720
1680 H$=MID$(IN$,K,1):H2$=H$
1690 GOSUB 8220:IF F3=1 THEN 1720
1700 IF F3=3 THEN F2=1:GOTO 1720
1710 K=K+1:H1$=H1$+H2$:GOTO 1670
1720 Z=Z+1:IF Z=Y(RM) THEN 1720
1730 IF Z>AF(RM) THEN FO=2:RETURN
1740 GOSUB 7290:IF H1$=VA$ THEN 1760
1750 GOTO 1720
1760 H1=LEN(IN$(Z,RM))-VL+1:H2$=""
1770 H2=LEN(IN$)+1
1780 IF F2=1 THEN H2$="*":F2=0
1790 H1$="("+RIGHT$(IN$(Z,RM),H1)+")"
1795 IF SA<1 THEN IN$=H1$+H2$+RIGHT$(IN$,H2-K):GOTO 1810
1800 IN$=LEFT$(IN$,SA)+H1$+H2$+RIGHT$(IN$,H2-K)
1810 K=K+H1+1:LG=LEN(IN$):IF K<LG THEN 1620
1820 IF F1<>0 THEN 1610
1830 IF FO<>0 THEN RETURN
1840 IF LEFT$(IN$,1)="(" THEN 1860
1850 IN$="("+IN$+")"
1860 F2=0:LG=LEN(IN$):FOR I=1 TO LG
1870 H$=MID$(IN$,I,1)
1880 IF H$="(" THEN H6=H6+1:GOTO 1910
1890 IF H$=")" THEN H5=H5+1:GOTO 1910
1900 GOSUB 8230:IF (F3=0) OR (F3=2) THEN F2=1
1910 NEXT I:IF H6<>H5 THEN FO=4
1920 RETURN
2000 REM *** haakjes uitwerken ***
2010 LG=LEN(IN$):DU$="":I=1
2020 IF I=LG THEN RETURN
2030 I=1:GB$="!":LG=LEN(IN$)
2040 H$=MID$(IN$,I,1)
2050 IF H$="(" THEN F1=I-1:GU$=GB$:GB$=""
2060 GB$=GB$+H$
2070 IF H$=")" THEN F2=I+1:GOSUB 2100:GOTO 2020
2080 I=I+1:IF I>LG THEN FO=4:RETURN
2090 GOTO 2040
2100 IF (I=LG) OR (GU$="!") THEN GOSUB 2400:RETURN
2110 J=LEN(GU$)-1
2120 H$=RIGHT$(GU$,1):H1$=H$
2130 IF (H$="*") OR (H$="/") THEN 2170
2140 IF (H$="+") OR (H$="-") THEN 2230
2150 IF H$="(" THEN H$="+":GOTO 2230
2160 H1$=H$+"*":F1=F1+1
2170 H$=MID$(GU$,J,1):IF H$="(" THEN 2210
2180 H1$=H$+H1$
2190 IF (H$="+") OR (H$="-") THEN 2230
2200 J=J-1:GOTO 2170
2210 IF (LEFT$(H1$,1)="+") OR (LEFT$(H1$,1)="-") THEN 2230
2220 H1$="+"+H1$:H$="+":F1=F1+1
2230 TG$=H$:H2$="":H3$="":J=2:F1=F1-LEN(H1$)
2240 TE$=MID$(GB$,2,1):IF TE$<>"-" THEN TE$="+"
2250 H$=MID$(GB$,J,1)
2260 IF ((H$<>"+") AND  (H$<>"-")) OR (J=2) THEN 2280
2270 GOSUB 2330:H2$="":TE$=H$:GOTO 2320
2280 IF H$=")" THEN GOSUB 2330:GOTO 2380
2290 IF (H$<>"+") AND  (H$<>"-") THEN 2310
2300 IF J=2 THEN 2320
2310 H2$=H2$+H$
2320 J=J+1:GOTO 2250
2330 IF LEN(H1$)<2 THEN H4$="":GOTO 2340
2335 H4$=RIGHT$(H1$,LEN(H1$)-1)
2340 IF (TG$="-") AND  (TE$="-") THEN H1$="+"+H4$
2350 IF (TG$="+") AND  (TE$="-") THEN H1$="-"+H4$
2360 H3$=H3$+H1$+H2$:H1$=TG$+H4$
2370 RETURN
2380 IF F1=0 THEN F1=1
2385 IN$=LEFT$(IN$,F1)+H3$+RIGHT$(IN$,LG-F2+1)
2390 RETURN
2400 H$=MID$(IN$,2,1):GB$=""
2410 IF (H$="+") OR (H$="-") THEN 2430
2420 GB$="+":IF H$<>"(" THEN 2430
2425 IN$=RIGHT$(IN$,LEN(IN$)-1)
2430 DU$=DU$+GB$+MID$(IN$,2,F2-3)
2440 IF I=LG THEN 2460
2450 IN$="("+RIGHT$(IN$,LG-F2+1)+")"
2460 RETURN
2500 REM *** coefficienten bepalen ***  
2510 F1=0:F2=0:YG=0:GG=0:RY=0:K=1:LG=LEN(IN$):H1$=""
2520 H$=MID$(IN$,K,1)
2530 IF (H$="*") OR (H$="/") THEN GOSUB 3010
2540 IF FO<>0 THEN RETURN
2550 IF (H$="+") OR (H$="-") THEN GOSUB 2620
2560 IF H$="Y" THEN H$="":F1=1
2570 IF H$="R" THEN H$="":F1=2
2580 H1$=H1$+H$
2590 K=K+1
2600 IF K>LG THEN GOSUB 2620:RETURN
2610 GOTO 2520
2620 G1=VAL(H1$)
2630 IF (G1=0) AND  (F1=0) THEN RETURN
2640 IF G1=0 THEN G1=VAL(H1$+"1")
2650 IF F1=0 THEN GG=GG+G1
2660 IF F1=1 THEN YG=YG+G1
2670 IF F1=2 THEN RY=RY+G1
2680 F1=0:H1$="":RETURN
3000 REM *** delen of vermenigvuldigen ***
3010 G1=VAL(H1$):F2=0
3020 IF G1=0 THEN G1=VAL(H1$+"1")
3030 B1$=H$:H1$=""
3040 K=K+1:IF K>LG THEN H$="+":GOTO 3110
3050 H$=MID$(IN$,K,1)
3060 IF (H$="+") OR (H$="-") THEN 3110
3070 IF (H$="*") OR (H$="/") THEN 3110
3080 IF (H$="Y") OR (H$="y") THEN H$="":F2=1
3090 IF (H$="R") OR (H$="r") THEN H$="":F2=2
3100 H1$=H1$+H$:GOTO 3040
3110 G2=VAL(H1$):B2$=H$
3120 IF (G2=0) AND  (B1$="/") THEN FO=10:RETURN
3130 IF (G2=0) AND  (F2=0) THEN 3100
3140 IF G2=0 THEN G2=VAL(H1$+"1")
3150 IF B1$="*" THEN G1=G1*G2:GOTO 3190
3160 IF B1$="/" THEN G1=G1/G2
3170 IF (F1>0) AND  (F2>0) THEN F1=0:F2=0
3180 IF F2>0 THEN F1=F2:F2=0
3190 IF (F1>0) AND  (F2>0) THEN FO=5
3200 IF F2>0 THEN F1=F2:F2=0
3210 IF (B2$<>"-") AND  (B2$<>"+") THEN 3230
3220 SR=G1:GOSUB 300:H1$=SR$:H$=B2$:RETURN
3230 H1$="":B1$=B2$:GOTO 3040
3500 REM *** berekeningen ***
3510 PRINT:PRINT"Wat wilt u weten:":PRINT
3520 PRINT:PRINT" 1. evenwichtsinkomen en rentevoet"
3530 PRINT:PRINT" 2. totaal overzicht"
3540 GOSUB 8360:GOSUB 100:IF IN=3 THEN RETURN
3550 ON IN GOTO 3940,3570
3560 REM *** totaaloverzicht ***
3570 GOSUB 3940:IF FO<>0 THEN RETURN
3580 GOSUB 100:SL=0:SH=1:IF AF(1)=0 THEN SH=0
3590 IF PR=1 THEN GOSUB 8520
3600 CN=2:CT=6:SR$="TOTAALOVERZICHT":GOSUB 8490
3610 IF PR=1 THEN F1=1:GOSUB 8310
3620 PRINT:PRINT:IF FO<>0 THEN 8010
3630 SR=Y:GOSUB 310:SR$="Y="+SR$
3640 IF PR=1 THEN F1=0:GOSUB 8310
3650 PRINT SR$:IF SH=0 THEN 3680
3660 CN=3:CT=6:SR=R:GOSUB 310:SR$="R="+SR$
3670 PRINT SR$:IF PR=1 THEN F1=1:GOSUB 8310
3680 H1=AF(0):IF AF(1)>H1 THEN H1=AF(1)
3690 IF PR=1 THEN GOSUB 360
3700 CN=1:CT=5
3710 SR$=MR$(0)+RIGHT$(S$,HB/2-14)
3720 IF SH=0 THEN 3740
3730 SR$=SR$+MR$(1)
3740 IF PR=1 THEN F1=1:GOSUB 8310
3750 PRINT:PRINT SR$:PRINT
3760 FOR TE=1 TO H1:B$=" ":FOR RM=0 TO SH
3770 IF TE=Y(RM) THEN 3820
3780 GOSUB 8410:IF IN$="" THEN 3820
3790 IF FO<>0 THEN 8010
3800 SR=YG*Y+RY*R+GG:GOSUB 310:H1=LEN(LF$)
3810 B$=B$+LF$+"="+RIGHT$(S$,3-H1)+SR$
3820 IF RM=1 THEN 3840
3830 B$=B$+RIGHT$(S$,HB/2-LEN(B$)+1)
3840 NEXT RM
3850 SR$=B$:IF PR=1 THEN F1=0:GOSUB 8310
3860 PRINT SR$
3870 NEXT TE:SR=ME:GOSUB 310:B$="mpr: "+SR$
3880 IF AF(1)=0 THEN SR$=B$:GOTO 3910
3890 SR=MM:GOSUB 310
3900 SR$=B$+RIGHT$(S$,HB/2-LEN(B$)+5)+SR$
3910 IF PR=1 THEN GOSUB 8310
3920 PRINT SR$:GOTO 7370
3930 REM *** evenwichtsinkomen berekenen ***
3940 SL=0:SH=1
3950 IF AF(0)=0 THEN SL=1
3960 IF AF(1)=0 THEN SH=0
3970 IF (SL<>1) OR (SH<>0) THEN 3990
3980 FO=3:GOTO 8010
3990 IF ((Y<>0) OR (R<>0)) AND  (W1=0) THEN 4400
4000 PRINT"Momentje, dit kost zelfs voor mij tijd!";
4010 RM=SL
4020 Y(RM)=0
4030 Y(RM)=Y(RM)+1:FO=0
4040 IF Y(RM)>AF(RM) THEN FO=6:GOTO 8010
4050 Z=Y(RM):GOSUB 8100:IF FO<>0 THEN 8010
4060 B=I:IF F2=1 THEN 4120
4070 IN$=LF$:GOSUB 1610
4080 IF (F2=1) OR (FO<>0) THEN 4030
4090 B$=IN$:H$=IN$(Y(RM),RM):IN$=RIGHT$(H$,LEN(H$)-B+1)
4100 GOSUB 1610:IF (FO<>0) OR (F2=1) THEN 4030
4110 GOTO 4160
4120 IN$=LF$:GOSUB 1610:B$=IN$
4130 IF FO<>0 THEN 8010
4140 H$=IN$(Y(RM),RM):IN$=RIGHT$(H$,LEN(H$)-B+1)
4150 GOSUB 1610:IF FO<>0 THEN 8010
4160 H$=B$:B$=IN$:IN$=H$:GOSUB 2010:IF FO<>0 THEN 8010
4170 IN$=DU$:GOSUB 2510:IF FO<>0 THEN 8010
4180 GY=YG:GH=GG:YR=RY
4190 IN$=B$:GOSUB 2010:IF FO<>0 THEN 8010
4200 IN$=DU$:GOSUB 2510:IF FO<>0 THEN 8010
4210 YG=GY-YG:GG=GG-GH:YR=RY-YR
4220 IF RM=0 THEN YE=YG:RG=GG:RR=YR
4230 IF RM=1 THEN YM=YG:GM=GG:MR=YR
4240 RM=RM+1:IF RM=SH THEN 4020
4250 RM=2:IF YE=0 THEN FO=9:RM=0:GOTO 8010
4260 ME=1/YE*SGN(RG)
4270 IF AF(1)=0 THEN Y=RG/YE:RM=0:GOTO 4390
4280 IF YM=0 THEN FO=9:RM=1:GOTO 8010
4290 GOSUB 8610:IF FO<>0 THEN 8010
4300 Y=H2:R=H1
4310 REM *** multiplier berekenen ***
4320 FOR RM=0 TO 1
4330 IF RM=0 THEN RG=RG+SGN(RG)
4340 IF RM=1 THEN GM=GM+SGN(GM)
4350 GOSUB 8610:FO=0
4360 IF RM=0 THEN ME=H2-Y:RG=RG-SGN(RG)
4370 IF RM=1 THEN MM=H2-Y:GM=GM-SGN(GM)
4380 NEXT RM
4390 IF Y<0 THEN FO=7:GOTO 8010
4400 W1=0:IF IN=2 THEN RETURN
4410 GOSUB 100:SR$="OPLOSSING":
4420 GOSUB 8490:PRINT:PRINT:PRINT
4430 CN=2:CT=6
4440 IF PR=1 THEN GOSUB 8520
4450 SR$="Van het opgegeven model"
4460 IF PR=1 THEN GOSUB 350
4470 PRINT SR$;:IF AF(1)=0 THEN 4690
4480 SR$=" zijn de even-":IF PR=1 THEN F1=0:GOSUB 8310
4490 PRINT SR$:SR$="wichtsvergelijkingen:"
4500 IF PR=1 THEN F1=1:GOSUB 8310
4510 PRINT SR$:SR$=RM$(0)+" sector: "+IN$(Y(0),0)
4520 PRINT:IF PR=1 THEN F1=0:GOSUB 8310
4530 PRINT SR$:SR$=RM$(1)+" sector: "+IN$(Y(1),1)
4540 IF PR=1 THEN F1=1:GOSUB 8310
4550 PRINT SR$:PRINT:SR=Y:GOSUB 310
4560 SR$="Het evenwichtsinkomen (Y) is: "+SR$
4570 IF PR=1 THEN F1=0:GOSUB 8310
4580 PRINT SR$:SR=R:CN=3:GOSUB 310
4590 SR$="De rentevoet (R) is: "+SR$
4600 IF PR=1 THEN F1=1:GOSUB 8310
4610 PRINT SR$:PRINT:CN=3
4620 FOR RM=0 TO 1:SR$=""
4630 IF RM=0 THEN H1=ME:GOTO 4650
4640 H1=MM
4650 SR=H1:GOSUB 310
4660 SR$="Multiplier "+RM$(RM)+" sector: "+SR$
4670 IF PR=1 THEN F1=0:GOSUB 8310
4680 PRINT SR$:NEXT RM:GOTO 7370
4690 SR$=" is de even-":IF PR=1 THEN F1=0:GOSUB 8310
4700 PRINT SR$:SR$="wichtsvergelijking: "+IN$(Y(0),0)
4710 IF PR=1 THEN F1=1:GOSUB 8310
4720 PRINT SR$:PRINT:SR=Y:GOSUB 310
4730 SR$="Het evenwichtsinkomen (Y) is: "+SR$
4740 IF PR=1 THEN GOSUB 8310
4750 PRINT SR$:PRINT:CN=3:SR=ME:GOSUB 310
4760 SR$="De multiplier is: "+SR$
4770 IF PR=1 THEN GOSUB 8310
4780 PRINT SR$:GOTO 7370
4790 REM *** wijzigen ***
4800 PRINT:PRINT"Welke sector wilt u wijzigen:"
4810 GOSUB 8340:IF IN=3 THEN RETURN
4820 GOSUB 100:W1=1
4830 H1=1:H2=VH-4:RM=IN-1
4840 GOSUB 100:SP$=" "
4850 SR$=MR$(RM)+" WIJZIGEN"
4860 GOSUB 8490
4870 PRINT:PRINT:FOR I=H1 TO H2
4880 IF I>9 THEN SP$=""
4890 IF I>40 THEN 4910
4900 PRINT SP$;I;":";IN$(I,RM)
4910 NEXT I
4920 HO=0:VE=VH-1:GOSUB 110
4930 PRINT"Geef commando: ";:INPUT IN$
4940 IF IN$="" THEN RETURN
4950 IF LEN(IN$)>1 THEN IN=VAL(RIGHT$(IN$,LEN(IN$)-1))
4960 IN$=LEFT$(IN$,1)
4970 SR$=IN$:GOSUB 330
4980 IF (SR$="W") AND  (IN<>0) THEN GOSUB 5030
4990 IF SR$="T" THEN GOSUB 5050
5000 IF (SR$="V") AND  (IN<>0) THEN GOSUB 5060
5010 IF SR$="P" THEN 5090
5020 GOTO 4840
5030 FOR I=IN TO AF(RM):IN$(I,RM)=IN$(I+1,RM)
5040 NEXT I:AF(RM)=AF(RM)-1:RETURN
5050 AF(RM)=AF(RM)+1:IN=AF(RM)
5060 HO=0:VE=VH-1:GOSUB 110:PRINT"Geef vergelijking: ";IN
5070 INPUT IN$(IN,RM)
5080 RETURN
5090 H1=H2+1:H2=H2+VH-4
5100 IF H1>AF THEN H1=1:H2=VH-4
5110 GOTO 4840
5120 REM *** wissen ***
5130 PRINT:PRINT"Welke sector wilt u wissen:"
5140 GOSUB 8340
5150 IF IN=3 THEN RETURN
5160 GOSUB 100:RM=IN-1:W1=1
5170 FOR I=1 TO AF(RM):IN$(I,RM)="":NEXT I
5180 AF(RM)=0:RETURN
5190 REM *** printer on/off ***
5200 PR=1-PR
5210 IF PR$="on" THEN PR$="off":RETURN
5220 PR$="on":RETURN
6000 REM *** grafische voorstelling ***
6010 GOSUB 100
6020 SR$="GRAFISCHE VOORSTELLING":GOSUB 8490
6030 PRINT:PRINT:PRINT:PRINT"Geef uw keuze:"
6040 PRINT:PRINT" 1. IS-LM grafiek"
6050 PRINT:PRINT" 2. IS-LM grafiek, nieuw en oud"
6060 PRINT:PRINT" 3. grafiek(en)"
6070 PRINT:PRINT" 4. terug naar hoofdmenu"
6080 PRINT:PRINT"Uw keuze: ";
6090 GOSUB 210:IN=IN-48:IF (IN<1) OR (IN>4) THEN 6090
6100 IF IN=4 THEN RETURN
6110 GOSUB 100
6120 ON IN GOSUB 6210,6170,6510
6130 IF FO<>0 THEN RETURN
6140 GOSUB 210:IF IN=67 THEN GOSUB 20020
6150 GOTO 6010
6160 REM *** IS-LM grafiek ***
6170 IF (Y1=0) OR (R1=0) THEN 6210
6180 FOR I=9 TO 10:FOR J=0 TO 1:XC(I-2,J)=XC(I,J)
6190 YC(I-2,J)=YC(I,J):VA$(I-2)=VA$(I)
6200 NEXT J:NEXT I:S1=6:GOTO 6220
6210 S1=8
6220 IF (AF(0)=0) OR (AF(1)=0) THEN FO=12:GOTO 8010
6230 IF W1=1 THEN IN=2:FO=0:GOSUB 3940:W1=0
6240 IF (R=0) AND  (FO=0) THEN FO=11:GOTO 8010
6250 IF FO<>0 THEN RETURN
6260 IF S1=8 THEN Y1=2*Y:R1=2*R
6270 H6=Y1:H4=R1:AF=10
6280 F1=H6/.8999:F2=.9/H4:S2=10
6290 FOR I=9 TO 10
6300 IF I=9 THEN H1=YE:H2=RR:H3=RG
6310 IF I=10 THEN H1=YM:H2=MR:H3=GM
6320 GOSUB 6930:IF FO<>0 THEN I=11
6330 NEXT I
6335 IF FO<>0 THEN 8010
6340 GOSUB 7130
6350 VA$(9)="R.I=S":VA$(10)="M.L=M"
6360 GOSUB 6820
6370 FOR HO=Y/F1+.1 TO .1 STEP -3/HG
6380 VE=.9-F2*R:GOSUB 620:NEXT HO
6390 FOR VE=.9-F2*R TO .9 STEP 3/VG
6400 HO=Y/F1+.1:GOSUB 620:NEXT VE
6410 RETURN
6500 REM *** verg. invoeren ***
6510 SR$="VERGELIJKINGEN INVOEREN":GOSUB 8480
6520 PRINT:PRINT
6530 PRINT"Hoeveel vergelijkingen: ";
6540 INPUT AF:IF (AF<1) OR (AF>8) THEN 6530
6550 S1=0:FOR I=1 TO AF
6560 PRINT:PRINT"Geef vergelijking: ";
6570 INPUT VA$(I):SR$=LEFT$(VA$(I),2):GOSUB 330
6580 IF (SR$="M.") OR (SR$="R.") THEN 6600
6590 PRINT"Niet correct":PRINT:GOTO 6560
6600 NEXT I:L=0:PRINT:PRINT"Momentje...";
6610 L=L+1:F1=0:LG=LEN(VA$(L))
6620 SR$=LEFT$(VA$(L),1):GOSUB 330
6630 IF SR$="M" THEN RM=1
6640 IF SR$="R" THEN RM=0
6650 H1$=MID$(VA$(L),3,LG-2):H1=VAL(H1$)
6660 IF H1=0 THEN 6700
6670 IF H1>AF(RM) THEN FO=14:VA$(L)="":GOTO 8010
6680 IN$=IN$(H1,RM):Z=H1:GOSUB 7290
6690 VA$(L)=LEFT$(VA$(L),2)+VA$:GOTO 6750
6700 Z=0
6710 Z=Z+1:GOSUB 7290:IF H1$=VA$ THEN 6740
6720 IF Z>=AF(RM) THEN FO=2:VA$="":GOTO 8010
6730 GOTO 6710
6740 IN$=IN$(Z,RM)
6750 TE=Z:GOSUB 8410:IF YG=0 THEN H3=GG+R*RY:GOTO 6770
6760 H1=1:H2=1/YG:H3=-GG/YG-R*RY
6770 H6=400:H4=H6:I=L:GOSUB 6930:IF FO<>0 THEN 8010
6780 IF L<>AF THEN 6610
6790 F1=H6/.8999:F2=.9/H4:GOSUB 7130
6800 GOSUB 6820:RETURN
6810 REM *** verg. tekenen ***
6820 FOR I=1+S1 TO AF
6830 SR$=MID$(VA$(I),3,LEN(VA$(I))-2)
6840 FOR J=0 TO 1
6850 HO=XC(I,J)/F1+.1:VE=.9-F2*YC(I,J)
6860 IF J=0 THEN GOSUB 620:GOTO 6900
6870 GOSUB 630:IF VE>.88 THEN VE=.85
6880 IF HO>.98 THEN HO=.96
6890 HO=HO-.017*LEN(SR$):VE=VE+.01:GOSUB 650
6900 NEXT J:NEXT I
6910 RETURN
6920 REM *** coordinaten berekenen ***
6930 IF (H1<>0) AND  (H2<>0) THEN 6950
6932 IF H2=0 THEN 6940
6935 XC(I,0)=0:XC(I,1)=H6:YC(I,0)=H3:YC(I,1)=H3:RETURN
6940 XC(I,0)=H3:XC(I,1)=H3:YC(I,0)=H4:YC(I,1)=0:RETURN
6950 F3=H2/H1:IF F3>=0 THEN H5=H3/H1:GOTO 6970
6960 H5=(H4*H2+H3)/H1
6970 IF (H5<0) OR (H5>H6) THEN 7010
6980 XC(I,0)=H5:YC(I,0)=0
6990 IF F3<0 THEN YC(I,0)=H4
7000 GOTO 7030
7010 H5=-H3/H2:IF (H5<0) OR (H5>H4) THEN FO=13:RETURN
7020 YC(I,0)=H5:XC(I,0)=0
7030 IF F3>=0 THEN H5=(H4*H2+H3)/H1:GOTO 7050
7040 H5=H3/H1
7050 IF (H5<0) OR (H5>H6) THEN 7090
7060 XC(I,1)=H5:YC(I,1)=H4
7070 IF F3<0 THEN YC(I,1)=0
7080 GOTO 7110
7090 H5=(H1*H6-H3)/H2:IF (H5<0) OR (H5>H4) THEN FO=13:RETURN
7100 YC(I,1)=H5:XC(I,1)=H6
7110 RETURN
7120 REM *** assenstelsel ***
7130 GOSUB 600:CN=0:CT=3:HO=.1:VE=.9:GOSUB 620
7140 HO=UW:GOSUB 630:HO=.1:VE=0:GOSUB 620
7150 VE=.9:GOSUB 630
7160 FOR SR=H6/4 TO H6 STEP H6/4.001
7170 HO=SR/F1+.1:VE=.89:GOSUB 620
7180 VE=.91:GOSUB 630:GOSUB 310
7190 HO=HO-.075:VE=.93:GOSUB 650
7200 NEXT SR
7210 FOR I=0 TO H4 STEP H4/4
7220 VE=.9-I/H4*.9:HO=.09:GOSUB 620
7230 HO=.11:GOSUB 630:SR=I:GOSUB 310
7240 IF (VAL(SR$)>=1) OR (I=0) THEN 7260
7250 CT=4:CN=2:GOSUB 310:SR$=RIGHT$(SR$,3):CT=3:CN=0
7260 HO=0:GOSUB 650:NEXT I
7270 RETURN
7280 REM *** variabele uit string halen ***
7290 VA$="":VL=1:LG=LEN(IN$(Z,RM))
7300 H$=MID$(IN$(Z,RM),VL,1)
7310 IF H$="=" THEN VL=VL+1:RETURN
7320 IF H$=" " THEN 7340
7330 VA$=VA$+H$
7340 VL=VL+1:IF VL<LG THEN 7300
7350 FO=1:RETURN
7360 REM *** toets ***
7370 HO=HB-8:VE=VH:GOSUB 110:PRINT"<TOETS>";
7380 GOSUB 210:RETURN
8000 REM *** foutmelding ***
8010 GOSUB 100:SR$="FOUTMELDING":GOSUB 8490
8020 PRINT:PRINT:PRINT
8030 PRINT"Er is een fout geconstateerd, en wel:"
8040 IF FO<>2 THEN PRINT FO$(FO):GOTO 8060
8050 PRINT H1$;FO$(FO)
8060 IF RM>1 THEN 7370
8070 PRINT:PRINT"Deze fout komt voor in de ";RM$(RM)
8080 PRINT"sector.":GOTO 7370
8090 REM *** evenwichtsvergelijkingen zoeken ***
8100 I=0:H1$="":F2=0
8110 LG=LEN(IN$(Z,RM))
8120 I=I+1:IF I>=LG THEN FO=1:RETURN
8130 H$=MID$(IN$(Z,RM),I,1)
8140 IF H$=" " THEN 8120
8150 IF (H$="+") OR (H$="-") THEN F2=1
8160 IF (H$>="0") AND  (H$<="9") THEN F2=1
8170 IF H$="=" THEN 8190
8180 H1$=H1$+H$:GOTO 8120
8190 IF H1$="R" THEN F2=1
8200 IF H1$="Y" THEN F2=1
8210 I=I+1:LF$=H1$:RETURN
8220 REM *** variabele of cijfer ? ***
8230 F3=0:IF (H$="Y") OR (H$="R") THEN GOSUB 8290
8240 IF (H$>="0") AND  (H$<="9") THEN F3=F3+1
8250 IF (H$="*") OR (H$="-") OR (H$="+") THEN F3=F3+1
8260 IF (H$="/") OR (H$="(") OR (H$=")") THEN F3=F3+1
8270 IF (H$=".") OR (H$="") THEN F3=F3+1
8280 RETURN
8290 F3=2:H$=MID$(IN$,K+1,1):RETURN
8300 REM *** printen ***
8310 GOSUB 350:FOR J=0 TO F1:GOSUB 360:NEXT J
8320 RETURN
8330 REM *** reel of monetair ? ***
8340 PRINT:PRINT:PRINT" 1. reele sector"
8350 PRINT:PRINT" 2. monetaire sector"
8360 PRINT:PRINT" 3. terug naar het hoofdmenu"
8370 PRINT:PRINT:PRINT"Geef uw keuze: ";
8380 GOSUB 210:IN=IN-48:IF (IN<1) OR (IN>3) THEN 8380
8390 RETURN
8400 REM *** waarden verg. zoeken ***
8410 Z=TE:GOSUB 8100
8420 IN$=RIGHT$(IN$(Z,RM),LG-I+1)
8430 IF IN$="" THEN RETURN
8440 GOSUB 1610:IF FO<>0 THEN RETURN
8450 GOSUB 2010:IF FO<>0 THEN RETURN
8460 IN$=DU$:GOSUB 2510
8470 RETURN
8480 REM *** reverse printen ***
8490 HO=INT(HB/2-LEN(SR$)/2-3):VE=0
8500 GOSUB 110:GOSUB 150:RETURN
8510 REM *** model printen ***
8520 SR$="HET OPGEGEVEN MODEL IS:"
8530 F1=1:GOSUB 8310
8540 FOR RM=SL TO SH:FOR I=1 TO AF(RM)
8550 IF I>1 THEN 8570
8560 SR$=MR$(RM):F1=1:GOSUB 8310
8570 F1=0:SR$=IN$(I,RM):GOSUB 8310
8580 NEXT I:GOSUB 360:NEXT RM:GOSUB 360
8590 RETURN
8600 REM *** Y en R berekenen ***
8610 H3=1/YE*RG:H4=1/YE*RR
8620 H5=1/YM*GM:H6=1/YM*MR
8630 IF (RR=0) AND  (MR=0) THEN FO=11:RETURN
8640 H1=(H5-H3)/(H4-H6):H2=H4*H1+H3
8650 IF H1<0 THEN FO=8:RM=1
8660 IF H2<0 THEN FO=7
8670 RETURN
20000 REM *** hier kunt u een screen- ***
20010 REM *** dumpprogramma plaatsen  ***
20020 IF PR=0 THEN RETURN:REM *** LATEN STAAN! ***
20025 REM bijvoorbeeld  CALL&C00A
20030 RETURN
25000 DATA "C=.75(Y-B-Sp+Ou)+40"
25010 DATA "B=.35Y+40","Sp=.1Y","I=-800R+200"
25020 DATA "O=Ob+Ou","Ob=.225Y+80","Ou=5W+54"
25030 DATA "E=60","M=100","W=Na-Nv","Na=17"
25040 DATA "Nv=Y/25","Y=C+I+Ob+E-M","La=.5Y"
25050 DATA "Lb=-660R+150","M=210","La+Lb=M"
25060 REM 
25070 DATA "Geen juiste vergelijking"
25080 DATA " is een onbekende variabele"
25090 DATA "Er is geen invoer aanwezig"
25100 DATA "De haakjes zijn fout geplaatst"
25110 DATA "Er is een kwadratische functie ontstaan"
25120 DATA "Er is geen evenwichtsvergelijking"
25130 DATA "Er is een negatieve Y ontstaan"
25140 DATA "Er is een negatieve R ontstaan"
25150 DATA "Er is geen Y aanwezig"
25160 DATA "Een noemer is nul geworden"
25170 DATA "Er is geen R aanwezig"
25180 DATA "Niet beide sectoren zijn aanwezig"
25190 DATA "Grafiek zit niet in het eerste kwadrant"
25200 DATA "Vergelijking bestaat (nog) niet"
32000 REM ****************************
32010 REM      KEYNESIAANSE MODEL
32020 REM 
32030 REM (C) Ronald van Vugt, PA3EAH
32040 REM 
32050 REM Postbus 160, 5580 AD, Waalre
32060 REM 
32070 REM       april 1987, v1.4
32080 REM ****************************  
32090 REM TROS-RADIO dd.870422
