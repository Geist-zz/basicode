1000 A=100:GOTO 20:REM testbeeld
1010 UW=1-1/HG:CN=0:H1=1/HG:V1=1/VG:FL=0:V6=V1
1020 V4=28/VG:H4=35/HG:H9=9/HG:H2=18/HG:V5=.5/VG
1030 DIM HO(1),VE(1)
1040 GOSUB 100
1050 SR$="TESTBEELD"
1060 HO=(HO+1)/2-8:VE=0:GOSUB 110:GOSUB 150
1070 VE=5:HO=0:GOSUB 110
1080 PRINT"Dit programma tekent het testbeeld"
1090 PRINT"dat normaliter overdag uitgezonden"
1100 PRINT"wordt op de nederlandse zenders."
1110 PRINT:PRINT"U kunt zelf de tekst ingeven die in"
1120 PRINT"het testbeeld moet verschijnen."
1130 PRINT"Zorg ervoor dat deze tekst niet te"
1140 PRINT"lang is (ongeveer 8 karakters kan"
1150 PRINT"nog)."
1160 PRINT:PRINT"Geef de gewenste tekst (0=stop) ";
1170 INPUT SR$:IF SR$="" THEN SR$="BASICODE"
1180 IF SR$="0" THEN 950
2000 REM testbeeld tekenen
2010 GOSUB 600
2020 FOR X=1 TO 35 STEP 2:HO=X/36
2030 VE=UW:GOSUB 620:VE=0:GOSUB 630:NEXT X
2040 REM horizontale beginstrepen
2050 FOR Y=1 TO 27 STEP 2:VE=Y/28
2060 HO=0:GOSUB 620:HO=UW:GOSUB 630:NEXT Y
2070 REM vertikale vlakjes
2080 FOR I=3 TO 25 STEP 4
2090 FOR Y=I TO I+2 STEP V4:VE=Y/28
2100 HO=0:GOSUB 620:HO=1/36:GOSUB 630
2110 HO=35/36:GOSUB 620:HO=UW:GOSUB 630
2120 NEXT Y:NEXT I
2130 REM horizontale vlakjes
2140 FOR I=3 TO 33 STEP 4
2150 FOR X=I TO I+2 STEP H4:HO=X/36
2160 VE=0:GOSUB 620:VE=1/28:GOSUB 630
2170 VE=27/28:GOSUB 620:VE=UW:GOSUB 630
2180 NEXT X:NEXT I
2190 REM vlakjes in de hoeken
2200 FOR Y=0 TO 27 STEP 27
2210 FOR I=0 TO 35 STEP 35
2220 FOR X=I TO I+.99 STEP H4:HO=X/36
2230 VE=Y/28:GOSUB 620:VE=VE+1/29:GOSUB 630
2240 NEXT X:NEXT I:NEXT Y
2250 REM cirkel
2260 RY=.5-1/14:RX=RY/1.33
2270 FOR X=0 TO 3.14 STEP 2.9/HG
2280 HO=.5+RX*COS(X)
2290 VE=.5+RY*SIN(X)
2300 GOSUB 620:VE=1-VE:GOSUB 630:NEXT X
2310 REM rechthoek boven in de cirkel
2320 READ HO(0),VE(0),HO(1),VE(1)
2330 CN=1:GOSUB 3140
2340 REM vlakken links/rechts boven in de cirkel
2350 FOR Y=5 TO 7 STEP V4:VE=Y/28
2360 HO=1-(.5+RX*SQR(1-(VE-.5)/RY*(VE-.5)/RY)):GOSUB 620
2370 B=1-HO:HO=1/3:GOSUB 630:HO=B:GOSUB 620:HO=2/3
2380 GOSUB 630:NEXT Y
2390 REM controle reflectie streepje
2400 HO=13/36:VE=5/28:GOSUB 620:VE=7/28:GOSUB 630
2410 FOR Y=7 TO 9 STEP V4:VE=Y/28
2420 HO=1-(.5+RX*SQR(1-(VE-.5)/RY*(VE-.5)/RY))
2430 IF Y=7 THEN B=HO
2440 GOSUB 620:HO=B:GOSUB 630:NEXT Y
2450 HM=(.5+RX*SQR(1-(.25/RY*.25/RY)))*36
2460 FOR I=10 TO HM STEP (HM-10)/6.5
2470 FOR X=I TO I+(HM-10)/13 STEP H4:HO=X/36
2480 VE=.25:GOSUB 620:VE=9/28:GOSUB 630
2490 NEXT X:NEXT I
2500 REM middenvlak
2510 FOR Y=13 TO 15 STEP V4:VE=Y/28
2520 HO=.5+RX*SQR(1-(VE-.5)/RY*(VE-.5)/RY)
2530 GOSUB 620:HO=1-HO:GOSUB 630:NEXT Y
2540 REM zwarte vlakken onder middenvlak
2550 FOR Y=15 TO 19 STEP V4:VE=Y/28
2560 HO=.5+RX*SQR(1-(VE-.5)/RY*(VE-.5)/RY)
2570 GOSUB 620:B=1-HO:HO=28/36:GOSUB 630
2580 HO=B:GOSUB 620:HO=8/36:GOSUB 630
2590 NEXT Y
2600 REM definitielijnen
2610 FOR I=2 TO 5
2620 READ S:S=1/S
2630 GOSUB 3190:NEXT I
2640 FOR I=6 TO 7 STEP H2:HO=I/9
2650 VE=15/28:GOSUB 620:VE=19/28:GOSUB 630:NEXT I
2660 REM zwarte balk linksonder definitielijnen  
2670 FOR Y=19 TO 21 STEP V4:VE=Y/28
2680 HO=1-(.5+RX*SQR(1-(VE-.5)/RY*(VE-.5)/RY)):GOSUB 620
2690 HO=.5:GOSUB 630:NEXT Y
2700 REM zwarte balk middenonder de cirkel
2710 FOR I=0 TO 1:READ HO(I),VE(I):NEXT I:GOSUB 3140
2720 REM "blauw vlak" rechtsboven de cirkel
2730 FOR Y=9 TO 13 STEP V4:VE=Y/28
2740 HO=.5+RX*SQR(1-(VE-.5)/RY*(VE-.5)/RY):GOSUB 620
2750 HO=26/36:GOSUB 630:NEXT Y
2760 REM "kleurenvlakken"   
2770 READ WX:VE(0)=INT(VG/7+.99):VE(1)=9
2780 FOR XX=22 TO 10 STEP -4
2790 READ S:GOSUB 3260:NEXT XX
2800 REM verticale rechthoek midden in de cirkel
2810 FOR I=0 TO 1:READ HO(I),VE(I):NEXT I:GOSUB 3140
2820 REM strepen door de vlakken in het midden
2830 CN=0:VE=.5:HO=.5+RX:GOSUB 620:HO=1-HO:GOSUB 630
2840 HO=.5:VE=11/28:GOSUB 620:VE=17/28:GOSUB 630
2850 REM dwarsstrepen in het midden
2860 FOR X=7 TO 29 STEP 2:HO=X/36
2870 VE=13/28:GOSUB 620:VE=15/28:GOSUB 630:NEXT X
2880 CN=1:READ VE(1),XX,WX,S:VE(0)=INT(3*VG/28+.99)
2890 GOSUB 3260
2900 REM strepen aan de zijkant weghalen
2910 FOR Y=5 TO 23 STEP 2:VE=Y/28
2920 HO=3/36+1/HG:GOSUB 620:HO=5/36-1/HG:GOSUB 630
2930 HO=31/36+1/HG:GOSUB 620:HO=33/36-1/HG:GOSUB 630
2940 IF (VE>6/28) AND (VE<22/28) THEN 2970
2950 HO=5/36+1/HG:GOSUB 620:HO=7/36-1/HG:GOSUB 630
2960 HO=29/36+1/HG:GOSUB 620:HO=31/36-1/HG:GOSUB 630
2970 NEXT Y
2980 HO=5/36:VE=21/28+V6:GOSUB 620:VE=25/28-V6:GOSUB 630
2990 VE=3/28+V6:GOSUB 620:VE=7/28-V6:GOSUB 630
3000 HO=31/36:VE=21/28+V6:GOSUB 620:VE=25/28-V6:GOSUB 630
3010 VE=3/28+V6:GOSUB 620:VE=7/28-V6:GOSUB 630
3020 REM balken aan de zijkant "inkleuren"
3030 CN=0:READ WX:VE(0)=INT(11*VG/28)
3040 FOR I=1 TO 4
3050 READ VE(1),XX,S
3060 GOSUB 3260:NEXT I
3070 VE(0)=INT(VG/7):FOR I=1 TO 4
3080 READ VE(1),XX,S:GOSUB 3260:NEXT I
3090 VE=.77:HO=.4:GOSUB 650
3100 GOSUB 200:IF IN$="" THEN 3100
3110 GOTO 1040
3120 TS=36*S/HG:FL=0:FOR Y=0 TO VE(0)
3130 REM rechthoek
3140 FOR X=HO(0) TO HO(1) STEP H4:HO=X/36
3150 VE=VE(0)/28:GOSUB 620:VE=VE(1)/28:GOSUB 630
3160 NEXT X
3170 RETURN
3180 REM definitielijnen
3190 H=I+1-S:GS=S*2:BX=I+S
3200 FOR J=BX TO H STEP GS:HO=J/9
3210 FOR X=0 TO INT(S*HG/9)
3220 VE=15/28:GOSUB 620:VE=19/28:GOSUB 630
3230 HO=HO+1/HG:NEXT X:NEXT J:RETURN
3240 FOR VE=9/28 TO 1/2 STEP 1/VG
3250 REM "kleurenvlakken"
3260 TS=36*S/HG:FL=18:FOR Y=0 TO VE(0)
3270 VE=((VE(1)*VG+Y*28+14)/(28*VG))
3280 FL=18-FL:BX=S/HG*FL+XX:FOR X=BX TO BX+WX STEP TS
3290 IF X>=WX+XX THEN 3310
3300 HO=X/36:GOSUB 620
3310 NEXT X:NEXT Y:RETURN
25000 DATA 14,3,22,5
25010 DATA 6,8,12,20
25020 DATA 12,21,24,23
25030 DATA 4,2,3,4,5
25040 DATA 17,11,19,17
25050 DATA 23,17,2,2
25060 DATA 2
25070 DATA 14,3,2
25080 DATA 3,3,3
25090 DATA 14,31,4
25100 DATA 3,31,5
25110 DATA 21,5,3
25120 DATA 3,5,5
25130 DATA 21,29,3
25140 DATA 3,29,6
32000 REM -----------------------------
32010 REM Testbeeld,
32020 REM 
32030 REM Door Ronald van Vugt,
32040 REM               PA3EAH
32050 REM 
32060 REM Postbus 160, 5580 AD
32070 REM Waalre (NB)
32080 REM 
32090 REM gemaakt op een
32100 REM       ACORN ELECTRON 
32110 REM 
32120 REM     jan 1987 V1.2   
32130 REM -----------------------------
32500 REM TROS-RADIO dd. 870211
