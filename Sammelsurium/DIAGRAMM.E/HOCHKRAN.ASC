1000 A=1000:GOTO 20:REM *** HIJSKRAAN ***
1010 GOSUB 7000:GOSUB 600:CN=0
1020 HO=0:VE=0.9999:GOSUB 620
1030 HO=4/14:GOSUB 630
1040 VE=0.8:GOSUB 630
1050 HO=0:GOSUB 630
1060 VE=0.9999:GOSUB 630
1070 HO=1/14:VE=0.8:GOSUB 620
1080 VE=0.7:GOSUB 630
1090 HO=4/14:GOSUB 630
1100 VE=0.8:GOSUB 630
1110 HO=5/28:VE=0.7:GOSUB 620
1120 VE=0.2:GOSUB 630
1130 HO=0:GOSUB 620
1140 HO=0.9999:GOSUB 630
1150 HO=13/14:VE=0.1:GOSUB 630
1160 HO=1/14:GOSUB 630
1170 HO=0:VE=0.2:GOSUB 630
1180 HO=0.25:GOSUB 620
1190 VE=0.7:GOSUB 630
1200 HO=1/14:VE=0.1:GOSUB 620
1210 FOR X=1 TO 6
1220 HO=HO+1/14:VE=VE+0.1:GOSUB 630
1230 HO=HO+1/14:VE=VE-0.1:GOSUB 630
1240 NEXT X
1250 HO=5/28:VE=0.7:GOSUB 620
1260 FOR X=1 TO 4
1270 HO=HO+1/14:VE=VE-0.1:GOSUB 630
1280 HO=HO-1/14:GOSUB 630
1290 NEXT X
1300 HO=0.25:VE=0.225:GOSUB 620
1310 HO=0.9999:GOSUB 630
1320 VE=0.2:GOSUB 620
1330 VE=0.225:GOSUB 630
1500 REM *** EINDE TEKENEN KRAAN ***
1510 DIM X(4),Y(4),B(4),R(4),RB(4),GX(4),GY(4),Q(4)
1520 X(1)=110:X(2)=155:X(3)=200:X(4)=245
1530 FOR Y=1 TO 4:Y(Y)=160:GY(Y)=160:GX(Y)=X(Y):R(Y)=Y:NEXT Y
1540 X=75:Y2=59:C=0:D=0:C1=0:D1=0:C2=0:D2=0
1550 Y1=47:XZ=0:YZ=0:H1$="":H2$="":N=0:DX=0:L=40
1560 FOR Z=1 TO 4:C=X(Z):D=Y(Z):GOSUB 3000:RB(Z)=Z:NEXT Z
1570 FOR SR=1 TO 4:GOSUB 300:HO=(X(SR)+8+(SR-1)*5)/321
1580 VE=(Y(SR)+L/2-4)/201:GOSUB 650:NEXT SR
2000 REM 
2010 REM *** BEGIN HOOFDPROGRAMMA ***
2020 REM 
2030 FOR SR=1 TO 4:GOSUB 300:HO=(X(SR)+8+(SR-1)*5)/321
2040 VE=(Y(SR)+L/2-4)/201:GOSUB 650:NEXT SR
2050 REM 
2060 REM *** BEGIN HOOFDPROGRAMMA ***
2070 REM 
2080 GOSUB 4000
2090 GOSUB 210
2100 IF IN=83 THEN GOSUB 6010
2110 IF IN$<>"*" THEN 2090
2120 GOTO 950
3000 REM BLOK MET (C,D) MIDDENBOVEN
3010 C=C-L/2:D=D+L:CN=0
3020 HO=C/288:VE=D/201:GOSUB 620
3030 HO=(C+L)/288:VE=D/201:GOSUB 630
3040 HO=HO:VE=(D-L)/201:GOSUB 630
3050 HO=C/288:VE=VE:GOSUB 630
3060 HO=HO:VE=D/201:GOSUB 630:C=C+L/2:D=D-L
3070 RETURN
3500 REM WIST BLOK MET (C,D) MIDDENBOVEN
3510 CN=1:C=C-L/2:D=D+L
3520 HO=C/288:VE=D/201:GOSUB 620
3530 HO=(C+L)/288:VE=D/201:GOSUB 630
3540 VE=(D-L)/201:GOSUB 630
3550 HO=C/288:GOSUB 630
3560 VE=D/201:GOSUB 630
3570 RETURN
4000 REM * WISSEN EN TEKENEN KABEL *
4010 CN=1:HO=XZ/288:VE=Y1/201:GOSUB 620
4020 HO=HO:VE=YZ/201:GOSUB 630
4030 XZ=X:YZ=Y2
4040 CN=0:HO=X/288:VE=Y1/201:GOSUB 620
4050 HO=HO:VE=Y2/201:GOSUB 630
4060 RETURN
5000 REM * ZET EVT. BLOKKEN WEG *
5010 HP=N1:HQ=N2
5020 IF RB(R(N1))=N1 THEN 5110
5030 N1=RB(R(N1))
5040 FOR R=1 TO 4
5050 IF (R(HP)=R) OR (R(HQ)=R) THEN NEXT R
5060 IF RB(R)<>0 THEN 5080
5070 X(0)=GX(R):Y(0)=200:R(0)=R:Q(0)=0:B(0)=0
5080 N2=RB(R)
5090 GOSUB 6150
5100 N1=HP:N2=HQ:GOTO 5010
5110 REM 
5120 IF RB(R(HQ))=HQ THEN N1=HP:N2=HQ:RETURN
5130 N1=RB(R(HQ))
5140 FOR R=1 TO 4
5150 IF (R(HP)=R) OR (R(HQ)=R) THEN NEXT R
5160 IF RB(R)=0 THEN X(0)=GX(R):Y(0)=GY(R)+L
5170 N2=RB(R)
5180 GOSUB 6150
5190 N1=HP:N2=HQ:GOTO 5120
6000 REM INVOER EN CONTROLE
6010 SR$=H1$:HO=74/321:VE=169/201:CN=1:GOSUB 650
6020 SR$=H2$:HO=74/321:VE=182/201:GOSUB 650:CN=0
6030 SR$="blok a: ":HO=10/321:VE=169/201:GOSUB 650
6040 GOSUB 210:IF (IN<49) OR (IN>52) THEN GOSUB 250:GOTO 6040
6050 H1$=IN$:SR$=IN$:HO=74/321:VE=169/201:GOSUB 650
6060 N1=(IN-48)
6070 SR$="blok b: ":HO=10/321:VE=182/201:GOSUB 650
6080 GOSUB 210:IF (IN<49) OR (IN>52) THEN GOSUB 250:GOTO 6080
6090 H2$=IN$:SR$=IN$:HO=74/321:VE=182/201:GOSUB 650
6100 IF H1$=H2$ THEN GOSUB 250:GOTO 6010
6110 N2=(IN-48):GOSUB 5000
6120 GOSUB 5000
6130 IF (Y(N2)-L)<59 THEN GOSUB 250:GOTO 6010
6140 GOSUB 6150:RETURN
6150 REM KABEL NAAR BLOK (X)
6160 DX=SGN(X(N1)-X)*3
6170 FOR X=X TO X(N1) STEP DX
6180 GOSUB 4000
6190 NEXT X:X=X(N1):GOSUB 4000
6200 REM KABEL NAAR BLOK (Y)
6210 DY=SGN(Y(N1)-Y2)*3
6220 FOR Y2=Y2 TO Y(N1) STEP DY
6230 GOSUB 4000
6240 NEXT Y2:C=X(N1):D=Y(N1):GOSUB 3500
6250 SD=1:SV=7:SP=106:GOSUB 400
6260 CN=1:SR=N1:GOSUB 300:HO=((R(N1)-1)*5+8+X(N1))/321
6270 VE=(Y(N1)-4+L/2)/201:GOSUB 650:CN=0
6280 REM KABEL EN BLOK OMHOOG
6290 DY=SGN(59-(Y2-6))*3
6300 FOR Y2=(Y2-6) TO 59 STEP DY
6310 D=Y2+1:C=X
6320 GOSUB 4000:GOSUB 3000:GOSUB 3500
6330 NEXT Y2
6340 REM KABEL EN BLOK TOT BOVEN BLOK 2
6350 FOR X=X(N1) TO X(N2) STEP 3*SGN(X(N2)-X(N1))
6360 C=X+1:D=Y2
6370 GOSUB 4000:GOSUB 3000:GOSUB 3500
6380 NEXT X:C=X(N2):X=X(N2):GOSUB 4000
6390 REM KABEL EN BLOK OP BLOK 2
6400 FOR Y2=59 TO Y(N2)-(L+5) STEP 3
6410 C=X
6420 D=Y2+1
6430 GOSUB 4000:GOSUB 3000:GOSUB 3500
6440 NEXT Y2:C=X(N2):D=Y(N2)-(L+1):GOSUB 3000
6450 X(N1)=C:Y(N1)=D:SD=1:SV=7:SP=10:GOSUB 400
6460 CN=0:SR=N1:GOSUB 300:VE=(Y(N1)-4+L/2)/201
6470 IF N2=0 THEN HO=((R-1)*5+8+X(N1))/321:GOTO 6490
6480 HO=((R(N2)-1)*5+8+X(N1))/321
6490 GOSUB 650
6500 REM KABEL NAAR BOVEN
6510 FOR Y2=Y2 TO 59 STEP -3
6520 GOSUB 4000
6530 NEXT Y2
6540 REM KABEL NAAR LINKS
6550 FOR X=X TO 75 STEP -3
6560 GOSUB 4000:NEXT X
6570 RB(R(N1))=Q(N1):RB(R(N2))=N1
6580 B(N2)=N1:R(N1)=R(N2):B(Q(N1))=0:Q(N1)=N2
6590 RETURN
7000 HO=INT(HO/2)-7:LV=VE:VE=0:GOSUB 110
7010 SR$="HIJSKRAAN":GOSUB 150:PRINT :PRINT 
7020 PRINT "Dit is een simulatie van een hijskraan"
7030 PRINT "en vier blokken. Die kunnen op elkaar"
7040 PRINT "gezet worden. Het programma vraagt"
7050 PRINT "eerst in 'a' en 'b' de nummers van"
7060 PRINT "'a' het blok dat verplaatst wordt"
7070 PRINT "en 'b' het blok waar 'a' op gezet wordt"
7080 PRINT "Als 'a' hetzelfde is als 'b' zal het "
7090 PRINT "programma de invoer weigeren."
7100 PRINT "Het zal ook weigeren als de stapel te"
7110 PRINT "hoog dreigt te worden."
7120 PRINT "Als op of 'a' of 'b' nog een ander blok"
7130 PRINT "staat zal dit weggezet worden"
7140 VE=LV:HO=0:GOSUB 110
7150 PRINT "         <<RETURN>>";
7160 GOSUB 210:RETURN
32000 REM ***********************
32010 REM *                     *
32020 REM * DOOR EDWIN DE GRAAF *
32030 REM * J. SLUYTERSWEG 32   *
32040 REM * 5645 JD             *
32050 REM * EINDHOVEN           *
32060 REM * OP EEN C-64         *
32070 REM *                     *
32080 REM ***********************
32100 REM TROS-radio 870107
