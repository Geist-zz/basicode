1000 A=500:GOTO 20:REM VIER GEWINNT !
1005 REM ** REMZEILE = ACTIONSZEILE - 5 **
1010 K=0:J=0:I=0:H1=HO:V1=VE:R=.999:CN=0
1020 DIM S(8,7),H(7)
1030 GOSUB 9000:GOSUB 6000:GOTO 4000
1035 REM Grafik & BREAK-Verriegelung
1040 GOSUB 600
1050 FR=1:GOSUB 280:RETURN
1075 REM Piepton
1080 SD=.5:SV=5:SP=100:GOSUB 400:RETURN
1095 REM Eingabe
1100 GOSUB 200
1110 SD=300:GOSUB 450:GOSUB 1080:RETURN
1995 REM Sieg - Kontrolle
2000 SI=0:IF HS<7 THEN RETURN
2010 M=4:N=6:FOR I=1 TO M:FOR J=1 TO N
2020 PB=S(I+1,J):PC=S(I+2,J):PD=S(I+3,J)
2030 GOSUB 2350:NEXT J:NEXT I:IF SI THEN RETURN
2100 M=7:N=3:FOR I=1 TO M:FOR J=1 TO N
2110 PB=S(I,J+1):PC=S(I,J+2):PD=S(I,J+3)
2120 GOSUB 2350:NEXT J:NEXT I:IF SI THEN RETURN
2200 M=4:L=3:FOR I=1 TO M:FOR J=1 TO N
2210 PB=S(I+1,J+1):PC=S(I+2,J+2):PD=S(I+3,J+3)
2220 GOSUB 2350:NEXT J:NEXT I:IF SI THEN RETURN
2300 M=7:N=3:FOR I=4 TO M:FOR J=1 TO N
2310 PB=S(I-1,J+1):PC=S(I-2,J+2):PD=S(I-3,J+3)
2320 GOSUB 2350:NEXT J:NEXT I:RETURN
2350 IF S(I,J)<>P THEN RETURN
2360 IF (PB=P) AND (PC=P) AND (PD=P) THEN I=M:J=N:SI=P
2370 RETURN
2995 REM HC - Taktik
3000 IN=0:Z=0:C=0:SI=0:IF S(4,1)=0 THEN EN=4:RETURN
3010 PK=3-P:IF HS<3 THEN 3900
3015 REM Problem erst 3 dann 2 Steine
3020 FOR PR=3 TO 2 STEP -1
3030 FOR PX=P TO PK STEP PK-P
3040 IF PR=3 THEN  GOSUB 3200
3050 IF PR=2 THEN  GOSUB 3100
3060 IF SI=3 THEN PX=PK:PR=2
3070 NEXT PX:NEXT PR:IF SI=3 THEN RETURN
3080 GOTO 3900
3095 REM zwei Steine
3100 EN=C:M=6:N=4:GOSUB 200:IF IN THEN SI=3:RETURN
3110 FOR J=1 TO M:Y=J-1:FOR I=2 TO N
3120 IF S(I,J)<>PX THEN 3180
3130 PB=S(I+1,J):PC=S(I+2,J):PD=S(I-1,J)
3135 REM ---- waagerecht
3140 IF (PC=PX) AND (PB=0) AND (S(I+1,Y)) THEN EN=I+1
3145 REM ---- Diagonale steigend
3150 IF (PB=PX) AND (PC=0) AND (S(I+2,Y)) THEN EN=I+2
3155 REM ---- Diagonale fallend
3160 IF (PB=PX) AND (PD=0) AND (S(I-1,Y)) THEN EN=I-1
3170 IF EN<>C THEN SI=3:J=M:I=N
3180 NEXT I
3190 NEXT J:RETURN
3195 REM 3 Steine ---- waagerecht
3200 GOSUB 200:IF IN THEN SI=3:RETURN
3210 M=6:N=4:FOR J=1 TO M:FOR I=1 TO N
3220 S=0:FOR K=0 TO 3
3230 IF S(I+K,J)=PX THEN S=S+1
3240 NEXT K
3250 IF S=3 THEN  GOSUB 3600:GOSUB 3580
3260 NEXT I:NEXT J:IF SI=3 THEN RETURN
3295 REM ---- senkrecht
3300 GOSUB 200:IF IN THEN SI=3:RETURN
3310 M=3:N=7:FOR J=1 TO M:FOR I=1 TO N
3320 S=0:FOR K=0 TO 3
3330 IF S(I,J+K)=PX THEN S=S+1
3340 NEXT K
3350 IF S=3 THEN  GOSUB 3630:GOSUB 3580
3360 NEXT I:NEXT J:IF SI=3 THEN RETURN
3395 REM ---- Diagonale steigend
3400 GOSUB 200:IF IN THEN SI=3:RETURN
3410 M=3:N=4:FOR J=1 TO M:FOR I=1 TO N
3420 S=0:FOR K=0 TO 3
3430 IF S(I+K,J+K)=PX THEN S=S+1
3440 NEXT K
3450 IF S=3 THEN  GOSUB 3660:GOSUB 3580
3460 NEXT I:NEXT J:IF SI=3 THEN RETURN
3495 REM ---- Diagonale fallend
3500 GOSUB 200:IF IN THEN SI=3:RETURN
3510 M=3:N=7:FOR J=1 TO M:FOR I=4 TO N
3520 S=0:FOR K=0 TO 3
3530 IF S(I-K,J+K)=PX THEN S=S+1
3540 NEXT K
3550 IF S=3 THEN  GOSUB 3690:GOSUB 3580
3560 NEXT I:NEXT J
3570 RETURN
3580 IF SI=3 THEN J=M:I=N
3590 RETURN
3595 REM Suche freies Feld
3600 FOR K=0 TO 3:PA=S(I+K,J)
3610 IF PA=0 THEN EN=I+K:Y=J:GOSUB 3800
3620 NEXT K:RETURN
3630 FOR K=0 TO 3:PA=S(I,J+K)
3640 IF PA=0 THEN SI=3:EN=I:K=3
3650 NEXT K:RETURN
3660 FOR K=0 TO 3:PA=S(I+K,J+K)
3670 IF PA=0 THEN EN=I+K:Y=J+K:GOSUB 3800
3680 NEXT K:RETURN
3690 FOR K=0 TO 3:PA=S(I-K,J+K)
3700 IF PA=0 THEN EN=I-K:Y=J+K:GOSUB 3800
3710 NEXT K:RETURN
3795 REM Untersuchung freies Feld
3800 PA=S(EN,Y-1):IF Y<2 THEN 3830
3810 PB=S(EN,Y-2)
3820 IF (PB) AND (PA=0) THEN C=EN:SI=0:RETURN
3830 IF PA THEN SI=3:K=3:RETURN
3840 SI=0:RETURN
3895 REM Zufallsgenerator
3900 Z=0:GOSUB 200:IF IN THEN SI=3:RETURN
3910 GOSUB 260:Z=Z+1:EN=INT(RV*7)+1:IF H(EN)>5 THEN 3910
3920 IF Z>100 THEN RETURN
3930 IF EN=C THEN 3910
3940 RETURN
3995 REM Graphic & Action
4000 P=2
4010 IF P=1 THEN P=2:PL$=N2$:SR$=N2$+B$:H$=SR$:GOTO 4030
4020 P=1:PL$=N1$:SR$=N1$+B$:H$=SR$
4030 HO=0:VE=.07:GOSUB 650:GOSUB 1080
4040 IF LEFT$(PL$,8)=C$ THEN  GOSUB 4200:GOTO 4100
4050 GOSUB 1100:EN=IN-48:IF (IN) AND (EN) THEN 4080
4060 CN=1:GOSUB 650:CN=0:SR$=PL$+E$:GOSUB 650
4070 GOSUB 250:GOSUB 250:GOSUB 3000
4080 IF (EN<1) OR (EN>7) THEN  GOSUB 250:GOTO 4050
4090 IF H(EN)>5 THEN  GOSUB 250:GOTO 4050
4100 H(EN)=H(EN)+1:SH=H(EN):S(EN,SH)=P:HS=HS+1
4110 GOSUB 1080:GOSUB 5000:GOSUB 4160
4140 GOSUB 2000:IF (HS>41) OR (SI) THEN 8000
4150 GOTO 4010
4160 HO=0:VE=.07:CN=1:GOSUB 650:CN=0:RETURN
4195 REM Einmischung
4200 GOSUB 3000:IF IN THEN 4220
4210 GOSUB 200:IF IN=0 THEN RETURN
4220 IF (IN<49) OR (IN>55) THEN 4200
4230 IF H(IN-48)>5 THEN 4200
4240 CN=1:GOSUB 650:CN=0
4250 SR$="Fremdling mischt sich ein !"
4260 GOSUB 650:GOSUB 250:EN=IN-48:RETURN
4995 REM Feld fuellen
5000 K1=(6-SH+.1)/6*.7+.2
5010 K2=(7-SH-.1)/6*.7+.2
5020 K3=(EN-.9)/7
5030 K4=(EN-.1)/7
5040 FOR VE=K1 TO K2 STEP P*P/VG
5050 HO=K3:GOSUB 620
5060 HO=K4:GOSUB 630
5070 NEXT VE
5080 IF P=1 THEN RETURN
5090 FOR HO=K3 TO K4 STEP 4/HG
5100 VE=K1:GOSUB 620
5110 VE=K2:GOSUB 630
5120 NEXT HO
5130 RETURN
5995 REM Titelbild
6000 GOSUB 1040:G1=0:G2=0:SN=1
6010 T$=V$+V$:SR$=T$
6020 FOR I=0 TO 21
6030 IF CN THEN CN=0:GOTO 6050
6040 CN=1:GOSUB 1080
6050 HO=0:VE=I/80:GOSUB 650
6060 NEXT I
6070 HO=0:VE=.5:SR$="Bitte Namen eingeben !":GOSUB 650
6080 VE=.6:SR$=">0< ist der "+C$+" !":GOSUB 650
6090 GOSUB 7000
6095 REM Spielfeld zeichnen
6100 GOSUB 1040:X=0
6110 FOR HO=0 TO R STEP R/7
6120 VE=.2:GOSUB 620
6130 VE=.9:GOSUB 630
6140 NEXT HO
6200 FOR VE=.2 TO .901 STEP .7/6
6210 HO=0:GOSUB 620
6220 HO=R:GOSUB 630
6230 NEXT VE
6240 VE=.15
6250 FOR I=1 TO 7
6260 SR$=CHR$(48+I)
6270 HO=I*R/7-.07:GOSUB 650
6280 NEXT I
6290 HO=0:VE=0:SR$=T$:GOSUB 650
6300 VE=.05:HO=0:GOSUB 620
6310 HO=R:GOSUB 630
6400 FOR VE=.92 TO .96 STEP 1/VG
6410 HO=0:GOSUB 620
6420 HO=.05:GOSUB 630
6430 NEXT VE
6440 HO=.1:VE=.92:SR$=N1$:GOSUB 650
6450 FOR VE=.92 TO .96 STEP 4/VG
6460 HO=.5:GOSUB 620
6470 HO=.54:GOSUB 630
6480 NEXT VE
6490 FOR HO=.5 TO .54 STEP 4/HG
6500 VE=.92:GOSUB 620
6510 VE=.96:GOSUB 630
6520 NEXT HO
6530 HO=.6:VE=.92:SR$=N2$:GOSUB 650
6540 GOSUB 270:GOSUB 1080:RETURN
6995 REM Eingabe der Namen
7000 GOSUB 200
7010 PL$="":P=1:GOSUB 7300:GOSUB 250
7020 GOSUB 7100:N1$=PL$
7030 PL$="":P=2:GOSUB 7300:GOSUB 250
7040 GOSUB 7100:SD=30:GOSUB 450:N2$=PL$
7050 IF N1$<>N2$ THEN RETURN
7060 N1$=N1$+" 1":N2$=N2$+" 2":RETURN
7100 GOSUB 1100:K=LEN(PL$):IF IN=48 THEN IN=0
7110 IF (IN>64) AND (IN<91) AND (K<10) THEN 7230
7120 IF IN THEN 7140
7130 CN=1:GOSUB 7300:CN=0:PL$=C$:GOSUB 7300:GOSUB 7400:RETURN
7140 IF (IN<>127) AND (IN<>28) THEN 7180
7150 IF K<1 THEN 7100
7160 CN=1:GOSUB 7300:CN=0
7170 PL$=LEFT$(PL$,K-1):GOSUB 7300:GOTO 7100
7180 IF (IN<>32) AND (IN<>13) THEN 7210
7190 IF K<2 THEN 7100
7200 GOTO 7240
7210 IF (IN>64) AND (IN<91) AND (K<10) THEN 7230
7220 GOTO 7100
7230 PL$=PL$+CHR$(IN):GOSUB 7300:GOTO 7100
7240 GOSUB 7400
7250 H$="":K=LEN(PL$)
7270 FOR I=2 TO K:H$=H$+CHR$(ASC(MID$(PL$,I,1))+32):NEXT I
7280 PL$=LEFT$(PL$,1)+H$:RETURN
7300 HO=0:VE=.7+P/10:SR=P:GOSUB 300
7310 SR$=P$+SR$+" ? "+PL$:GOSUB 650:RETURN
7400 SD=2:FOR I=0 TO 5:SV=I+10:SP=P*I*3+60:GOSUB 400:NEXT I
7410 RETURN
7995 REM Gewinnauswertung
8000 GOSUB 4160:CN=1:HO=0:VE=.05:GOSUB 620:HO=R:GOSUB 630
8010 SR$="Unentschieden !!!"
8020 IF SI=1 THEN SR$=N1$+G$:G1=G1+1
8030 IF SI=2 THEN SR$=N2$+G$:G2=G2+1
8040 CN=0:HO=0:GOSUB 650:H$="52596468645952":SD=5:SV=15
8050 FOR I=1 TO 13 STEP 2:SP=VAL(MID$(H$,I,2)):GOSUB 400:NEXT I
8060 CN=1:VE=0:SR$=T$:GOSUB 650:GOSUB 8520
8070 CN=0:SR$=T$:GOSUB 650:CN=1:GOSUB 6400
8080 GOSUB 11000:CN=0:HO=0:VE=.1:SR$=R$:GOSUB 650:J=0
8090 IF (LEFT$(N1$,8)=C$) AND (LEFT$(N2$,8)=C$) THEN J=1
8100 HO=0:VE=R:SR$=BI$:GOSUB 650:SR$=">>":HO=1-2/V1
8110 GOSUB 200:FOR I=0 TO 50:FOR CN=0 TO 1
8120 GOSUB 650:SD=3:GOSUB 450:IF IN THEN CN=1:I=50
8130 NEXT CN:NEXT I
8140 CN=0:IF IN THEN 8170
8150 IF J=1 THEN 8500
8160 N2$=C$+" 1":N1$=C$+" 2":G1=0:G2=0:SN=0:GOTO 8500
8170 IF (IN=82) AND (J=0) THEN 8500
8190 IF IN<>69 THEN  GOSUB 6000:GOTO 4000
8200 GOTO 10000
8495 REM Revanche !!!
8500 H$=N1$:N1$=N2$:N2$=H$:I=G1:G1=G2:G2=I
8510 SN=SN+1:GOSUB 8520:GOSUB 6100:GOTO 4000
8520 SR=SN:GOSUB 300:T1$=SR$
8530 SR=G1:GOSUB 300:T2$=SR$
8540 SR=G2:GOSUB 300:T3$=SR$
8550 T$=V$+"Nr. "+T1$+"  "+T2$+" : "+T3$:RETURN
8995 REM Spielregeln & Strings & START
9000 GOSUB 1050:C$="Computer":B$=" ist dran !"
9010 V$=" VIER GEWINNT ! ":E$=" hilft der "+C$+" !!"
9020 BI$="Bitte Taste druecken...! ":P$="Spieler "
9030 R$=">R< = Revanche  >E< = ENDE":G$=" hat gewonnen !"
9050 HO=H1/2-10:VE=1::SR$=V$:GOSUB 110:GOSUB 150
9060 PRINT:PRINT:PRINT:PRINT
9070 PRINT"Sind die Spielregeln":PRINT"bekannt  (J/N) ? "
9080 PRINT:PRINT BI$;:GOSUB 1080:GOSUB 11000:GOSUB 1110
9090 IF (IN<>78) AND (IN) THEN RETURN
9100 GOSUB 100:PRINT
9110 SR$=V$:GOSUB 150
9120 PRINT:PRINT
9130 PRINT"Ziel des Spiels ist es,"
9140 PRINT" vier Steine in einer Reihe"
9150 PRINT" zu haben."
9160 PRINT"Diese koennen :"
9170 PRINT" - waagerecht nebeneinander"
9180 PRINT" - senkrecht uebereinander"
9190 PRINT" - diagonal steigend"
9200 PRINT" - diagonal fallend"
9210 PRINT" in einer Reihe liegen."
9220 PRINT"Wenn eine >0< gedrueckt wird,"
9230 PRINT" spielt der ";C$;"."
9240 PRINT"Wird keine Taste gedrueckt,"
9250 PRINT" greift nach ca. 30 s"
9260 PRINT" der ";C$;" ein."
9300 PRINT:PRINT BI$;:GOSUB 250
9310 GOSUB 1100:IF IN THEN RETURN
9320 PRINT:PRINT"ALLES KLAR ? (J/N) ";
9330 GOSUB 250:GOSUB 1100:IF IN=78 THEN 9100
9340 RETURN
9995 REM Abspann
10000 GOSUB 1040:M=1/V1:N=1/H1:V3=.5-M-.1:V4=.5+M+.1:I=.999
10010 HO=0:VE=V3:GOSUB 620:HO=I:GOSUB 630
10020 HO=0:VE=V4:GOSUB 620:HO=I:GOSUB 630
10030 HO=0:VE=V3:GOSUB 620:VE=V4:GOSUB 630
10040 HO=I:VE=V3:GOSUB 620:VE=V4:GOSUB 630
10050 SR$="Auf Wiedersehen !!":VE=.47:HO=.5-9*N:GOSUB 650
10060 FOR J=0 TO 1:FOR I=V3+.03 TO V4-.03 STEP 1/VG
10070 VE=I:IF J=0 THEN 10100
10080 CN=0:VE=V3+.08:HO=.5-8*N:SR$=V$:GOSUB 650
10090 VE=V3+.15:SR$=" by  L.M.  1991":GOSUB 650:VE=1-I
10100 CN=J:HO=.02:GOSUB 620:HO=.98:GOSUB 630
10110 NEXT I:NEXT J:FOR I=0 TO 6:GOSUB 250:NEXT I
10120 SD=100:GOSUB 450
10130 GOTO 950:REM ENDE
10995 REM Spielfeld setzen
11000 FOR J=0 TO 7:H(J)=0:S(0,J)=3:S(8,J)=3
11010 FOR I=0 TO 8
11020 S(I,J)=0:S(I,0)=3:S(I,7)=3
11030 NEXT I
11040 NEXT J
11050 HS=0
11060 RETURN
32000 REM *-------------------*
32010 REM !    Lutz Mueller   !
32020 REM !   Leninallee 50   !
32030 REM !   O-2802 DOEMITZ  !
32040 REM !     24.06.1991    !
32050 REM !  auf ATARI 800 XE !
32060 REM !-------------------!
32070 REM !Wenn das Programm  !
32080 REM !gefaellt oder nicht!
32090 REM !schreiben Sie mir !!
32100 REM *-------------------*
32110 REM
32120 REM Erstausstrahlung: Deutschlandsender Kultur
32130 REM-spezial 910904
